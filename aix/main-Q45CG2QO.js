import{a as Pn,b as On,c as kn,d as Nn,e as Bn,i as Rn}from"./chunk-4RGNNAPJ.js";import{a as $e,d as In,f as Tn,g as An}from"./chunk-CLO5EFIQ.js";import{b as Ln,d as Un}from"./chunk-FSJAHVRJ.js";import{$a as fn,Aa as vt,Ab as yn,Bb as Sn,Ca as k,Cb as xn,D as Zt,Da as v,Ea as m,Eb as Mn,Fa as ln,Fb as B,G as Xt,Ga as De,Gb as qe,Hb as wn,Ia as dn,Ib as be,J as ne,Ja as pn,Jb as G,K as en,Ka as un,Kb as En,La as gn,M as ie,Ma as u,N as j,Na as $,Oa as I,P as M,Pa as mn,Q as tn,S as nn,U as on,Ua as O,V as S,W as x,Ya as E,Z as de,Za as U,_a as _t,ba as rn,c as y,d as Zi,e as ee,ea as p,fa as b,g as Gt,ga as sn,h as Kt,j as Jt,kb as hn,la as C,mb as he,nb as F,o as Yt,oa as g,p as V,pa as an,q as Re,qa as q,rb as W,sa as cn,sb as bn,ta as we,tb as T,vb as oe,w as Fe,wa as d,wb as Ve,xa as l,xb as Cn,ya as R,yb as vn,z as te,za as Ct,zb as _n}from"./chunk-VGOO44QW.js";var Gn=y((Gs,Wn)=>{"use strict";Wn.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var se=y(pe=>{"use strict";var xt,ko=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];pe.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};pe.getSymbolTotalCodewords=function(t){return ko[t]};pe.getBCHDigit=function(n){let t=0;for(;n!==0;)t++,n>>>=1;return t};pe.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');xt=t};pe.isKanjiModeEnabled=function(){return typeof xt<"u"};pe.toSJIS=function(t){return xt(t)}});var et=y(z=>{"use strict";z.L={bit:1};z.M={bit:0};z.Q={bit:3};z.H={bit:2};function Io(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return z.L;case"m":case"medium":return z.M;case"q":case"quartile":return z.Q;case"h":case"high":return z.H;default:throw new Error("Unknown EC Level: "+n)}}z.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4};z.from=function(t,e){if(z.isValid(t))return t;try{return Io(t)}catch{return e}}});var Yn=y((Ys,Jn)=>{"use strict";function Kn(){this.buffer=[],this.length=0}Kn.prototype={get:function(n){let t=Math.floor(n/8);return(this.buffer[t]>>>7-n%8&1)===1},put:function(n,t){for(let e=0;e<t;e++)this.putBit((n>>>t-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),n&&(this.buffer[t]|=128>>>this.length%8),this.length++}};Jn.exports=Kn});var Xn=y((Zs,Zn)=>{"use strict";function Ie(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Ie.prototype.set=function(n,t,e,i){let o=n*this.size+t;this.data[o]=e,i&&(this.reservedBit[o]=!0)};Ie.prototype.get=function(n,t){return this.data[n*this.size+t]};Ie.prototype.xor=function(n,t,e){this.data[n*this.size+t]^=e};Ie.prototype.isReserved=function(n,t){return this.reservedBit[n*this.size+t]};Zn.exports=Ie});var ei=y(tt=>{"use strict";var Eo=se().getSymbolSize;tt.getRowColCoords=function(t){if(t===1)return[];let e=Math.floor(t/7)+2,i=Eo(t),o=i===145?26:Math.ceil((i-13)/(2*e-2))*2,r=[i-7];for(let s=1;s<e-1;s++)r[s]=r[s-1]-o;return r.push(6),r.reverse()};tt.getPositions=function(t){let e=[],i=tt.getRowColCoords(t),o=i.length;for(let r=0;r<o;r++)for(let s=0;s<o;s++)r===0&&s===0||r===0&&s===o-1||r===o-1&&s===0||e.push([i[r],i[s]]);return e}});var ii=y(ni=>{"use strict";var To=se().getSymbolSize,ti=7;ni.getPositions=function(t){let e=To(t);return[[0,0],[e-ti,0],[0,e-ti]]}});var oi=y(w=>{"use strict";w.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var ue={N1:3,N2:3,N3:40,N4:10};w.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7};w.from=function(t){return w.isValid(t)?parseInt(t,10):void 0};w.getPenaltyN1=function(t){let e=t.size,i=0,o=0,r=0,s=null,a=null;for(let c=0;c<e;c++){o=r=0,s=a=null;for(let f=0;f<e;f++){let h=t.get(c,f);h===s?o++:(o>=5&&(i+=ue.N1+(o-5)),s=h,o=1),h=t.get(f,c),h===a?r++:(r>=5&&(i+=ue.N1+(r-5)),a=h,r=1)}o>=5&&(i+=ue.N1+(o-5)),r>=5&&(i+=ue.N1+(r-5))}return i};w.getPenaltyN2=function(t){let e=t.size,i=0;for(let o=0;o<e-1;o++)for(let r=0;r<e-1;r++){let s=t.get(o,r)+t.get(o,r+1)+t.get(o+1,r)+t.get(o+1,r+1);(s===4||s===0)&&i++}return i*ue.N2};w.getPenaltyN3=function(t){let e=t.size,i=0,o=0,r=0;for(let s=0;s<e;s++){o=r=0;for(let a=0;a<e;a++)o=o<<1&2047|t.get(s,a),a>=10&&(o===1488||o===93)&&i++,r=r<<1&2047|t.get(a,s),a>=10&&(r===1488||r===93)&&i++}return i*ue.N3};w.getPenaltyN4=function(t){let e=0,i=t.data.length;for(let r=0;r<i;r++)e+=t.data[r];return Math.abs(Math.ceil(e*100/i/5)-10)*ue.N4};function Ao(n,t,e){switch(n){case w.Patterns.PATTERN000:return(t+e)%2===0;case w.Patterns.PATTERN001:return t%2===0;case w.Patterns.PATTERN010:return e%3===0;case w.Patterns.PATTERN011:return(t+e)%3===0;case w.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(e/3))%2===0;case w.Patterns.PATTERN101:return t*e%2+t*e%3===0;case w.Patterns.PATTERN110:return(t*e%2+t*e%3)%2===0;case w.Patterns.PATTERN111:return(t*e%3+(t+e)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}w.applyMask=function(t,e){let i=e.size;for(let o=0;o<i;o++)for(let r=0;r<i;r++)e.isReserved(r,o)||e.xor(r,o,Ao(t,r,o))};w.getBestMask=function(t,e){let i=Object.keys(w.Patterns).length,o=0,r=1/0;for(let s=0;s<i;s++){e(s),w.applyMask(s,t);let a=w.getPenaltyN1(t)+w.getPenaltyN2(t)+w.getPenaltyN3(t)+w.getPenaltyN4(t);w.applyMask(s,t),a<r&&(r=a,o=s)}return o}});var wt=y(Mt=>{"use strict";var ae=et(),nt=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],it=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Mt.getBlocksCount=function(t,e){switch(e){case ae.L:return nt[(t-1)*4+0];case ae.M:return nt[(t-1)*4+1];case ae.Q:return nt[(t-1)*4+2];case ae.H:return nt[(t-1)*4+3];default:return}};Mt.getTotalCodewordsCount=function(t,e){switch(e){case ae.L:return it[(t-1)*4+0];case ae.M:return it[(t-1)*4+1];case ae.Q:return it[(t-1)*4+2];case ae.H:return it[(t-1)*4+3];default:return}}});var ri=y(rt=>{"use strict";var Ee=new Uint8Array(512),ot=new Uint8Array(256);(function(){let t=1;for(let e=0;e<255;e++)Ee[e]=t,ot[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)Ee[e]=Ee[e-255]})();rt.log=function(t){if(t<1)throw new Error("log("+t+")");return ot[t]};rt.exp=function(t){return Ee[t]};rt.mul=function(t,e){return t===0||e===0?0:Ee[ot[t]+ot[e]]}});var si=y(Te=>{"use strict";var Pt=ri();Te.mul=function(t,e){let i=new Uint8Array(t.length+e.length-1);for(let o=0;o<t.length;o++)for(let r=0;r<e.length;r++)i[o+r]^=Pt.mul(t[o],e[r]);return i};Te.mod=function(t,e){let i=new Uint8Array(t);for(;i.length-e.length>=0;){let o=i[0];for(let s=0;s<e.length;s++)i[s]^=Pt.mul(e[s],o);let r=0;for(;r<i.length&&i[r]===0;)r++;i=i.slice(r)}return i};Te.generateECPolynomial=function(t){let e=new Uint8Array([1]);for(let i=0;i<t;i++)e=Te.mul(e,new Uint8Array([1,Pt.exp(i)]));return e}});var li=y((ra,ci)=>{"use strict";var ai=si();function Ot(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}Ot.prototype.initialize=function(t){this.degree=t,this.genPoly=ai.generateECPolynomial(this.degree)};Ot.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");let e=new Uint8Array(t.length+this.degree);e.set(t);let i=ai.mod(e,this.genPoly),o=this.degree-i.length;if(o>0){let r=new Uint8Array(this.degree);return r.set(i,o),r}return i};ci.exports=Ot});var kt=y(di=>{"use strict";di.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}});var It=y(Y=>{"use strict";var pi="[0-9]+",No="[A-Z $%*+\\-./:]+",Ae="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ae=Ae.replace(/u/g,"\\u");var Bo="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ae+`)(?:.|[\r
]))+`;Y.KANJI=new RegExp(Ae,"g");Y.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Y.BYTE=new RegExp(Bo,"g");Y.NUMERIC=new RegExp(pi,"g");Y.ALPHANUMERIC=new RegExp(No,"g");var Lo=new RegExp("^"+Ae+"$"),Uo=new RegExp("^"+pi+"$"),Ro=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Y.testKanji=function(t){return Lo.test(t)};Y.testNumeric=function(t){return Uo.test(t)};Y.testAlphanumeric=function(t){return Ro.test(t)}});var ce=y(A=>{"use strict";var Fo=kt(),Et=It();A.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};A.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};A.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};A.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};A.MIXED={bit:-1};A.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!Fo.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]};A.getBestModeForData=function(t){return Et.testNumeric(t)?A.NUMERIC:Et.testAlphanumeric(t)?A.ALPHANUMERIC:Et.testKanji(t)?A.KANJI:A.BYTE};A.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")};A.isValid=function(t){return t&&t.bit&&t.ccBits};function Do(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return A.NUMERIC;case"alphanumeric":return A.ALPHANUMERIC;case"kanji":return A.KANJI;case"byte":return A.BYTE;default:throw new Error("Unknown mode: "+n)}}A.from=function(t,e){if(A.isValid(t))return t;try{return Do(t)}catch{return e}}});var hi=y(ge=>{"use strict";var st=se(),Vo=wt(),ui=et(),le=ce(),Tt=kt(),mi=7973,gi=st.getBCHDigit(mi);function qo(n,t,e){for(let i=1;i<=40;i++)if(t<=ge.getCapacity(i,e,n))return i}function fi(n,t){return le.getCharCountIndicator(n,t)+4}function $o(n,t){let e=0;return n.forEach(function(i){let o=fi(i.mode,t);e+=o+i.getBitsLength()}),e}function zo(n,t){for(let e=1;e<=40;e++)if($o(n,e)<=ge.getCapacity(e,t,le.MIXED))return e}ge.from=function(t,e){return Tt.isValid(t)?parseInt(t,10):e};ge.getCapacity=function(t,e,i){if(!Tt.isValid(t))throw new Error("Invalid QR Code version");typeof i>"u"&&(i=le.BYTE);let o=st.getSymbolTotalCodewords(t),r=Vo.getTotalCodewordsCount(t,e),s=(o-r)*8;if(i===le.MIXED)return s;let a=s-fi(i,t);switch(i){case le.NUMERIC:return Math.floor(a/10*3);case le.ALPHANUMERIC:return Math.floor(a/11*2);case le.KANJI:return Math.floor(a/13);case le.BYTE:default:return Math.floor(a/8)}};ge.getBestVersionForData=function(t,e){let i,o=ui.from(e,ui.M);if(Array.isArray(t)){if(t.length>1)return zo(t,o);if(t.length===0)return 1;i=t[0]}else i=t;return qo(i.mode,i.getLength(),o)};ge.getEncodedBits=function(t){if(!Tt.isValid(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;st.getBCHDigit(e)-gi>=0;)e^=mi<<st.getBCHDigit(e)-gi;return t<<12|e}});var _i=y(vi=>{"use strict";var At=se(),Ci=1335,jo=21522,bi=At.getBCHDigit(Ci);vi.getEncodedBits=function(t,e){let i=t.bit<<3|e,o=i<<10;for(;At.getBCHDigit(o)-bi>=0;)o^=Ci<<At.getBCHDigit(o)-bi;return(i<<10|o)^jo}});var Si=y((pa,yi)=>{"use strict";var Ho=ce();function ve(n){this.mode=Ho.NUMERIC,this.data=n.toString()}ve.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};ve.prototype.getLength=function(){return this.data.length};ve.prototype.getBitsLength=function(){return ve.getBitsLength(this.data.length)};ve.prototype.write=function(t){let e,i,o;for(e=0;e+3<=this.data.length;e+=3)i=this.data.substr(e,3),o=parseInt(i,10),t.put(o,10);let r=this.data.length-e;r>0&&(i=this.data.substr(e),o=parseInt(i,10),t.put(o,r*3+1))};yi.exports=ve});var Mi=y((ua,xi)=>{"use strict";var Qo=ce(),Nt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function _e(n){this.mode=Qo.ALPHANUMERIC,this.data=n}_e.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};_e.prototype.getLength=function(){return this.data.length};_e.prototype.getBitsLength=function(){return _e.getBitsLength(this.data.length)};_e.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let i=Nt.indexOf(this.data[e])*45;i+=Nt.indexOf(this.data[e+1]),t.put(i,11)}this.data.length%2&&t.put(Nt.indexOf(this.data[e]),6)};xi.exports=_e});var Pi=y((ga,wi)=>{"use strict";wi.exports=function(t){for(var e=[],i=t.length,o=0;o<i;o++){var r=t.charCodeAt(o);if(r>=55296&&r<=56319&&i>o+1){var s=t.charCodeAt(o+1);s>=56320&&s<=57343&&(r=(r-55296)*1024+s-56320+65536,o+=1)}if(r<128){e.push(r);continue}if(r<2048){e.push(r>>6|192),e.push(r&63|128);continue}if(r<55296||r>=57344&&r<65536){e.push(r>>12|224),e.push(r>>6&63|128),e.push(r&63|128);continue}if(r>=65536&&r<=1114111){e.push(r>>18|240),e.push(r>>12&63|128),e.push(r>>6&63|128),e.push(r&63|128);continue}e.push(239,191,189)}return new Uint8Array(e).buffer}});var ki=y((ma,Oi)=>{"use strict";var Wo=Pi(),Go=ce();function ye(n){this.mode=Go.BYTE,typeof n=="string"&&(n=Wo(n)),this.data=new Uint8Array(n)}ye.getBitsLength=function(t){return t*8};ye.prototype.getLength=function(){return this.data.length};ye.prototype.getBitsLength=function(){return ye.getBitsLength(this.data.length)};ye.prototype.write=function(n){for(let t=0,e=this.data.length;t<e;t++)n.put(this.data[t],8)};Oi.exports=ye});var Ei=y((fa,Ii)=>{"use strict";var Ko=ce(),Jo=se();function Se(n){this.mode=Ko.KANJI,this.data=n}Se.getBitsLength=function(t){return t*13};Se.prototype.getLength=function(){return this.data.length};Se.prototype.getBitsLength=function(){return Se.getBitsLength(this.data.length)};Se.prototype.write=function(n){let t;for(t=0;t<this.data.length;t++){let e=Jo.toSJIS(this.data[t]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),n.put(e,13)}};Ii.exports=Se});var Ti=y((ha,Bt)=>{"use strict";var Ne={single_source_shortest_paths:function(n,t,e){var i={},o={};o[t]=0;var r=Ne.PriorityQueue.make();r.push(t,0);for(var s,a,c,f,h,N,P,Q,Z;!r.empty();){s=r.pop(),a=s.value,f=s.cost,h=n[a]||{};for(c in h)h.hasOwnProperty(c)&&(N=h[c],P=f+N,Q=o[c],Z=typeof o[c]>"u",(Z||Q>P)&&(o[c]=P,r.push(c,P),i[c]=a))}if(typeof e<"u"&&typeof o[e]>"u"){var X=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(X)}return i},extract_shortest_path_from_predecessor_list:function(n,t){for(var e=[],i=t,o;i;)e.push(i),o=n[i],i=n[i];return e.reverse(),e},find_path:function(n,t,e){var i=Ne.single_source_shortest_paths(n,t,e);return Ne.extract_shortest_path_from_predecessor_list(i,e)},PriorityQueue:{make:function(n){var t=Ne.PriorityQueue,e={},i;n=n||{};for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e.queue=[],e.sorter=n.sorter||t.default_sorter,e},default_sorter:function(n,t){return n.cost-t.cost},push:function(n,t){var e={value:n,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof Bt<"u"&&(Bt.exports=Ne)});var Di=y(xe=>{"use strict";var _=ce(),Bi=Si(),Li=Mi(),Ui=ki(),Ri=Ei(),Be=It(),at=se(),Yo=Ti();function Ai(n){return unescape(encodeURIComponent(n)).length}function Le(n,t,e){let i=[],o;for(;(o=n.exec(e))!==null;)i.push({data:o[0],index:o.index,mode:t,length:o[0].length});return i}function Fi(n){let t=Le(Be.NUMERIC,_.NUMERIC,n),e=Le(Be.ALPHANUMERIC,_.ALPHANUMERIC,n),i,o;return at.isKanjiModeEnabled()?(i=Le(Be.BYTE,_.BYTE,n),o=Le(Be.KANJI,_.KANJI,n)):(i=Le(Be.BYTE_KANJI,_.BYTE,n),o=[]),t.concat(e,i,o).sort(function(s,a){return s.index-a.index}).map(function(s){return{data:s.data,mode:s.mode,length:s.length}})}function Lt(n,t){switch(t){case _.NUMERIC:return Bi.getBitsLength(n);case _.ALPHANUMERIC:return Li.getBitsLength(n);case _.KANJI:return Ri.getBitsLength(n);case _.BYTE:return Ui.getBitsLength(n)}}function Zo(n){return n.reduce(function(t,e){let i=t.length-1>=0?t[t.length-1]:null;return i&&i.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)},[])}function Xo(n){let t=[];for(let e=0;e<n.length;e++){let i=n[e];switch(i.mode){case _.NUMERIC:t.push([i,{data:i.data,mode:_.ALPHANUMERIC,length:i.length},{data:i.data,mode:_.BYTE,length:i.length}]);break;case _.ALPHANUMERIC:t.push([i,{data:i.data,mode:_.BYTE,length:i.length}]);break;case _.KANJI:t.push([i,{data:i.data,mode:_.BYTE,length:Ai(i.data)}]);break;case _.BYTE:t.push([{data:i.data,mode:_.BYTE,length:Ai(i.data)}])}}return t}function er(n,t){let e={},i={start:{}},o=["start"];for(let r=0;r<n.length;r++){let s=n[r],a=[];for(let c=0;c<s.length;c++){let f=s[c],h=""+r+c;a.push(h),e[h]={node:f,lastCount:0},i[h]={};for(let N=0;N<o.length;N++){let P=o[N];e[P]&&e[P].node.mode===f.mode?(i[P][h]=Lt(e[P].lastCount+f.length,f.mode)-Lt(e[P].lastCount,f.mode),e[P].lastCount+=f.length):(e[P]&&(e[P].lastCount=f.length),i[P][h]=Lt(f.length,f.mode)+4+_.getCharCountIndicator(f.mode,t))}}o=a}for(let r=0;r<o.length;r++)i[o[r]].end=0;return{map:i,table:e}}function Ni(n,t){let e,i=_.getBestModeForData(n);if(e=_.from(t,i),e!==_.BYTE&&e.bit<i.bit)throw new Error('"'+n+'" cannot be encoded with mode '+_.toString(e)+`.
 Suggested mode is: `+_.toString(i));switch(e===_.KANJI&&!at.isKanjiModeEnabled()&&(e=_.BYTE),e){case _.NUMERIC:return new Bi(n);case _.ALPHANUMERIC:return new Li(n);case _.KANJI:return new Ri(n);case _.BYTE:return new Ui(n)}}xe.fromArray=function(t){return t.reduce(function(e,i){return typeof i=="string"?e.push(Ni(i,null)):i.data&&e.push(Ni(i.data,i.mode)),e},[])};xe.fromString=function(t,e){let i=Fi(t,at.isKanjiModeEnabled()),o=Xo(i),r=er(o,e),s=Yo.find_path(r.map,"start","end"),a=[];for(let c=1;c<s.length-1;c++)a.push(r.table[s[c]].node);return xe.fromArray(Zo(a))};xe.rawSplit=function(t){return xe.fromArray(Fi(t,at.isKanjiModeEnabled()))}});var qi=y(Vi=>{"use strict";var lt=se(),Ut=et(),tr=Yn(),nr=Xn(),ir=ei(),or=ii(),Dt=oi(),Vt=wt(),rr=li(),ct=hi(),sr=_i(),ar=ce(),Rt=Di();function cr(n,t){let e=n.size,i=or.getPositions(t);for(let o=0;o<i.length;o++){let r=i[o][0],s=i[o][1];for(let a=-1;a<=7;a++)if(!(r+a<=-1||e<=r+a))for(let c=-1;c<=7;c++)s+c<=-1||e<=s+c||(a>=0&&a<=6&&(c===0||c===6)||c>=0&&c<=6&&(a===0||a===6)||a>=2&&a<=4&&c>=2&&c<=4?n.set(r+a,s+c,!0,!0):n.set(r+a,s+c,!1,!0))}}function lr(n){let t=n.size;for(let e=8;e<t-8;e++){let i=e%2===0;n.set(e,6,i,!0),n.set(6,e,i,!0)}}function dr(n,t){let e=ir.getPositions(t);for(let i=0;i<e.length;i++){let o=e[i][0],r=e[i][1];for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)s===-2||s===2||a===-2||a===2||s===0&&a===0?n.set(o+s,r+a,!0,!0):n.set(o+s,r+a,!1,!0)}}function pr(n,t){let e=n.size,i=ct.getEncodedBits(t),o,r,s;for(let a=0;a<18;a++)o=Math.floor(a/3),r=a%3+e-8-3,s=(i>>a&1)===1,n.set(o,r,s,!0),n.set(r,o,s,!0)}function Ft(n,t,e){let i=n.size,o=sr.getEncodedBits(t,e),r,s;for(r=0;r<15;r++)s=(o>>r&1)===1,r<6?n.set(r,8,s,!0):r<8?n.set(r+1,8,s,!0):n.set(i-15+r,8,s,!0),r<8?n.set(8,i-r-1,s,!0):r<9?n.set(8,15-r-1+1,s,!0):n.set(8,15-r-1,s,!0);n.set(i-8,8,1,!0)}function ur(n,t){let e=n.size,i=-1,o=e-1,r=7,s=0;for(let a=e-1;a>0;a-=2)for(a===6&&a--;;){for(let c=0;c<2;c++)if(!n.isReserved(o,a-c)){let f=!1;s<t.length&&(f=(t[s]>>>r&1)===1),n.set(o,a-c,f),r--,r===-1&&(s++,r=7)}if(o+=i,o<0||e<=o){o-=i,i=-i;break}}}function gr(n,t,e){let i=new tr;e.forEach(function(c){i.put(c.mode.bit,4),i.put(c.getLength(),ar.getCharCountIndicator(c.mode,n)),c.write(i)});let o=lt.getSymbolTotalCodewords(n),r=Vt.getTotalCodewordsCount(n,t),s=(o-r)*8;for(i.getLengthInBits()+4<=s&&i.put(0,4);i.getLengthInBits()%8!==0;)i.putBit(0);let a=(s-i.getLengthInBits())/8;for(let c=0;c<a;c++)i.put(c%2?17:236,8);return mr(i,n,t)}function mr(n,t,e){let i=lt.getSymbolTotalCodewords(t),o=Vt.getTotalCodewordsCount(t,e),r=i-o,s=Vt.getBlocksCount(t,e),a=i%s,c=s-a,f=Math.floor(i/s),h=Math.floor(r/s),N=h+1,P=f-h,Q=new rr(P),Z=0,X=new Array(s),Qt=new Array(s),ft=0,Yi=new Uint8Array(n.buffer);for(let fe=0;fe<s;fe++){let bt=fe<c?h:N;X[fe]=Yi.slice(Z,Z+bt),Qt[fe]=Q.encode(X[fe]),Z+=bt,ft=Math.max(ft,bt)}let ht=new Uint8Array(i),Wt=0,K,J;for(K=0;K<ft;K++)for(J=0;J<s;J++)K<X[J].length&&(ht[Wt++]=X[J][K]);for(K=0;K<P;K++)for(J=0;J<s;J++)ht[Wt++]=Qt[J][K];return ht}function fr(n,t,e,i){let o;if(Array.isArray(n))o=Rt.fromArray(n);else if(typeof n=="string"){let f=t;if(!f){let h=Rt.rawSplit(n);f=ct.getBestVersionForData(h,e)}o=Rt.fromString(n,f||40)}else throw new Error("Invalid data");let r=ct.getBestVersionForData(o,e);if(!r)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=r;else if(t<r)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+r+`.
`);let s=gr(t,e,o),a=lt.getSymbolSize(t),c=new nr(a);return cr(c,t),lr(c),dr(c,t),Ft(c,e,0),t>=7&&pr(c,t),ur(c,s),isNaN(i)&&(i=Dt.getBestMask(c,Ft.bind(null,c,e))),Dt.applyMask(i,c),Ft(c,e,i),{modules:c,version:t,errorCorrectionLevel:e,maskPattern:i,segments:o}}Vi.create=function(t,e){if(typeof t>"u"||t==="")throw new Error("No input text");let i=Ut.M,o,r;return typeof e<"u"&&(i=Ut.from(e.errorCorrectionLevel,Ut.M),o=ct.from(e.version),r=Dt.from(e.maskPattern),e.toSJISFunc&&lt.setToSJISFunction(e.toSJISFunc)),fr(t,o,i,r)}});var qt=y(me=>{"use strict";function $i(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let t=n.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+n);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(i){return[i,i]}))),t.length===6&&t.push("F","F");let e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+t.slice(0,6).join("")}}me.getOptions=function(t){t||(t={}),t.color||(t.color={});let e=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,i=t.width&&t.width>=21?t.width:void 0,o=t.scale||4;return{width:i,scale:i?4:o,margin:e,color:{dark:$i(t.color.dark||"#000000ff"),light:$i(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}};me.getScale=function(t,e){return e.width&&e.width>=t+e.margin*2?e.width/(t+e.margin*2):e.scale};me.getImageWidth=function(t,e){let i=me.getScale(t,e);return Math.floor((t+e.margin*2)*i)};me.qrToImageData=function(t,e,i){let o=e.modules.size,r=e.modules.data,s=me.getScale(o,i),a=Math.floor((o+i.margin*2)*s),c=i.margin*s,f=[i.color.light,i.color.dark];for(let h=0;h<a;h++)for(let N=0;N<a;N++){let P=(h*a+N)*4,Q=i.color.light;if(h>=c&&N>=c&&h<a-c&&N<a-c){let Z=Math.floor((h-c)/s),X=Math.floor((N-c)/s);Q=f[r[Z*o+X]?1:0]}t[P++]=Q.r,t[P++]=Q.g,t[P++]=Q.b,t[P]=Q.a}}});var zi=y(dt=>{"use strict";var $t=qt();function hr(n,t,e){n.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=e,t.width=e,t.style.height=e+"px",t.style.width=e+"px"}function br(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}dt.render=function(t,e,i){let o=i,r=e;typeof o>"u"&&(!e||!e.getContext)&&(o=e,e=void 0),e||(r=br()),o=$t.getOptions(o);let s=$t.getImageWidth(t.modules.size,o),a=r.getContext("2d"),c=a.createImageData(s,s);return $t.qrToImageData(c.data,t,o),hr(a,r,s),a.putImageData(c,0,0),r};dt.renderToDataURL=function(t,e,i){let o=i;typeof o>"u"&&(!e||!e.getContext)&&(o=e,e=void 0),o||(o={});let r=dt.render(t,e,o),s=o.type||"image/png",a=o.rendererOpts||{};return r.toDataURL(s,a.quality)}});var Qi=y(Hi=>{"use strict";var Cr=qt();function ji(n,t){let e=n.a/255,i=t+'="'+n.hex+'"';return e<1?i+" "+t+'-opacity="'+e.toFixed(2).slice(1)+'"':i}function zt(n,t,e){let i=n+t;return typeof e<"u"&&(i+=" "+e),i}function vr(n,t,e){let i="",o=0,r=!1,s=0;for(let a=0;a<n.length;a++){let c=Math.floor(a%t),f=Math.floor(a/t);!c&&!r&&(r=!0),n[a]?(s++,a>0&&c>0&&n[a-1]||(i+=r?zt("M",c+e,.5+f+e):zt("m",o,0),o=0,r=!1),c+1<t&&n[a+1]||(i+=zt("h",s),s=0)):o++}return i}Hi.render=function(t,e,i){let o=Cr.getOptions(e),r=t.modules.size,s=t.modules.data,a=r+o.margin*2,c=o.color.light.a?"<path "+ji(o.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",f="<path "+ji(o.color.dark,"stroke")+' d="'+vr(s,r,o.margin)+'"/>',h='viewBox="0 0 '+a+" "+a+'"',P='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+h+' shape-rendering="crispEdges">'+c+f+`</svg>
`;return typeof i=="function"&&i(null,P),P}});var Gi=y(Ue=>{"use strict";var _r=Gn(),jt=qi(),Wi=zi(),yr=Qi();function Ht(n,t,e,i,o){let r=[].slice.call(arguments,1),s=r.length,a=typeof r[s-1]=="function";if(!a&&!_r())throw new Error("Callback required as last argument");if(a){if(s<2)throw new Error("Too few arguments provided");s===2?(o=e,e=t,t=i=void 0):s===3&&(t.getContext&&typeof o>"u"?(o=i,i=void 0):(o=i,i=e,e=t,t=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(e=t,t=i=void 0):s===2&&!t.getContext&&(i=e,e=t,t=void 0),new Promise(function(c,f){try{let h=jt.create(e,i);c(n(h,t,i))}catch(h){f(h)}})}try{let c=jt.create(e,i);o(null,n(c,t,i))}catch(c){o(c)}}Ue.create=jt.create;Ue.toCanvas=Ht.bind(null,Wi.render);Ue.toDataURL=Ht.bind(null,Wi.renderToDataURL);Ue.toString=Ht.bind(null,function(n,t,e){return yr.render(n,e)})});var L=class n{constructor(t){this.http=t;this.checkAuthStatus().subscribe()}apiUrl=`${G.baseServerUrl}/auth`;userSubject=new Jt(1);user$=this.userSubject.asObservable();checkAuthStatus(){return this.http.get(`${this.apiUrl}/session-status`,{withCredentials:!0}).pipe(Xt(t=>{this.userSubject.next(t.user)}))}loginWithGithub(){window.location.href=G.auth.callbackPaths.github}loginWithMicrosoft(){window.location.href=G.auth.callbackPaths.microsoft}logout(){window.location.href=`${this.apiUrl}/logout`}isAuthenticated(){return new Gt(t=>{this.user$.subscribe(e=>{t.next(!!e)})})}static \u0275fac=function(e){return new(e||n)(ie(oe))};static \u0275prov=ne({token:n,factory:n.\u0275fac,providedIn:"root"})};function Xi(n,t){n&1&&u(0," maybe later ")}function eo(n,t){if(n&1){let e=k();d(0,"h2"),u(1," Login "),d(2,"div",1)(3,"button",2),v("click",function(){S(e);let o=m();return x(o.loginWithGithub())}),u(4,"Login with GitHub"),l()()()}}var ze=class n{constructor(t,e){this.authService=t;this.router=e;this.authService.isAuthenticated().pipe(te(1)).subscribe(i=>{i&&this.router.navigate(["/"])})}maybe=!1;loginWithGithub(){this.authService.loginWithGithub()}static \u0275fac=function(e){return new(e||n)(b(L),b(B))};static \u0275cmp=M({type:n,selectors:[["app-login"]],standalone:!0,features:[O],decls:3,vars:1,consts:[[1,"login-container"],[1,"login-buttons"],[3,"click"]],template:function(e,i){e&1&&(d(0,"div",0),C(1,Xi,1,0)(2,eo,5,0,"h2"),l()),e&2&&(p(),we(i.maybe?1:2))},styles:[".login-container[_ngcontent-%COMP%]{padding:2rem;text-align:center}.login-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;max-width:300px;margin:0 auto}button[_ngcontent-%COMP%]{padding:.5rem 1rem;cursor:pointer}"]})};var ke=class n{constructor(t,e){this.router=t;this.authService=e}ngOnInit(){return ee(this,null,function*(){yield this.authService.checkAuthStatus(),this.router.navigate(["/profile"])})}static \u0275fac=function(e){return new(e||n)(b(B),b(L))};static \u0275cmp=M({type:n,selectors:[["app-callback"]],standalone:!0,features:[O],decls:2,vars:0,template:function(e,i){e&1&&(d(0,"div"),u(1,"Processing login..."),l())},encapsulation:2})};function to(n,t){if(n&1){let e=k();d(0,"div",1)(1,"h2"),u(2,"User Profile"),l(),d(3,"div",2)(4,"p")(5,"strong"),u(6,"Username:"),l(),u(7),l(),d(8,"p")(9,"strong"),u(10,"Provider:"),l(),u(11),l()(),d(12,"button",3),v("click",function(){S(e);let o=m();return x(o.logout())}),u(13,"Logout"),l()()}if(n&2){let e=t.ngIf;p(7),I(" ",e.username,""),p(4),I(" ",e.provider,"")}}var je=class n{constructor(t){this.authService=t;this.user$=this.authService.user$}user$;logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||n)(b(L))};static \u0275cmp=M({type:n,selectors:[["app-profile"]],standalone:!0,features:[O],decls:2,vars:3,consts:[["class","profile-container",4,"ngIf"],[1,"profile-container"],[1,"profile-info"],[3,"click"]],template:function(e,i){e&1&&(C(0,to,14,2,"div",0),E(1,"async")),e&2&&g("ngIf",U(1,1,i.user$))},dependencies:[T,F,W],styles:[".profile-container[_ngcontent-%COMP%]{padding:2rem;max-width:600px;margin:0 auto}.profile-info[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-radius:4px;margin:1rem 0}button[_ngcontent-%COMP%]{padding:.5rem 1rem;cursor:pointer}"]})};var He=(n,t)=>{let e=j(B);return j(L).isAuthenticated().pipe(te(1),V(o=>o?!0:e.createUrlTree(["/login"])))};function no(n){return typeof n=="object"&&typeof n.v=="string"&&typeof n.minReaderV=="string"&&typeof n.lexicalEditorState=="object"&&typeof n.lexicalEditorState.root=="object"}function Fn(n){return typeof n!="object"||n===null?(console.log("humanMessage is not an object"),!1):n.speaker!=="human"?(console.log("Invalid speaker in humanMessage:",n.speaker),!1):n.contextFiles!==void 0&&!Array.isArray(n.contextFiles)?(console.log("contextFiles is present but not an array:",n.contextFiles),!1):no(n.editorState)?typeof n.text!="string"?(console.log("text is not a string in humanMessage"),!1):!0:(console.log("Invalid editorState in humanMessage"),!1)}function Dn(n){return typeof n!="object"||n===null?(console.log("assistantMessage is not an object"),!1):n.speaker!=="assistant"?(console.log("Invalid speaker in assistantMessage:",n.speaker),!1):!0}function io(n){return typeof n=="object"&&Fn(n.humanMessage)&&Dn(n.assistantMessage)&&!0}function oo(n){if(typeof n!="object"||n===null)return console.log("Session is not an object:",n),!1;if(typeof n.id!="string")return console.log("Invalid session.id:",n.id),!1;if(typeof n.lastInteractionTimestamp!="string")return console.log("Invalid lastInteractionTimestamp:",n.lastInteractionTimestamp),!1;if(!Array.isArray(n.interactions))return console.log("interactions is not an array:",n.interactions),!1;let t=n.interactions.map((e,i)=>{if(!io(e)){if(console.log(`Invalid interaction at index ${i}:`),!e.humanMessage||!Fn(e.humanMessage))return console.log("Invalid humanMessage:",e.humanMessage),i;if(!e.assistantMessage||!Dn(e.assistantMessage))return console.log("Invalid assistantMessage:",e.assistantMessage),i}return-1}).filter(e=>e!==-1);return t.length>0?(console.log(`Found ${t.length} invalid interactions at indices:`,t),!1):!0}function Vn(n){if(!Array.isArray(n))return{isValid:!1,error:"Root structure should be an array of chat sessions"};if(n.length===0)return{isValid:!1,error:"History must contain at least one chat session"};if(!n.every(oo))return{isValid:!1,error:"Invalid chat session structure"};let e=n.some(i=>i.interactions&&i.interactions.length>0);return{isValid:e,error:e?void 0:"History must contain at least one session with interactions"}}var Qe=class n{constructor(t){this.http=t}apiUrl=`${G.apiUrl}/upload`;chunkSize=1024*1024;uploadFile(t){console.log(`Starting upload of ${t.name}, size: ${t.size} bytes`);let e=Math.ceil(t.size/this.chunkSize);console.log(`Will be split into ${e} chunks of ${this.chunkSize} bytes each`);let i=new Kt,o=(s,a)=>ee(this,null,function*(){console.log(`Uploading chunk ${a+1}/${e}, size: ${s.size} bytes`);let c=new FormData;return c.append("file",s,t.name),c.append("chunkIndex",a.toString()),c.append("totalChunks",e.toString()),Yt(this.http.post(`${this.apiUrl}/chunk`,c,{withCredentials:!0,reportProgress:!0,observe:"events"}))});return ee(this,null,function*(){for(let s=0;s<e;s++){let a=s*this.chunkSize,c=Math.min(a+this.chunkSize,t.size),f=t.slice(a,c);yield o(f,s),i.next((s+1)/e*100)}i.complete()}),i.asObservable()}static \u0275fac=function(e){return new(e||n)(ie(oe))};static \u0275prov=ne({token:n,factory:n.\u0275fac,providedIn:"root"})};function so(n,t){if(n&1&&(d(0,"div",7),u(1),l()),n&2){let e=m();p(),$(e.error)}}function ao(n,t){if(n&1&&(d(0,"div",8),u(1),l()),n&2){let e=m();p(),$(e.successMessage)}}function co(n,t){if(n&1&&(d(0,"div",9),u(1),l()),n&2){let e=m();p(),I(" Upload progress: ",e.uploadProgress,"% ")}}var We=class n{constructor(t,e){this.uploadService=t;this.router=e}selectedFile=null;uploadProgress=0;error=null;successMessage=null;onFileSelected(t){let e=t.target.files[0];if(!e)return;if(e.type!=="application/json"&&!e.name.endsWith(".json")){this.error="Only JSON files are allowed",t.target.value=null;return}let i=new FileReader;i.onload=o=>{try{let r=JSON.parse(o.target?.result),s=Vn(r);s.isValid?(this.selectedFile=e,this.error=null):(this.selectedFile=null,this.error=s.error||null)}catch{this.error="Invalid JSON format",this.selectedFile=null}},i.readAsText(e)}onUpload(){this.selectedFile&&this.uploadService.uploadFile(this.selectedFile).subscribe({next:t=>{t===100?(this.successMessage="Upload successful! Redirecting to editorial...",setTimeout(()=>{this.router.navigate(["/editorial"])},2e3)):this.uploadProgress=t,this.error=null},error:t=>{console.error("Upload failed:",t),this.uploadProgress=0,this.error=t.error?.message||"Upload failed",this.successMessage=null}})}static \u0275fac=function(e){return new(e||n)(b(Qe),b(B))};static \u0275cmp=M({type:n,selectors:[["app-upload"]],standalone:!0,features:[O],decls:10,vars:4,consts:[[1,"upload-container"],[1,"upload-area"],["type","file",3,"change"],[3,"click","disabled"],["class","error",4,"ngIf"],["class","success",4,"ngIf"],["class","progress",4,"ngIf"],[1,"error"],[1,"success"],[1,"progress"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"h2"),u(2,"Upload Files"),l(),d(3,"div",1)(4,"input",2),v("change",function(r){return i.onFileSelected(r)}),l(),d(5,"button",3),v("click",function(){return i.onUpload()}),u(6,"Upload"),l()(),C(7,so,2,1,"div",4)(8,ao,2,1,"div",5)(9,co,2,1,"div",6),l()),e&2&&(p(5),g("disabled",!i.selectedFile),p(2),g("ngIf",i.error),p(),g("ngIf",i.successMessage),p(),g("ngIf",i.uploadProgress))},dependencies:[T,F],styles:[".upload-container[_ngcontent-%COMP%]{padding:20px;max-width:600px;margin:0 auto}.upload-area[_ngcontent-%COMP%]{border:2px dashed #ccc;padding:20px;text-align:center;margin:20px 0}.upload-area[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-bottom:10px}.upload-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.upload-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.progress[_ngcontent-%COMP%]{margin-top:10px;padding:10px;background-color:#f8f9fa;border-radius:4px}.error[_ngcontent-%COMP%]{color:#dc3545;margin-top:10px;padding:10px;border-radius:4px;background-color:#f8d7da}.success[_ngcontent-%COMP%]{color:#28a745;margin-top:10px;padding:10px;border-radius:4px;background-color:#d4edda}"]})};var Ge=()=>{let n=j(B);return j(L).user$.pipe(V(e=>e?.roles?.includes("content-creator")?!0:(n.navigate(["/"]),!1)))};var Ke=class n{constructor(t){this.http=t}apiUrl=`${G.apiUrl}/editorial`;getCreatedSessions(){return this.http.get(`${this.apiUrl}/sessions/created`,{withCredentials:!0})}getSessionInteractions(t,e=1,i=10){return this.http.get(`${this.apiUrl}/sessions/${t}/interactions`,{params:{page:e.toString(),pageSize:i.toString()},withCredentials:!0})}updateSessionsStatus(t){return this.http.patch(`${this.apiUrl}/sessions/status`,t,{withCredentials:!0})}static \u0275fac=function(e){return new(e||n)(ie(oe))};static \u0275prov=ne({token:n,factory:n.\u0275fac,providedIn:"root"})};function po(n,t){if(n&1&&(d(0,"div",11),u(1),l()),n&2){let e=m();p(),$(e.message)}}function uo(n,t){if(n&1&&(d(0,"span"),u(1),l()),n&2){let e=m(2);p(),I("(",e.currentSessionTitle,")")}}function go(n,t){if(n&1&&(d(0,"div",18)(1,"div"),u(2),l(),d(3,"div"),u(4),l()()),n&2){let e=m(2);p(2),I("Successful: ",e.successfulAnalyses,""),p(2),I("Failed: ",e.failedAnalyses,"")}}function mo(n,t){if(n&1&&(d(0,"div",12)(1,"div",13),R(2,"div",14),l(),d(3,"div",15),u(4),C(5,uo,2,1,"span",16),l(),C(6,go,5,2,"div",17),l()),n&2){let e=m();p(2),an("width",e.completedAnalyses/e.totalAnalyses*100,"%"),p(2),mn(" Analyzing session ",e.completedAnalyses+1," of ",e.totalAnalyses," "),p(),g("ngIf",e.currentSessionTitle),p(),g("ngIf",e.completedAnalyses>0)}}function fo(n,t){if(n&1){let e=k();d(0,"div",21),v("click",function(){let o=S(e).$implicit,r=m(2);return x(r.setActiveSession(o))}),d(1,"div",22),u(2),d(3,"input",23),v("click",function(o){let r=S(e).$implicit,s=m(2);return x(s.toggleSelection(r.id,o))}),l(),d(4,"div",24),E(5,"date"),E(6,"date"),d(7,"span",25),u(8),l(),d(9,"span",26),u(10),l()()()()}if(n&2){let e=t.$implicit,i=t.index,o=m(2);q("selected",o.selectedSessions.has(e.id))("active",o.selectedSessionId===e.id),p(2),I(" ",i+1," "),p(),g("checked",o.selectedSessions.has(e.id)),p(),g("title","Session ID: "+e.id+`
Created: `+_t(5,9,e.createdAt,"medium")+`
Last interaction: `+_t(6,12,e.lastInteractionTimestamp,"medium")+`
`+e.lastHumanMessage),p(4),I("[",e.interactionsCount,"]"),p(2),$(e.lastHumanMessage)}}function ho(n,t){if(n&1&&(d(0,"div",19),C(1,fo,11,15,"div",20),l()),n&2){let e=m();p(),g("ngForOf",e.sessions)}}function bo(n,t){if(n&1){let e=k();d(0,"div",27)(1,"app-tab-view")(2,"app-tab-item",28),R(3,"app-interaction-list",29),l(),d(4,"app-tab-item",30)(5,"app-session-editor",31),v("saved",function(o){S(e);let r=m();return x(r.onSessionSaved(o))}),l()()()()}if(n&2){let e=m();p(3),g("sessionId",e.selectedSessionId)("ignoreStorage",!0)("ignoreScroll",!0),p(),g("sticky",!0),p(),g("session",e.activeSession)}}function Co(n,t){n&1&&(d(0,"div",32),u(1,"Loading sessions..."),l())}var Je=class n{constructor(t,e){this.editorialService=t;this.chatSessionService=e}sessions=[];selectedSessions=new Set;currentInteractions=null;selectedSessionId=null;activeSession;loading=!0;loadingInteractions=!1;error=null;currentPage=1;pageSize=10;message;analysisInProgress=!1;completedAnalyses=0;totalAnalyses=0;successfulAnalyses=0;failedAnalyses=0;currentSessionTitle="";analysisQueue=[];Math=Math;ngOnInit(){this.loadCreatedSessions()}analyzeSelected(){this.selectedSessions.size===0||this.analysisInProgress||(this.analysisInProgress=!0,this.completedAnalyses=0,this.successfulAnalyses=0,this.failedAnalyses=0,this.totalAnalyses=this.selectedSessions.size,this.analysisQueue=Array.from(this.selectedSessions),this.processNextSession())}processNextSession(){if(this.completedAnalyses>=this.totalAnalyses){this.analysisInProgress=!1,this.failedAnalyses===0?this.message=`Successfully analyzed ${this.successfulAnalyses} sessions`:this.message=`Analysis completed with ${this.successfulAnalyses} successful and ${this.failedAnalyses} failed`,setTimeout(()=>this.message=void 0,5e3);return}let t=this.analysisQueue[this.completedAnalyses],e=this.sessions.find(i=>i.id===t);this.currentSessionTitle=e?.title||e?.lastHumanMessage||t,this.chatSessionService.analyzeSession(t).subscribe({next:i=>{this.successfulAnalyses++,console.log(`Successfully analyzed session ${t}`,i)},error:i=>{this.failedAnalyses++,console.error(`Error analyzing session ${t}:`,i)},complete:()=>{this.completedAnalyses++,this.processNextSession()}})}loadCreatedSessions(){this.editorialService.getCreatedSessions().subscribe({next:t=>{this.sessions=t,this.loading=!1},error:t=>{this.error="Failed to load sessions",this.loading=!1}})}setActiveSession(t){this.selectedSessionId=t.id,this.activeSession=t}toggleSelection(t,e){e.stopPropagation(),this.selectedSessions.has(t)?this.selectedSessions.delete(t):this.selectedSessions.add(t)}selectAll(){this.selectedSessions.size===this.sessions.length?this.selectedSessions.clear():this.sessions.forEach(t=>this.selectedSessions.add(t.id))}updateStatus(t){if(this.selectedSessions.size!==0&&confirm(`Are you sure you want to ${t} selected sessions?`)){let e={sessionIds:Array.from(this.selectedSessions),status:t};this.editorialService.updateSessionsStatus(e).subscribe({next:()=>{this.loadCreatedSessions(),this.selectedSessions.clear(),this.currentInteractions=null,this.selectedSessionId=null},error:i=>{this.error=`Failed to ${t} sessions`}})}}onSessionSaved(t){console.log("saved session",t),this.sessions=this.sessions.filter(e=>e.id!==t.id),this.activeSession=void 0,this.selectedSessionId=null,this.selectedSessions.delete(t.id),this.message=`Session "${t.title}" has been approved`,setTimeout(()=>this.message=void 0,3e3)}static \u0275fac=function(e){return new(e||n)(b(Ke),b(En))};static \u0275cmp=M({type:n,selectors:[["app-editorial"]],standalone:!0,features:[O],decls:17,vars:10,consts:[["loadingTpl",""],[1,"editorial-container"],[1,"sessions-panel"],["class","success-message",4,"ngIf"],[1,"toolbar"],[3,"click"],[3,"click","disabled"],[1,"analyze-btn",3,"click","disabled"],["class","analysis-progress",4,"ngIf"],["class","sessions-list",4,"ngIf","ngIfElse"],["class","content-container",4,"ngIf"],[1,"success-message"],[1,"analysis-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[4,"ngIf"],["class","progress-stats",4,"ngIf"],[1,"progress-stats"],[1,"sessions-list"],["class","session-item",3,"selected","active","click",4,"ngFor","ngForOf"],[1,"session-item",3,"click"],[1,"session-header"],["type","checkbox",3,"click","checked"],[1,"session-info",3,"title"],[1,"count"],[1,"message-preview"],[1,"content-container"],["tabTitle","Interactions"],[3,"sessionId","ignoreStorage","ignoreScroll"],["tabTitle","Edit Session",3,"sticky"],[3,"saved","session"],[1,"loading"]],template:function(e,i){if(e&1){let o=k();d(0,"div",1)(1,"div",2),C(2,po,2,1,"div",3),d(3,"h2"),u(4,"Sessions for Review"),l(),d(5,"div",4)(6,"button",5),v("click",function(){return S(o),x(i.selectAll())}),u(7),l(),d(8,"button",6),v("click",function(){return S(o),x(i.updateStatus("rejected"))}),u(9),l(),d(10,"button",7),v("click",function(){return S(o),x(i.analyzeSelected())}),u(11),l()(),C(12,mo,7,6,"div",8)(13,ho,2,1,"div",9),l(),C(14,bo,6,5,"div",10)(15,Co,2,0,"ng-template",null,0,fn),l()}if(e&2){let o=gn(16);p(2),g("ngIf",i.message),p(5),I(" ",i.selectedSessions.size===i.sessions.length?"Deselect All":"Select All"," "),p(),g("disabled",i.selectedSessions.size===0),p(),I(" Reject Selected (",i.selectedSessions.size,") "),p(),g("disabled",i.selectedSessions.size===0||i.analysisInProgress),p(),I(" Analyze Selected (",i.selectedSessions.size,") "),p(),g("ngIf",i.analysisInProgress),p(),g("ngIf",!i.loading)("ngIfElse",o),p(),g("ngIf",i.selectedSessionId)}},dependencies:[T,he,F,bn,Un,On,Pn,Bn],styles:[".editorial-container[_ngcontent-%COMP%]{padding-left:2rem;display:flex;gap:20px}.sessions-panel[_ngcontent-%COMP%]{width:300px;flex-shrink:0}.content-container[_ngcontent-%COMP%]{flex:1;width:800px}.toolbar[_ngcontent-%COMP%]{margin:20px 0;display:flex;gap:10px}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:not-allowed}.sessions-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.session-item[_ngcontent-%COMP%]{padding:15px;border:1px solid #ddd;border-radius:4px;cursor:pointer}.session-item[_ngcontent-%COMP%]:hover{border-color:#f8f9fa}.session-item.selected[_ngcontent-%COMP%]{border-color:#007bff}.session-item.active[_ngcontent-%COMP%]{border-color:#28a745;border-width:2px}.session-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.interactions-panel[_ngcontent-%COMP%]{overflow-y:auto;padding:20px;border-radius:4px}.interaction-item[_ngcontent-%COMP%]{margin-bottom:20px;padding:15px;border-radius:4px;box-shadow:0 1px 3px #0000001a}.interaction-item[_ngcontent-%COMP%]   .human-message[_ngcontent-%COMP%]{margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid #eee}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:15px;margin-top:20px;padding:10px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;border:1px solid #ddd;border-radius:4px;cursor:pointer}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:not-allowed}.loading[_ngcontent-%COMP%], .loading-interactions[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#666}.error-message[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;color:#dc3545;padding:10px 20px;border-radius:4px;box-shadow:0 2px 4px #0000001a}.session-info[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.session-info[_ngcontent-%COMP%]   .message-preview[_ngcontent-%COMP%]{color:#666}.success-message[_ngcontent-%COMP%]{color:#155724;padding:12px;border-radius:4px;margin-bottom:16px;text-align:center}.analysis-progress[_ngcontent-%COMP%]{margin:15px 0;padding:15px;border-radius:4px;border:1px solid #ddd}.progress-bar[_ngcontent-%COMP%]{height:10px;border-radius:5px;margin-bottom:10px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background-color:#007bff;transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:14px;margin-bottom:10px;color:#495057}.progress-stats[_ngcontent-%COMP%]{display:flex;gap:15px;font-size:13px}.progress-stats[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{color:#28a745}.progress-stats[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{color:#dc3545}.toolbar[_ngcontent-%COMP%]{margin:20px 0;display:flex;gap:10px;flex-wrap:wrap}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.toolbar[_ngcontent-%COMP%]   button.analyze-btn[_ngcontent-%COMP%]{background-color:#28a745}.toolbar[_ngcontent-%COMP%]   button.analyze-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:1}50%{opacity:.7}to{opacity:1}}.analyzing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s infinite}"]})};var Ce=class n{constructor(t){this.http=t}apiUrl=`${G.apiUrl}/admin`;getUsers(){return this.http.get(`${this.apiUrl}/users`,{withCredentials:!0})}assignRole(t,e){return this.http.post(`${this.apiUrl}/users/${t}/roles/${e}`,{},{withCredentials:!0})}removeRole(t,e){return this.http.delete(`${this.apiUrl}/users/${t}/roles/${e}`,{withCredentials:!0})}static \u0275fac=function(e){return new(e||n)(ie(oe))};static \u0275prov=ne({token:n,factory:n.\u0275fac,providedIn:"root"})};function vo(n,t){if(n&1){let e=k();d(0,"div",2)(1,"label")(2,"input",3),v("change",function(){let o=S(e).$implicit,r=m();return x(r.toggleRole(o))}),l(),u(3),l()()}if(n&2){let e=t.$implicit,i=m();p(),q("disabled",i.isDisabled(e)),p(),g("checked",i.user.roles==null?null:i.user.roles.includes(e))("disabled",i.isDisabled(e)),p(),I(" ",e," ")}}var Ye=class n{constructor(t,e){this.adminService=t;this.authService=e;this.authService.user$.pipe(te(1)).subscribe(i=>{this.currentUser=i})}user;availableRoles=["administrator","content-editor","content-creator"];currentUser=null;isDisabled(t){return t==="administrator"&&this.user.uid===this.currentUser?.uid}toggleRole(t){this.isDisabled(t)||(this.user.roles?.includes(t)?this.adminService.removeRole(this.user.uid,t).subscribe(()=>{this.user.roles=this.user.roles?.filter(e=>e!==t)}):this.adminService.assignRole(this.user.uid,t).subscribe(()=>{this.user.roles||(this.user.roles=[]),this.user.roles.push(t)}))}static \u0275fac=function(e){return new(e||n)(b(Ce),b(L))};static \u0275cmp=M({type:n,selectors:[["app-role-management"]],inputs:{user:"user"},standalone:!0,features:[O],decls:2,vars:1,consts:[[1,"role-controls"],["class","role-toggle",4,"ngFor","ngForOf"],[1,"role-toggle"],["type","checkbox",3,"change","checked","disabled"]],template:function(e,i){e&1&&(d(0,"div",0),C(1,vo,4,5,"div",1),l()),e&2&&(p(),g("ngForOf",i.availableRoles))},dependencies:[T,he],styles:[".role-controls[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:.5rem}.role-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.role-toggle[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.7}"]})};function _o(n,t){if(n&1&&(d(0,"div",4)(1,"span"),u(2),l(),R(3,"app-role-management",5),l()),n&2){let e=t.$implicit;p(2),$(e.username),p(),g("user",e)}}function yo(n,t){if(n&1&&(d(0,"div",2),C(1,_o,4,2,"div",3),l()),n&2){let e=m();p(),g("ngForOf",e.users)}}var Ze=class n{constructor(t){this.adminService=t}users=[];ngOnInit(){this.loadUsers()}loadUsers(){this.adminService.getUsers().subscribe(t=>{this.users=t})}static \u0275fac=function(e){return new(e||n)(b(Ce))};static \u0275cmp=M({type:n,selectors:[["app-user-list"]],standalone:!0,features:[O],decls:4,vars:1,consts:[[1,"user-list"],["class","users",4,"ngIf"],[1,"users"],["class","user",4,"ngFor","ngForOf"],[1,"user"],[3,"user"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"h2"),u(2,"User Management"),l(),C(3,yo,2,1,"div",1),l()),e&2&&(p(3),g("ngIf",i.users))},dependencies:[T,he,F,Ye],styles:[".user-list[_ngcontent-%COMP%]{padding:1rem}.user[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem;border-bottom:1px solid #eee}"]})};var $n=(n,t)=>{let e=j(B);return j(L).user$.pipe(te(1),V(o=>o?.roles?.includes("administrator")?!0:e.createUrlTree(["/login"])))};var zn=(n,t)=>{let e=j(B),i=localStorage.getItem("redirect");return i?(localStorage.removeItem("redirect"),e.parseUrl(i)):!0};var jn=[{path:"",loadChildren:()=>import("./chunk-PGSE2YL4.js").then(n=>n.routes),canActivate:[zn],pathMatch:"full"},{path:"book",loadChildren:()=>import("./chunk-QUQMJY6Q.js").then(n=>n.BOOK_VIEWER_ROUTES),canActivate:[He]},{path:"book-manager",canActivate:[Ge],loadChildren:()=>import("./chunk-CIFB6F22.js").then(n=>n.routes)},{path:"session",loadChildren:()=>import("./chunk-BPBAPGEO.js").then(n=>n.routes),canActivate:[He]},{path:"library",loadChildren:()=>import("./chunk-PSGS3IAG.js").then(n=>n.LIBRARY_ROUTES)},{path:"about",loadChildren:()=>import("./chunk-TC52NF6J.js").then(n=>n.routes)},{path:"login",component:ze},{path:"profile",component:je,canActivate:[He]},{path:"upload",component:We,canActivate:[Ge]},{path:"editorial",component:Je,canActivate:[Ge]},{path:"auth/github/callback",component:ke},{path:"auth/microsoft/callback",component:ke},{path:"admin/users",component:Ze,canActivate:[$n]}];var Hn=(n,t)=>{let e=n.clone({withCredentials:!0});return t(e)};var Qn={providers:[wn(jn),Ve(vn(),Cn([Hn]))]};function So(n,t){n&1&&(d(0,"a",8),u(1,"Editorial"),l())}function xo(n,t){n&1&&(d(0,"a",9),u(1,"Book Manager"),l())}function Mo(n,t){n&1&&(d(0,"a",10),u(1,"Upload"),l())}function wo(n,t){n&1&&(d(0,"a",11),u(1,"Admin"),l())}function Po(n,t){if(n&1){let e=k();Ct(0),d(1,"a",2),u(2,"Profile"),l(),C(3,So,2,0,"a",3)(4,xo,2,0,"a",4)(5,Mo,2,0,"a",5)(6,wo,2,0,"a",6),d(7,"a",7),v("click",function(){S(e);let o=m();return x(o.auth.logout())}),u(8,"Logout"),l(),vt()}if(n&2){let e=t.ngIf;p(3),g("ngIf",e.roles==null?null:e.roles.includes("content-creator")),p(),g("ngIf",e.roles==null?null:e.roles.includes("content-creator")),p(),g("ngIf",e.roles==null?null:e.roles.includes("content-creator")),p(),g("ngIf",e.roles==null?null:e.roles.includes("administrator"))}}function Oo(n,t){n&1&&(Ct(0),d(1,"a",12),u(2,"Login"),l(),vt())}var Xe=class n{constructor(t){this.auth=t}static \u0275fac=function(e){return new(e||n)(b(L))};static \u0275cmp=M({type:n,selectors:[["app-nav"]],standalone:!0,features:[O],decls:7,vars:6,consts:[["routerLink","/"],[4,"ngIf"],["routerLink","/profile"],["routerLink","/editorial",4,"ngIf"],["routerLink","/book-manager",4,"ngIf"],["routerLink","/upload",4,"ngIf"],["routerLink","/admin/users",4,"ngIf"],[3,"click"],["routerLink","/editorial"],["routerLink","/book-manager"],["routerLink","/upload"],["routerLink","/admin/users"],["routerLink","/login"]],template:function(e,i){e&1&&(d(0,"nav")(1,"a",0),u(2,"Home"),l(),C(3,Po,9,4,"ng-container",1),E(4,"async"),C(5,Oo,3,0,"ng-container",1),E(6,"async"),l()),e&2&&(p(3),g("ngIf",U(4,2,i.auth.user$)),p(2),g("ngIf",!U(6,4,i.auth.user$)))},dependencies:[T,F,W,be,qe],styles:["nav[_ngcontent-%COMP%]{padding:1rem;background:#f8f9fa}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:1rem;text-decoration:none;color:#333;cursor:pointer}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};var Me=Zi(Gi(),1);var Sr=["qrcElement"],Ki=(()=>{class n{constructor(e,i){this.renderer=e,this.sanitizer=i,this.allowEmptyString=!1,this.colorDark="#000000ff",this.colorLight="#ffffffff",this.cssClass="qrcode",this.elementType="canvas",this.errorCorrectionLevel="M",this.margin=4,this.qrdata="",this.scale=4,this.width=10,this.qrCodeURL=new de,this.context=null}ngOnChanges(){return ee(this,null,function*(){yield this.createQRCode()})}isValidQrCodeText(e){return this.allowEmptyString===!1?!(typeof e>"u"||e===""||e==="null"||e===null):!(typeof e>"u")}toDataURL(e){return new Promise((i,o)=>{(0,Me.toDataURL)(this.qrdata,e,(r,s)=>{r?o(r):i(s)})})}toCanvas(e,i){return new Promise((o,r)=>{(0,Me.toCanvas)(e,this.qrdata,i,s=>{s?r(s):o("success")})})}toSVG(e){return new Promise((i,o)=>{(0,Me.toString)(this.qrdata,e,(r,s)=>{r?o(r):i(s)})})}renderElement(e){for(let i of this.qrcElement.nativeElement.childNodes)this.renderer.removeChild(this.qrcElement.nativeElement,i);this.renderer.appendChild(this.qrcElement.nativeElement,e)}createQRCode(){return ee(this,null,function*(){this.version&&this.version>40?(console.warn("[angularx-qrcode] max value for `version` is 40"),this.version=40):this.version&&this.version<1?(console.warn("[angularx-qrcode]`min value for `version` is 1"),this.version=1):this.version!==void 0&&isNaN(this.version)&&(console.warn("[angularx-qrcode] version should be a number, defaulting to auto."),this.version=void 0);try{if(!this.isValidQrCodeText(this.qrdata))throw new Error("[angularx-qrcode] Field `qrdata` is empty, set 'allowEmptyString=\"true\"' to overwrite this behaviour.");this.isValidQrCodeText(this.qrdata)&&this.qrdata===""&&(this.qrdata=" ");let e={color:{dark:this.colorDark,light:this.colorLight},errorCorrectionLevel:this.errorCorrectionLevel,margin:this.margin,scale:this.scale,version:this.version,width:this.width},i=this.imageSrc,o=this.imageHeight||40,r=this.imageWidth||40;switch(this.elementType){case"canvas":{let s=this.renderer.createElement("canvas");this.context=s.getContext("2d"),this.toCanvas(s,e).then(()=>{if(this.ariaLabel&&this.renderer.setAttribute(s,"aria-label",`${this.ariaLabel}`),this.title&&this.renderer.setAttribute(s,"title",`${this.title}`),i&&this.context){this.centerImage=new Image(r,o),i!==this.centerImage.src&&(this.centerImage.crossOrigin="anonymous",this.centerImage.src=i),o!==this.centerImage.height&&(this.centerImage.height=o),r!==this.centerImage.width&&(this.centerImage.width=r);let a=this.centerImage;a&&(a.onload=()=>{this.context?.drawImage(a,s.width/2-r/2,s.height/2-o/2,r,o)})}this.renderElement(s),this.emitQRCodeURL(s)}).catch(a=>{console.error("[angularx-qrcode] canvas error:",a)});break}case"svg":{let s=this.renderer.createElement("div");this.toSVG(e).then(a=>{this.renderer.setProperty(s,"innerHTML",a);let c=s.firstChild;this.renderer.setAttribute(c,"height",`${this.width}`),this.renderer.setAttribute(c,"width",`${this.width}`),this.renderElement(c),this.emitQRCodeURL(c)}).catch(a=>{console.error("[angularx-qrcode] svg error:",a)});break}case"url":case"img":default:{let s=this.renderer.createElement("img");this.toDataURL(e).then(a=>{this.alt&&s.setAttribute("alt",this.alt),this.ariaLabel&&s.setAttribute("aria-label",this.ariaLabel),s.setAttribute("src",a),this.title&&s.setAttribute("title",this.title),this.renderElement(s),this.emitQRCodeURL(s)}).catch(a=>{console.error("[angularx-qrcode] img/url error:",a)})}}}catch(e){console.error("[angularx-qrcode] Error generating QR Code:",e.message)}})}convertBase64ImageUrlToBlob(e){let i=e.split(";base64,"),o=i[0].split(":")[1],r=atob(i[1]),s=new Uint8Array(r.length);for(let a=0;a<r.length;++a)s[a]=r.charCodeAt(a);return new Blob([s],{type:o})}emitQRCodeURL(e){let i=e.constructor.name;if(i===SVGSVGElement.name){let c=e.outerHTML,f=new Blob([c],{type:"image/svg+xml"}),h=URL.createObjectURL(f),N=this.sanitizer.bypassSecurityTrustUrl(h);this.qrCodeURL.emit(N);return}let o="";i===HTMLCanvasElement.name&&(o=e.toDataURL("image/png")),i===HTMLImageElement.name&&(o=e.src);let r=this.convertBase64ImageUrlToBlob(o),s=URL.createObjectURL(r),a=this.sanitizer.bypassSecurityTrustUrl(s);this.qrCodeURL.emit(a)}static{this.\u0275fac=function(i){return new(i||n)(b(sn),b(yn))}}static{this.\u0275cmp=M({type:n,selectors:[["qrcode"]],viewQuery:function(i,o){if(i&1&&dn(Sr,7),i&2){let r;pn(r=un())&&(o.qrcElement=r.first)}},inputs:{allowEmptyString:"allowEmptyString",colorDark:"colorDark",colorLight:"colorLight",cssClass:"cssClass",elementType:"elementType",errorCorrectionLevel:"errorCorrectionLevel",imageSrc:"imageSrc",imageHeight:"imageHeight",imageWidth:"imageWidth",margin:"margin",qrdata:"qrdata",scale:"scale",version:"version",width:"width",alt:"alt",ariaLabel:"ariaLabel",title:"title"},outputs:{qrCodeURL:"qrCodeURL"},features:[on],decls:2,vars:2,consts:[["qrcElement",""]],template:function(i,o){i&1&&R(0,"div",null,0),i&2&&cn(o.cssClass)},encapsulation:2,changeDetection:0})}}return n})(),Ji=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=tn({type:n})}static{this.\u0275inj=en({})}}return n})();var pt=class n{constructor(t){this.baseHref=t;this.data||(this.data=window.location.origin+this.baseHref,console.log(this.data))}data="";size=100;static \u0275fac=function(e){return new(e||n)(b(hn))};static \u0275cmp=M({type:n,selectors:[["app-qr-code"]],inputs:{data:"data",size:"size"},standalone:!0,features:[O],decls:2,vars:3,consts:[[1,"qr-container"],[3,"qrdata","width","errorCorrectionLevel"]],template:function(e,i){e&1&&(d(0,"div",0),R(1,"qrcode",1),l()),e&2&&(p(),g("qrdata",i.data)("width",i.size)("errorCorrectionLevel","M"))},dependencies:[T,Ji,Ki],styles:[".qr-container[_ngcontent-%COMP%]{background-color:#fff;padding:6px;border-radius:6px;display:inline-block}"]})};function Mr(n,t){if(n&1){let e=k();d(0,"button",8),v("click",function(){S(e);let o=m(2);return x(o.copyPositionUrl())}),u(1," Copy Position URL "),l()}}function wr(n,t){if(n&1&&(d(0,"div",11),u(1),E(2,"async"),l()),n&2){let e=m(2);p(),I(" ",U(2,1,e.copyMessage$)," ")}}function Pr(n,t){if(n&1){let e=k();d(0,"div",1)(1,"div",2)(2,"h3",3),u(3),E(4,"async"),l()(),d(5,"div",4)(6,"div",5)(7,"button",6),E(8,"async"),v("click",function(){S(e);let o=m();return x(o.setContentView())}),u(9," Content "),l(),d(10,"button",6),E(11,"async"),v("click",function(){S(e);let o=m();return x(o.setTocView())}),u(12," Table of Contents "),l()(),d(13,"div",7)(14,"h4"),u(15,"Share Links"),l(),d(16,"button",8),v("click",function(){S(e);let o=m();return x(o.copyBookUrl())}),u(17," Copy Book URL "),l(),C(18,Mr,2,0,"button",9),E(19,"async"),C(20,wr,3,3,"div",10),E(21,"async"),l()()()}if(n&2){let e,i,o=m();p(3),$(U(4,7,o.bookTitle$)),p(4),q("active",!((e=U(8,9,o.widgetState$))!=null&&e.showToc)),p(3),q("active",(i=U(11,11,o.widgetState$))==null?null:i.showToc),p(8),g("ngIf",U(19,13,o.canCopyPosition$)),p(2),g("ngIf",U(21,15,o.copyMessage$))}}var ut=class n{constructor(t,e){this.widgetService=t;this.toastService=e}widgetState$;copyMessage$;canCopyPosition$;bookTitle$;sidebarToggle=new de;notification=new de;ngOnInit(){this.widgetState$=this.widgetService.widgetState$,this.copyMessage$=this.widgetService.copyMessage$,this.canCopyPosition$=this.widgetState$.pipe(V(t=>!!t.activeContentSlug&&t.activeContentSlug!=="book")),this.bookTitle$=this.widgetState$.pipe(V(t=>t.bookTitle||"Book"))}setTocView(){this.widgetService.setTocVisibility(!0),this.sidebarToggle.emit()}setContentView(){this.widgetService.setTocVisibility(!1),this.sidebarToggle.emit()}copyBookUrl(){this.widgetService.copyBookUrl(),this.toastService.show("Book URL copied to clipboard"),this.sidebarToggle.emit()}copyPositionUrl(){this.widgetService.copyPositionUrl(),this.toastService.show("Section URL copied to clipboard"),this.sidebarToggle.emit()}static \u0275fac=function(e){return new(e||n)(b(Rn),b(In))};static \u0275cmp=M({type:n,selectors:[["app-library-book-widget"]],outputs:{sidebarToggle:"sidebarToggle",notification:"notification"},standalone:!0,features:[O],decls:2,vars:3,consts:[["class","library-book-widget",4,"ngIf"],[1,"library-book-widget"],[1,"widget-header"],[1,"book-title"],[1,"widget-content"],[1,"view-toggle"],[1,"toggle-btn",3,"click"],[1,"copy-section"],[1,"copy-btn",3,"click"],["class","copy-btn",3,"click",4,"ngIf"],["class","copy-message",4,"ngIf"],[1,"copy-message"]],template:function(e,i){if(e&1&&(C(0,Pr,22,17,"div",0),E(1,"async")),e&2){let o;g("ngIf",(o=U(1,1,i.widgetState$))==null?null:o.visible)}},dependencies:[T,F,W,be],styles:[".library-book-widget[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid var(--color-border);color:var(--color-text-primary)}.library-book-widget[_ngcontent-%COMP%]   .widget-header[_ngcontent-%COMP%]{margin-bottom:1rem}.library-book-widget[_ngcontent-%COMP%]   .widget-header[_ngcontent-%COMP%]   .book-title[_ngcontent-%COMP%]{font-size:.95rem;line-height:1.3;max-height:3.9rem;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;text-overflow:ellipsis;color:var(--color-text-primary)}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]{display:flex;width:100%;border-radius:4px;overflow:hidden}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{flex:1;padding:.5rem;background-color:#444;color:var(--color-text-primary);border:none;cursor:pointer;transition:all .2s ease}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background-color:#ffff661a}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background-color:#ffff6626}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .copy-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.9rem;color:var(--color-text-primary);margin-bottom:.5rem}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .copy-section[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:.5rem;background-color:#444;color:var(--color-text-primary);border:none;border-radius:4px;cursor:pointer}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .copy-section[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]:hover{background-color:#ffff661a}.library-book-widget[_ngcontent-%COMP%]   .widget-content[_ngcontent-%COMP%]   .copy-section[_ngcontent-%COMP%]   .copy-message[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-primary);text-align:center;padding:.25rem}"]})};var Or=[[["","navContext",""]],[["","navPosition",""]],[["","navActions",""]]],kr=["[navContext]","[navPosition]","[navActions]"];function Ir(n,t){if(n&1){let e=k();d(0,"div",8)(1,"a",18),v("click",function(){S(e);let o=m();return x(o.onToggle())}),u(2,"Home"),l()()}}function Er(n,t){if(n&1){let e=k();d(0,"button",22),v("click",function(){S(e);let o=m(2);return x(o.copyToClipboard(o.getPositionUrl(),"Position"))}),u(1,"Copy Position Link"),l()}}function Tr(n,t){if(n&1&&(d(0,"div",25),u(1),l()),n&2){let e=m(2);p(),I(" ",e.copySuccessMessage," ")}}function Ar(n,t){if(n&1){let e=k();d(0,"div",19)(1,"h3"),u(2,"Current Book"),l(),d(3,"p",20),u(4),l(),d(5,"div",21)(6,"button",22),v("click",function(){S(e);let o=m();return x(o.copyToClipboard(o.getBookUrl(),"Book"))}),u(7," Copy Book Link "),l(),C(8,Er,2,0,"button",23),l(),C(9,Tr,2,1,"div",24),l()}if(n&2){let e=m();p(4),$(e.bookPosition.bookTitle),p(4),g("ngIf",e.shouldShowPositionButton()),p(),g("ngIf",e.copySuccessMessage)}}function Nr(n,t){n&1&&(d(0,"div",16)(1,"a",26),u(2,"Login"),l()())}function Br(n,t){if(n&1){let e=k();d(0,"div",27),v("click",function(){S(e);let o=m();return x(o.onToggle())}),l()}}var gt=class n{constructor(t,e,i){this.navigationService=t;this.libraryService=e;this.router=i;this.showHomeLink$=Re({books:this.libraryService.books$,currentUrl:this.router.events.pipe(Fe(o=>o instanceof xn),V(o=>o.url),Zt(this.router.url))}).pipe(V(({books:o,currentUrl:r})=>o.length!==1||r==="/about"))}isOpen=!1;toggleSidebar=new de;bookPosition=null;copySuccessMessage="";subscription=null;showLoginLink=!1;showHomeLink$;ngOnInit(){this.subscription=this.navigationService.bookPosition$.subscribe(t=>{this.bookPosition=t})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}onToggle(){this.toggleSidebar.emit()}getBookUrl(){return this.bookPosition?`${window.location.origin}/library/book/${this.bookPosition.bookSlug||this.bookPosition.bookId}`:""}getContentUrl(){return this.bookPosition?.contentSlug?`${this.getBookUrl()}/${this.bookPosition.contentSlug}`:this.getBookUrl()}getPositionUrl(){return this.bookPosition?.position?`${this.getContentUrl()}/${this.bookPosition.position}`:this.getContentUrl()}copyToClipboard(t,e){navigator.clipboard.writeText(t).then(()=>{this.showCopySuccess(e)})}showCopySuccess(t){this.copySuccessMessage=`${t} URL copied!`,setTimeout(()=>{this.copySuccessMessage=""},3e3)}shouldShowPositionButton(){return!(!this.bookPosition?.contentSlug||this.bookPosition.contentSlug==="book"&&!this.bookPosition.position)}static \u0275fac=function(e){return new(e||n)(b($e),b(An),b(B))};static \u0275cmp=M({type:n,selectors:[["app-navigation-sidebar"]],inputs:{isOpen:"isOpen"},outputs:{toggleSidebar:"toggleSidebar"},standalone:!0,features:[O],ngContentSelectors:kr,decls:27,vars:9,consts:[[1,"sidebar-container"],[1,"handle-bar",3,"click"],[1,"handle-icon"],[1,"sidebar-content"],[1,"branding"],[1,"qr-code"],[3,"size"],[1,"app-name"],[1,"default-nav"],[1,"context-nav"],[1,"position-info"],[1,"actions"],[3,"sidebarToggle"],["class","book-position",4,"ngIf"],[1,"about-section"],["routerLink","/about",1,"nav-link",3,"click"],[1,"user-section"],["class","sidebar-backdrop",3,"click",4,"ngIf"],["routerLink","/",1,"nav-link",3,"click"],[1,"book-position"],[1,"book-title"],[1,"share-buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","copy-success",4,"ngIf"],[1,"copy-success"],["routerLink","/login",1,"nav-link"],[1,"sidebar-backdrop",3,"click"]],template:function(e,i){e&1&&(ln(Or),d(0,"div",0)(1,"div",1),v("click",function(){return i.onToggle()}),d(2,"div",2),R(3,"span")(4,"span")(5,"span"),l()(),d(6,"div",3)(7,"div",4)(8,"div",5),R(9,"app-qr-code",6),l(),d(10,"div",7),u(11,"AI Knowledge Studio"),l()(),C(12,Ir,3,0,"div",8),E(13,"async"),d(14,"div",9),De(15),l(),d(16,"div",10),De(17,1),l(),d(18,"div",11),De(19,2),l(),d(20,"app-library-book-widget",12),v("sidebarToggle",function(){return i.onToggle()}),l(),C(21,Ar,10,3,"div",13),d(22,"div",14)(23,"a",15),v("click",function(){return i.onToggle()}),u(24,"About"),l()(),C(25,Nr,3,0,"div",16),l()(),C(26,Br,1,0,"div",17)),e&2&&(q("open",i.isOpen===!0),p(9),g("size",100),p(3),we(U(13,7,i.showHomeLink$)?12:-1),p(9),g("ngIf",i.bookPosition),p(4),we(i.showLoginLink?25:-1),p(),g("ngIf",i.isOpen))},dependencies:[T,F,W,be,qe,pt,ut],styles:[".sidebar-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;z-index:1000;display:flex}.sidebar-container[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]{width:var(--sidebar-handle-width);height:100%;background-color:var(--color-sidebar-handle);cursor:pointer;display:flex;align-items:flex-start;justify-content:center;padding-top:var(--space-md)}.sidebar-container[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]   .handle-icon[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--space-xs)}.sidebar-container[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]   .handle-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;width:12px;height:2px;background-color:var(--color-text-primary);transition:transform var(--transition-normal)}.sidebar-container[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]:hover   .handle-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:var(--color-primary)}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]{width:0;height:100%;background-color:var(--color-sidebar-bg);overflow:hidden;transition:width var(--transition-normal);display:flex;flex-direction:column;border-right:1px solid var(--color-sidebar-border)}@media (max-width: 767px){.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]{max-width:80vw!important;overflow-y:auto!important}}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .branding[_ngcontent-%COMP%]{padding:var(--space-md);display:flex;flex-direction:column;align-items:center;border-bottom:1px solid var(--color-border)}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .branding[_ngcontent-%COMP%]   .qr-code[_ngcontent-%COMP%]{margin-bottom:var(--space-sm)}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .branding[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-weight:500;font-size:var(--font-size-md);color:var(--color-text-primary)}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .default-nav[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .context-nav[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .position-info[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .about-section[_ngcontent-%COMP%]{padding:var(--space-md);border-bottom:1px solid var(--color-border)}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .default-nav[_ngcontent-%COMP%]:empty, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .context-nav[_ngcontent-%COMP%]:empty, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .position-info[_ngcontent-%COMP%]:empty, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]:empty, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]:empty, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .about-section[_ngcontent-%COMP%]:empty{display:none}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .default-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .context-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .position-info[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .about-section[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{display:block;color:var(--color-text-primary);text-decoration:none;padding:var(--space-xs) 0}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .default-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .context-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .position-info[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .about-section[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:var(--color-primary)}.sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%], .sidebar-container[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .about-section[_ngcontent-%COMP%]{margin-top:auto;border-top:1px solid var(--color-border);border-bottom:none}.sidebar-container.open[_ngcontent-%COMP%]{flex-direction:row-reverse}.sidebar-container.open[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]{width:var(--sidebar-width)}.sidebar-container.open[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]{border-left:1px solid var(--color-sidebar-border)}.sidebar-container.open[_ngcontent-%COMP%]   .handle-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{transform:translateY(6px) rotate(45deg)}.sidebar-container.open[_ngcontent-%COMP%]   .handle-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){opacity:0}.sidebar-container.open[_ngcontent-%COMP%]   .handle-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{transform:translateY(-6px) rotate(-45deg)}@media (max-width: 767px){.sidebar-container[_ngcontent-%COMP%]{transform:translate(-100%);transition:transform .3s ease}.sidebar-container[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]{position:fixed!important;left:0!important;top:50%!important;transform:translateY(-50%)!important;z-index:1001!important;width:18px!important;height:40px!important;border-radius:0 6px 6px 0!important}.sidebar-container.open[_ngcontent-%COMP%]{transform:translate(0)}}.sidebar-backdrop[_ngcontent-%COMP%]{display:none}@media (max-width: 767px){.sidebar-backdrop[_ngcontent-%COMP%]{display:block;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#00000080;z-index:999}}.book-position[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;border-top:1px solid #eee}.book-position[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:.5rem}.book-position[_ngcontent-%COMP%]   .book-title[_ngcontent-%COMP%]{font-weight:500;margin-bottom:1rem}.book-position[_ngcontent-%COMP%]   .share-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-top:1rem}.book-position[_ngcontent-%COMP%]   .share-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem;background-color:#f5f5f5;border:1px solid #ddd;border-radius:4px;cursor:pointer}.book-position[_ngcontent-%COMP%]   .share-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#e5e5e5}.book-position[_ngcontent-%COMP%]   .share-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.book-position[_ngcontent-%COMP%]   .copy-success[_ngcontent-%COMP%]{margin-top:1rem;padding:.5rem;background-color:#d4edda;color:#155724;border-radius:4px;text-align:center}@media (max-width: 600px){.sidebar-container.open[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]{width:100vw}}"]})};function Lr(n,t){if(n&1){let e=k();d(0,"app-navigation-blocked",2),v("discard",function(){S(e);let o=m();return x(o.onDiscard())})("stay",function(){S(e);let o=m();return x(o.onStay())}),l()}}var mt=class n{constructor(t,e,i){this.router=t;this.navigationService=e;this.layoutService=i;this.layoutService.layoutMode$.subscribe(o=>{this.layoutMode=o}),Re([this.router.events.pipe(Fe(o=>o instanceof Sn)),this.navigationService.canNavigate$]).subscribe(([o,r])=>{!r&&o.url!==this.router.url&&(this.pendingUrl=o.url,this.showNavigationBlocked=!0)})}showNavigationBlocked=!1;layoutMode="reader";pendingUrl;onDiscard(){this.navigationService.setNavigationState(!0),this.pendingUrl&&this.router.navigateByUrl(this.pendingUrl),this.showNavigationBlocked=!1}onStay(){this.showNavigationBlocked=!1}static \u0275fac=function(e){return new(e||n)(b(B),b($e),b(Tn))};static \u0275cmp=M({type:n,selectors:[["app-root"]],standalone:!0,features:[O],decls:11,vars:8,consts:[[3,"toggleSidebar","isOpen"],[3,"discard","stay",4,"ngIf"],[3,"discard","stay"]],template:function(e,i){if(e&1&&(d(0,"app-navigation-sidebar",0),E(1,"async"),v("toggleSidebar",function(){return i.navigationService.toggleSidebar()}),l(),d(2,"header")(3,"h1"),u(4,"Chat History Browser"),l(),d(5,"nav"),R(6,"app-nav"),l()(),d(7,"main"),R(8,"router-outlet"),l(),R(9,"app-toast"),C(10,Lr,1,0,"app-navigation-blocked",1)),e&2){let o;g("isOpen",(o=U(1,6,i.navigationService.sidebarOpen$))!==null&&o!==void 0?o:!1),p(2),q("reader-mode",i.layoutMode==="reader"),p(5),q("reader-mode",i.layoutMode==="reader"),p(3),g("ngIf",i.showNavigationBlocked)}},dependencies:[T,F,W,Mn,Xe,kn,gt,Nn]})};_n(mt,{providers:[nn(Ln.forRoot({sanitize:rn.NONE})),Ve(),...Qn.providers]}).catch(n=>console.error(n));
