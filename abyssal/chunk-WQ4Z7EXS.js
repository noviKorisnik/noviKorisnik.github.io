import{a as J,b as et,c as tt,d as nt}from"./chunk-MEAPZKQF.js";import{$ as D,A as k,B as a,C as je,D as me,E as g,F as V,G as W,H as Be,I as He,J as Ue,M as Le,N as $e,O as q,P as z,Q as Y,R as Z,S as c,T as d,U as We,Y as qe,Z as _,a as f,b as m,ba as X,c as xe,da as v,e as Ie,ea as ge,f as Ne,fa as _e,g as U,h as Oe,ha as ze,i as Pe,ia as Ye,j as ke,ja as Ze,k as Re,l as O,la as R,m as b,n as he,na as M,o as w,oa as K,p as y,pa as ve,q as S,qa as Xe,r as fe,ra as ye,s as pe,t as Ge,ta as Ke,v as L,va as E,w as Te,x as $,xa as Je,y as P,z as p,za as Qe}from"./chunk-RXOD2E4I.js";var ct=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(a(k),a(P))};static \u0275dir=g({type:n})}return n})(),Me=(()=>{class n extends ct{static \u0275fac=(()=>{let t;return function(r){return(t||(t=$(n)))(r||n)}})();static \u0275dir=g({type:n,features:[V]})}return n})(),re=new w("");var Nt={provide:re,useExisting:O(()=>ht),multi:!0};function Ot(){let n=ye()?ye().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Pt=new w(""),ht=(()=>{class n extends ct{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!Ot())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(a(k),a(P),a(Pt,8))};static \u0275dir=g({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&_("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[R([Nt]),V]})}return n})();var kt=new w(""),Rt=new w("");function ft(n){return n!=null}function pt(n){return He(n)?Ie(n):n}function mt(n){let e={};return n.forEach(t=>{e=t!=null?f(f({},e),t):e}),Object.keys(e).length===0?null:e}function gt(n,e){return e.map(t=>t(n))}function Gt(n){return!n.validate}function _t(n){return n.map(e=>Gt(e)?e:t=>e.validate(t))}function Tt(n){if(!n)return null;let e=n.filter(ft);return e.length==0?null:function(t){return mt(gt(t,e))}}function vt(n){return n!=null?Tt(_t(n)):null}function jt(n){if(!n)return null;let e=n.filter(ft);return e.length==0?null:function(t){let i=gt(t,e).map(pt);return Oe(i).pipe(U(mt))}}function yt(n){return n!=null?jt(_t(n)):null}function it(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Bt(n){return n._rawValidators}function Ht(n){return n._rawAsyncValidators}function Ce(n){return n?Array.isArray(n)?n:[n]:[]}function ee(n,e){return Array.isArray(n)?n.includes(e):n===e}function rt(n,e){let t=Ce(e);return Ce(n).forEach(r=>{ee(t,r)||t.push(r)}),t}function ot(n,e){return Ce(e).filter(t=>!ee(n,t))}var te=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=vt(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=yt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},be=class extends te{name;get formDirective(){return null}get path(){return null}},H=class extends te{_parent=null;name=null;valueAccessor=null},Ve=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Ut={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},$n=m(f({},Ut),{"[class.ng-submitted]":"isSubmitted"}),Ct=(()=>{class n extends Ve{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(a(H,2))};static \u0275dir=g({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&X("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[V]})}return n})();var G="VALID",Q="INVALID",F="PENDING",T="DISABLED",I=class{},ne=class extends I{value;source;constructor(e,t){super(),this.value=e,this.source=t}},j=class extends I{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},B=class extends I{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},x=class extends I{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function Lt(n){return(oe(n)?n.validators:n)||null}function $t(n){return Array.isArray(n)?vt(n):n||null}function Wt(n,e){return(oe(e)?e.asyncValidators:n)||null}function qt(n){return Array.isArray(n)?yt(n):n||null}function oe(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var De=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return M(this.statusReactive)}set status(e){M(()=>this.statusReactive.set(e))}_status=K(()=>this.statusReactive());statusReactive=L(void 0);get valid(){return this.status===G}get invalid(){return this.status===Q}get pending(){return this.status==F}get disabled(){return this.status===T}get enabled(){return this.status!==T}errors;get pristine(){return M(this.pristineReactive)}set pristine(e){M(()=>this.pristineReactive.set(e))}_pristine=K(()=>this.pristineReactive());pristineReactive=L(!0);get dirty(){return!this.pristine}get touched(){return M(this.touchedReactive)}set touched(e){M(()=>this.touchedReactive.set(e))}_touched=K(()=>this.touchedReactive());touchedReactive=L(!1);get untouched(){return!this.touched}_events=new xe;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(rt(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(rt(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(ot(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(ot(e,this._rawAsyncValidators))}hasValidator(e){return ee(this._rawValidators,e)}hasAsyncValidator(e){return ee(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(m(f({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new B(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new B(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(m(f({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new j(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new j(!0,i))}markAsPending(e={}){this.status=F;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new x(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(m(f({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=T,this.errors=null,this._forEachChild(r=>{r.disable(m(f({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ne(this.value,i)),this._events.next(new x(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(m(f({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=G,this._forEachChild(i=>{i.enable(m(f({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(m(f({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===G||this.status===F)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ne(this.value,t)),this._events.next(new x(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(m(f({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?T:G}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=F,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=pt(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new x(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new W,this.statusChanges=new W}_calculateStatus(){return this._allControlsDisabled()?T:this.errors?Q:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(F)?F:this._anyControlsHaveStatus(Q)?Q:G}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new j(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new B(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){oe(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=$t(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=qt(this._rawAsyncValidators)}};var bt=new w("",{providedIn:"root",factory:()=>Ae}),Ae="always";function zt(n,e){return[...e.path,n]}function Yt(n,e,t=Ae){Xt(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),Kt(n,e),Qt(n,e),Jt(n,e),Zt(n,e)}function st(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Zt(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Xt(n,e){let t=Bt(n);e.validator!==null?n.setValidators(it(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=Ht(n);e.asyncValidator!==null?n.setAsyncValidators(it(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();st(e._rawValidators,r),st(e._rawAsyncValidators,r)}function Kt(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Vt(n,e)})}function Jt(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Vt(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Vt(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Qt(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function en(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function tn(n){return Object.getPrototypeOf(n.constructor)===Me}function nn(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===ht?t=o:tn(o)?i=o:r=o}),r||i||t||null}function at(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function lt(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var rn=class extends De{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(Lt(t),Wt(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),oe(t)&&(t.nonNullable||t.initialValueIsDefault)&&(lt(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){at(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){at(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){lt(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var on={provide:H,useExisting:O(()=>we)},ut=Promise.resolve(),we=(()=>{class n extends H{_changeDetectorRef;callSetDisabledState;control=new rn;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new W;constructor(t,i,r,o,s,l){super(),this._changeDetectorRef=s,this.callSetDisabledState=l,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=nn(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),en(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Yt(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){ut.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&Xe(i);ut.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?zt(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(a(be,9),a(kt,10),a(Rt,10),a(re,10),a(ve,8),a(bt,8))};static \u0275dir=g({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[R([on]),V,Te]})}return n})();var sn={provide:re,useExisting:O(()=>se),multi:!0};function Dt(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function an(n){return n.split(":")[0]}var se=(()=>{class n extends Me{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=S(Ue).injector;destroyRef=S(Ge);cdr=S(ve);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,Be({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),r=Dt(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=an(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=$(n)))(r||n)}})();static \u0275dir=g({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&_("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[R([sn]),V]})}return n})(),Mt=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Dt(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(a(P),a(k),a(se,9))};static \u0275dir=g({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),ln={provide:re,useExisting:O(()=>At),multi:!0};function dt(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function un(n){return n.split(":")[0]}var At=(()=>{class n extends Me{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let s=o;for(let l=0;l<s.length;l++){let h=s[l],u=this._getOptionValue(h.value);r.push(u)}}else{let s=i.options;for(let l=0;l<s.length;l++){let h=s[l];if(h.selected){let u=this._getOptionValue(h.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=un(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=$(n)))(r||n)}})();static \u0275dir=g({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&_("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[R([ln]),V]})}return n})(),wt=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(dt(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(dt(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(a(P),a(k),a(At,9))};static \u0275dir=g({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var dn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=me({type:n});static \u0275inj=he({})}return n})();var St=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:bt,useValue:t.callSetDisabledState??Ae}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=me({type:n});static \u0275inj=he({imports:[dn]})}return n})();function hn(n,e){return Array.from({length:n},(t,i)=>Array.from({length:e},(r,o)=>({row:i,col:o})))}function fn(n,e){for(let{row:t,col:i}of e){if(t<0||t>=n.length||i<0||i>=n[0].length||n[t][i].shipId)return!1;for(let r=-1;r<=1;r++)for(let o=-1;o<=1;o++){let s=t+r,l=i+o;if(s>=0&&s<n.length&&l>=0&&l<n[0].length&&n[s][l].shipId&&!e.some(h=>h.row===s&&h.col===l))return!1}}return!0}function pn(n,e,t){for(let{row:i,col:r}of e)n[i][r].shipId=t}function mn(n,e){for(let{row:t,col:i}of e)delete n[t][i].shipId}function gn(n,e){return Math.floor(Math.random()*(e-n+1))+n}function Se(n){for(let e=n.length-1;e>0;e--){let t=gn(0,e);[n[e],n[t]]=[n[t],n[e]]}return n}function _n(n){let e=[];for(let t of n)for(let i=0;i<t.count;i++)e.push({type:t.name,size:t.size});return Se(e)}function Ft(n,e,t,i,r,o){if(t>=e.length)return!0;let s=e[t],l=Se(["H","V"]),h=[];for(let u of l){let C=u==="H"?n.length-1:n.length-s.size,N=u==="H"?n[0].length-s.size:n[0].length-1;for(let A=0;A<=C;A++)for(let ce=0;ce<=N;ce++)h.push({row:A,col:ce,dir:u})}Se(h);for(let u of h){if(o&&(o.value++,o.value>vn))return!1;let C=Array.from({length:s.size},(N,A)=>u.dir==="H"?{row:u.row,col:u.col+A}:{row:u.row+A,col:u.col});if(fn(n,C)){let N=`ship-${r.value++}`;if(pn(n,C,N),i.push({id:N,type:s.type,size:s.size,cells:C}),Ft(n,e,t+1,i,r,o))return!0;i.pop(),mn(n,C)}}return!1}var vn=65536,Et=8;function Ee(n,e=0,t){e===0&&(t=typeof performance<"u"?performance.now():Date.now());let i=hn(n.boardRows,n.boardCols),r=[],o={value:1},s={value:0},l=_n(n.shipTypes);if(!Ft(i,l,0,r,o,s)){if(e<Et)return Ee(n,e+1,t);throw new Error(`Failed to generate valid board setup after ${s.value} attempts and ${Et} retries.`)}let u=typeof performance<"u"?performance.now():Date.now(),C=Math.round(u-(t??0));return{board:i,ships:r,config:n}}var ae=class n{constructor(e,t){this.http=e;this.userService=t}apiUrl=J.apiBaseUrl;sendReady(e,t){return this.userService.getUserId$().pipe(ke(1),Re(i=>this.http.post(`${this.apiUrl}/game-manager/assign-player`,{userId:i,playerName:t,setup:e})))}static \u0275fac=function(t){return new(t||n)(y(E),y(tt))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};var Fe="abyssal_player_name",le=class n{constructor(e,t){this.http=e;this.storage=t}apiUrl="/api/names";getStoredPlayerName(){return this.storage.getItem(Fe)}savePlayerName(e){this.storage.setItem(Fe,e)}clearPlayerName(){this.storage.removeItem(Fe)}fetchNameSuggestions(e=8){let t=new Date().getTime();return this.http.get(`${this.apiUrl}?count=${e}&_t=${t}`).pipe(U(i=>i.names),Pe(i=>(console.error("Failed to fetch name suggestions:",i),Ne(["Swift Warrior","Bold Knight","Clever Mage","Silent Hunter","Brave Dragon","Mystic Phoenix","Shadow Wolf","Thunder Eagle"]))))}static \u0275fac=function(t){return new(t||n)(y(E),y(et))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};function bn(n,e){if(n&1&&(c(0,"option",12),v(1),d()),n&2){let t=e.$implicit;Z("value",t),p(),ge(t)}}function Vn(n,e){if(n&1){let t=qe();c(0,"div",5)(1,"label",10),v(2,"Choose your name:"),d(),c(3,"select",11),Ze("ngModelChange",function(r){fe(t);let o=D();return Ye(o.playerName,r)||(o.playerName=r),pe(r)}),z(4,bn,2,2,"option",12,q),d(),c(6,"button",13),_("click",function(){fe(t);let r=D();return pe(r.requestNewNames())}),v(7),d()()}if(n&2){let t=D();p(3),ze("ngModel",t.playerName),p(),Y(t.nameSuggestions),p(2),Z("disabled",t.loadingNames),p(),_e(" ",t.loadingNames?"Loading...":"Get New Names"," ")}}function Dn(n,e){if(n&1&&We(0,"td",15),n&2){let t,i=e.$implicit,r=D().$implicit,o=D();X("ship",(t=o.getCell(r,i))==null?null:t.shipId)}}function Mn(n,e){if(n&1&&(c(0,"tr"),z(1,Dn,1,2,"td",14,q),d()),n&2){let t=D();p(),Y(t.boardCols)}}var ue=class n{constructor(e,t,i,r,o){this.route=e;this.gameSetupService=t;this.playerNameService=i;this.gameStateService=r;this.router=o;this.gameConfig=this.route.snapshot.data.gameConfig}gameConfig;gameSetup;boardGenerated=!1;playerName="";nameSuggestions=[];showNameSelector=!1;loadingNames=!1;ngOnInit(){let e=this.playerNameService.getStoredPlayerName();e?this.playerName=e:(this.showNameSelector=!0,this.loadNameSuggestions())}loadNameSuggestions(){this.loadingNames=!0,this.playerNameService.fetchNameSuggestions(8).subscribe({next:e=>{this.nameSuggestions=e,e.length>0&&!this.playerName&&(this.playerName=e[0]),this.loadingNames=!1},error:e=>{console.error("Failed to load names:",e),this.loadingNames=!1}})}requestNewNames(){this.loadNameSuggestions()}toggleNameSelector(){this.showNameSelector=!this.showNameSelector,this.showNameSelector&&this.nameSuggestions.length===0&&this.loadNameSuggestions()}get boardRows(){return Array.from({length:this.gameConfig.boardRows},(e,t)=>t)}get boardCols(){return Array.from({length:this.gameConfig.boardCols},(e,t)=>t)}getCell(e,t){return this.gameSetup?.board[e]?.[t]}generateBoard(){this.gameSetup=Ee(this.gameConfig),this.boardGenerated=!0}goBack(){this.router.navigate(["/"])}confirmReady(){!this.gameSetup||!this.playerName||(this.playerNameService.savePlayerName(this.playerName),this.gameSetupService.sendReady(this.gameSetup,this.playerName).subscribe({next:({gameId:e})=>{this.gameStateService.setGameId(e),this.router.navigate(["/game"])},error:e=>{alert("Failed to join game: "+(e?.message||e))}}))}static \u0275fac=function(t){return new(t||n)(a(Je),a(ae),a(le),a(nt),a(Qe))};static \u0275cmp=je({type:n,selectors:[["app-game-setup"]],decls:22,vars:4,consts:[[1,"setup-container"],[1,"player-name-section"],[1,"player-name-display"],[1,"player-name-label"],[1,"change-name-btn",3,"click"],[1,"name-selector"],[1,"board"],[1,"button-container","controls"],[1,"secondary-btn",3,"click"],[1,"primary-btn",3,"click","disabled"],["for","name-select"],["id","name-select",1,"name-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"refresh-names-btn",3,"click","disabled"],[1,"cell",3,"ship"],[1,"cell"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"h2"),v(2,"ABYSSAL"),d(),c(3,"div",1)(4,"div",2)(5,"span",3),v(6),d(),c(7,"button",4),_("click",function(){return i.toggleNameSelector()}),v(8),d()(),Le(9,Vn,8,3,"div",5),d(),c(10,"div",6)(11,"table")(12,"tbody"),z(13,Mn,3,0,"tr",null,q),d()()(),c(15,"div",7)(16,"button",8),_("click",function(){return i.generateBoard()}),v(17,"Generate"),d(),c(18,"button",9),_("click",function(){return i.confirmReady()}),v(19,"Ready"),d(),c(20,"button",8),_("click",function(){return i.goBack()}),v(21,"Leave"),d()()()),t&2&&(p(6),ge(i.playerName||"Not selected"),p(2),_e(" ",i.showNameSelector?"Hide":"Change"," "),p(),$e(i.showNameSelector?9:-1),p(4),Y(i.boardRows),p(5),Z("disabled",!i.boardGenerated||!i.playerName))},dependencies:[Ke,St,Mt,wt,se,Ct,we],styles:['.setup-container[_ngcontent-%COMP%]{padding:1rem;background:linear-gradient(0deg,#7575f0,#3030e8,#1212a1,#0d0d73,#080845);border-radius:8px;max-width:320px;margin:2rem auto}@media (max-width: 480px){.setup-container[_ngcontent-%COMP%]{padding:.75rem;margin:1rem auto}}h2[_ngcontent-%COMP%]{margin-top:0;text-align:center;letter-spacing:1.5rem;font-style:oblique;text-indent:1.5rem;color:#fffffff2;text-shadow:0 1px 3px rgba(0,0,0,.5);font-size:1.5rem;font-weight:400}.player-name-section[_ngcontent-%COMP%]{margin:1rem 0;padding:.75rem;background:#00000040;border-radius:8px;border:2px solid rgba(255,255,255,.2)}@media (max-width: 480px){.player-name-section[_ngcontent-%COMP%]{margin:.75rem 0;padding:.5rem}}.player-name-display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:.5rem;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.7)}.player-name-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;flex:1}.change-name-btn[_ngcontent-%COMP%]{padding:.35rem .7rem;font-size:.8rem;cursor:pointer;background:#ffffff26;border:2px solid rgba(255,255,255,.4);color:#fff;font-weight:500;border-radius:4px;text-shadow:0 1px 2px rgba(0,0,0,.5);transition:all .2s ease;white-space:nowrap}.change-name-btn[_ngcontent-%COMP%]:hover{background:#ffffff40;border-color:#fff9}.name-selector[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,.2)}.name-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.7)}.name-select[_ngcontent-%COMP%]{padding:.5rem;font-size:1rem;border:2px solid rgba(255,255,255,.3);border-radius:4px;background:#0000004d;color:#fff}.refresh-names-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;cursor:pointer;background:#ffffff26;border:2px solid rgba(255,255,255,.4);color:#fff;font-weight:500;border-radius:4px;font-size:.875rem;text-shadow:0 1px 2px rgba(0,0,0,.5);transition:all .2s ease}.refresh-names-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff40;border-color:#fff9}.refresh-names-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.board[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:1rem 0}table[_ngcontent-%COMP%]{border-collapse:collapse}.cell[_ngcontent-%COMP%]{width:32px;height:32px;border:1px solid rgba(255,255,255,.25);background:transparent;position:relative}.cell.ship[_ngcontent-%COMP%]:before{content:"";position:absolute;width:20px;height:20px;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);background:#ffffff80;box-shadow:0 0 0 2px #ffffff4d}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;gap:.5rem}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-weight:500;border-radius:6px;cursor:pointer;text-shadow:0 1px 2px rgba(0,0,0,.5);transition:all .2s ease;margin:0}.secondary-btn[_ngcontent-%COMP%]{background:#ffffff26;border:2px solid rgba(255,255,255,.4);color:#fff}.secondary-btn[_ngcontent-%COMP%]:hover{background:#ffffff40;border-color:#fff9}.primary-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c3a3,#1b987f);border:2px solid rgba(255,255,255,.6);color:#fff;font-size:1.1rem;padding:.7rem 1.5rem;box-shadow:0 4px 12px #0000004d,0 0 20px #26d9b566;animation:_ngcontent-%COMP%_pulse-glow 2s ease-in-out infinite}.primary-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#26d9b5,#1fad91);box-shadow:0 6px 16px #0006,0 0 30px #26d9b599;transform:translateY(-2px)}.primary-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;animation:none;box-shadow:none}@keyframes _ngcontent-%COMP%_pulse-glow{0%,to{box-shadow:0 4px 12px #0000004d,0 0 20px #26d9b566}50%{box-shadow:0 4px 12px #0000004d,0 0 30px #26d9b599}}']})};var de=class n{constructor(e){this.http=e}apiUrl=J.apiBaseUrl;getConfig(){return this.http.get(`${this.apiUrl}/game-config`)}static \u0275fac=function(t){return new(t||n)(y(E))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};var It=()=>S(de).getConfig();var mi=[{path:"",component:ue,resolve:{gameConfig:It}}];export{mi as gameSetupRoutes};
