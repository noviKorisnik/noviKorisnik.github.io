import{a as Te,b as je,c as Re,d as $e,g as Ve,h as De}from"./chunk-UZ6V6X2Q.js";import{Aa as w,B as E,E as U,F as k,G as f,Ga as g,J as xe,Ja as F,Ka as W,La as me,M as C,Ma as Me,N as b,U as ye,X as s,Xa as D,Y as p,Ya as I,ab as Q,bb as ke,c as G,ca as m,cb as S,e as fe,eb as N,f as ge,fa as l,fb as X,gb as we,h as ve,ha as j,hb as Oe,ia as r,ib as Pe,ja as o,jb as Ee,k as K,ka as R,l as he,la as pe,lb as Ue,m as V,ma as de,mb as _,n as _e,nb as Ae,oa as y,ob as Fe,pa as u,pb as Ne,qa as d,qb as O,s as Ce,sb as Le,u as P,ub as He,w as be,xa as Ie,y as Se,ya as a,za as A}from"./chunk-OW3CYLMD.js";var v=class t{constructor(i){this.http=i;this.checkAuthStatus().subscribe()}apiUrl=`${O.baseServerUrl}/auth`;userSubject=new ve(1);user$=this.userSubject.asObservable();checkAuthStatus(){return this.http.get(`${this.apiUrl}/session-status`,{withCredentials:!0}).pipe(Se(i=>{this.userSubject.next(i.user)}))}loginWithGithub(){window.location.href=O.auth.callbackPaths.github}loginWithMicrosoft(){window.location.href=O.auth.callbackPaths.microsoft}logout(){window.location.href=`${this.apiUrl}/logout`}isAuthenticated(){return new fe(i=>{this.user$.subscribe(e=>{i.next(!!e)})})}static \u0275fac=function(e){return new(e||t)(U(N))};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};var Y=class t{constructor(i,e){this.authService=i;this.router=e;this.authService.isAuthenticated().pipe(P(1)).subscribe(n=>{n&&this.router.navigate(["/"])})}loginWithGithub(){this.authService.loginWithGithub()}loginWithMicrosoft(){this.authService.loginWithMicrosoft()}static \u0275fac=function(e){return new(e||t)(p(v),p(_))};static \u0275cmp=f({type:t,selectors:[["app-login"]],standalone:!0,features:[g],decls:6,vars:0,consts:[[1,"login-container"],[1,"login-buttons"],[3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Login"),o(),r(3,"div",1)(4,"button",2),u("click",function(){return n.loginWithGithub()}),a(5,"Login with GitHub"),o()()())},styles:[".login-container[_ngcontent-%COMP%]{padding:2rem;text-align:center}.login-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;max-width:300px;margin:0 auto}button[_ngcontent-%COMP%]{padding:.5rem 1rem;cursor:pointer}"]})};var q=class t{constructor(i,e){this.router=i;this.authService=e}ngOnInit(){return G(this,null,function*(){yield this.authService.checkAuthStatus(),this.router.navigate(["/profile"])})}static \u0275fac=function(e){return new(e||t)(p(_),p(v))};static \u0275cmp=f({type:t,selectors:[["app-callback"]],standalone:!0,features:[g],decls:2,vars:0,template:function(e,n){e&1&&(r(0,"div"),a(1,"Processing login..."),o())},encapsulation:2})};function Xe(t,i){if(t&1){let e=y();r(0,"div",1)(1,"h2"),a(2,"User Profile"),o(),r(3,"div",2)(4,"p")(5,"strong"),a(6,"Username:"),o(),a(7),o(),r(8,"p")(9,"strong"),a(10,"Provider:"),o(),a(11),o()(),r(12,"button",3),u("click",function(){C(e);let c=d();return b(c.logout())}),a(13,"Logout"),o()()}if(t&2){let e=i.ngIf;s(7),w(" ",e.username,""),s(4),w(" ",e.provider,"")}}var ee=class t{constructor(i){this.authService=i;this.user$=this.authService.user$}user$;logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||t)(p(v))};static \u0275cmp=f({type:t,selectors:[["app-profile"]],standalone:!0,features:[g],decls:2,vars:3,consts:[["class","profile-container",4,"ngIf"],[1,"profile-container"],[1,"profile-info"],[3,"click"]],template:function(e,n){e&1&&(m(0,Xe,14,2,"div",0),F(1,"async")),e&2&&l("ngIf",W(1,1,n.user$))},dependencies:[S,I,Q],styles:[".profile-container[_ngcontent-%COMP%]{padding:2rem;max-width:600px;margin:0 auto}.profile-info[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-radius:4px;margin:1rem 0}button[_ngcontent-%COMP%]{padding:.5rem 1rem;cursor:pointer}"]})};var H=(t,i)=>{let e=k(_);return k(v).isAuthenticated().pipe(P(1),V(c=>c?!0:e.createUrlTree(["/login"])))};function Ye(t){return typeof t=="object"&&typeof t.v=="string"&&typeof t.minReaderV=="string"&&typeof t.lexicalEditorState=="object"&&typeof t.lexicalEditorState.root=="object"}function Ze(t){return typeof t=="object"&&t.speaker==="human"&&Array.isArray(t.contextFiles)&&Ye(t.editorState)&&typeof t.text=="string"}function et(t){return typeof t=="object"&&t.speaker==="assistant"&&(typeof t.text=="string"||typeof t.error=="object"&&typeof t.error.message=="string")&&!0}function tt(t){return typeof t=="object"&&Ze(t.humanMessage)&&et(t.assistantMessage)&&!0}function it(t){return typeof t=="object"&&typeof t.id=="string"&&typeof t.lastInteractionTimestamp=="string"&&Array.isArray(t.interactions)&&t.interactions.every(tt)&&!0}function ze(t){if(!Array.isArray(t))return{isValid:!1,error:"Root structure should be an array of chat sessions"};if(t.length===0)return{isValid:!1,error:"History must contain at least one chat session"};if(!t.every(it))return{isValid:!1,error:"Invalid chat session structure"};let e=t.some(n=>n.interactions&&n.interactions.length>0);return{isValid:e,error:e?void 0:"History must contain at least one session with interactions"}}var te=class t{constructor(i){this.http=i}apiUrl=`${O.apiUrl}/upload`;chunkSize=1024*1024;uploadFile(i){console.log(`Starting upload of ${i.name}, size: ${i.size} bytes`);let e=Math.ceil(i.size/this.chunkSize);console.log(`Will be split into ${e} chunks of ${this.chunkSize} bytes each`);let n=new ge,c=(x,B)=>G(this,null,function*(){console.log(`Uploading chunk ${B+1}/${e}, size: ${x.size} bytes`);let $=new FormData;return $.append("file",x,i.name),$.append("chunkIndex",B.toString()),$.append("totalChunks",e.toString()),he(this.http.post(`${this.apiUrl}/chunk`,$,{withCredentials:!0,reportProgress:!0,observe:"events"}))});return G(this,null,function*(){for(let x=0;x<e;x++){let B=x*this.chunkSize,$=Math.min(B+this.chunkSize,i.size),Qe=i.slice(B,$);yield c(Qe,x),n.next((x+1)/e*100)}n.complete()}),n.asObservable()}static \u0275fac=function(e){return new(e||t)(U(N))};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};function ot(t,i){if(t&1&&(r(0,"div",7),a(1),o()),t&2){let e=d();s(),A(e.error)}}function rt(t,i){if(t&1&&(r(0,"div",8),a(1),o()),t&2){let e=d();s(),A(e.successMessage)}}function st(t,i){if(t&1&&(r(0,"div",9),a(1),o()),t&2){let e=d();s(),w(" Upload progress: ",e.uploadProgress,"% ")}}var ie=class t{constructor(i,e){this.uploadService=i;this.router=e}selectedFile=null;uploadProgress=0;error=null;successMessage=null;onFileSelected(i){let e=i.target.files[0];if(!e)return;if(e.type!=="application/json"&&!e.name.endsWith(".json")){this.error="Only JSON files are allowed",i.target.value=null;return}let n=new FileReader;n.onload=c=>{try{let h=JSON.parse(c.target?.result),x=ze(h);x.isValid?(this.selectedFile=e,this.error=null):(this.selectedFile=null,this.error=x.error||null)}catch{this.error="Invalid JSON format",this.selectedFile=null}},n.readAsText(e)}onUpload(){this.selectedFile&&this.uploadService.uploadFile(this.selectedFile).subscribe({next:i=>{i===100?(this.successMessage="Upload successful! Redirecting to editorial...",setTimeout(()=>{this.router.navigate(["/editorial"])},2e3)):this.uploadProgress=i,this.error=null},error:i=>{console.error("Upload failed:",i),this.uploadProgress=0,this.error=i.error?.message||"Upload failed",this.successMessage=null}})}static \u0275fac=function(e){return new(e||t)(p(te),p(_))};static \u0275cmp=f({type:t,selectors:[["app-upload"]],standalone:!0,features:[g],decls:10,vars:4,consts:[[1,"upload-container"],[1,"upload-area"],["type","file",3,"change"],[3,"click","disabled"],["class","error",4,"ngIf"],["class","success",4,"ngIf"],["class","progress",4,"ngIf"],[1,"error"],[1,"success"],[1,"progress"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Upload Files"),o(),r(3,"div",1)(4,"input",2),u("change",function(h){return n.onFileSelected(h)}),o(),r(5,"button",3),u("click",function(){return n.onUpload()}),a(6,"Upload"),o()(),m(7,ot,2,1,"div",4)(8,rt,2,1,"div",5)(9,st,2,1,"div",6),o()),e&2&&(s(5),l("disabled",!n.selectedFile),s(2),l("ngIf",n.error),s(),l("ngIf",n.successMessage),s(),l("ngIf",n.uploadProgress))},dependencies:[S,I],styles:[".upload-container[_ngcontent-%COMP%]{padding:20px;max-width:600px;margin:0 auto}.upload-area[_ngcontent-%COMP%]{border:2px dashed #ccc;padding:20px;text-align:center;margin:20px 0}.upload-area[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-bottom:10px}.upload-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.upload-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.progress[_ngcontent-%COMP%]{margin-top:10px;padding:10px;background-color:#f8f9fa;border-radius:4px}.error[_ngcontent-%COMP%]{color:#dc3545;margin-top:10px;padding:10px;border-radius:4px;background-color:#f8d7da}.success[_ngcontent-%COMP%]{color:#28a745;margin-top:10px;padding:10px;border-radius:4px;background-color:#d4edda}"]})};var ne=()=>{let t=k(_);return k(v).user$.pipe(V(e=>e?.roles?.includes("content-creator")?!0:(t.navigate(["/"]),!1)))};var oe=class t{constructor(i){this.http=i}apiUrl=`${O.apiUrl}/editorial`;getCreatedSessions(){return this.http.get(`${this.apiUrl}/sessions/created`,{withCredentials:!0})}getSessionInteractions(i,e=1,n=10){return this.http.get(`${this.apiUrl}/sessions/${i}/interactions`,{params:{page:e.toString(),pageSize:n.toString()},withCredentials:!0})}updateSessionsStatus(i){return this.http.patch(`${this.apiUrl}/sessions/status`,i,{withCredentials:!0})}static \u0275fac=function(e){return new(e||t)(U(N))};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};function ct(t,i){if(t&1&&(r(0,"div",9),a(1),o()),t&2){let e=d();s(),A(e.message)}}function lt(t,i){if(t&1){let e=y();r(0,"div",12),u("click",function(){let c=C(e).$implicit,h=d(2);return b(h.setActiveSession(c))}),r(1,"div",13)(2,"input",14),u("click",function(c){let h=C(e).$implicit,x=d(2);return b(x.toggleSelection(h.id,c))}),o(),r(3,"div",15),F(4,"date"),F(5,"date"),r(6,"span",16),a(7),o(),r(8,"span",17),a(9),o()()()()}if(t&2){let e=i.$implicit,n=d(2);j("selected",n.selectedSessions.has(e.id))("active",n.selectedSessionId===e.id),s(2),l("checked",n.selectedSessions.has(e.id)),s(),l("title","Session ID: "+e.id+`
Created: `+me(4,8,e.createdAt,"medium")+`
Last interaction: `+me(5,11,e.lastInteractionTimestamp,"medium")+`
`+e.lastHumanMessage),s(4),w("[",e.interactionsCount,"]"),s(2),A(e.lastHumanMessage)}}function pt(t,i){if(t&1&&(r(0,"div",10),m(1,lt,10,14,"div",11),o()),t&2){let e=d();s(),l("ngForOf",e.sessions)}}function dt(t,i){if(t&1){let e=y();r(0,"div",18)(1,"app-tab-view")(2,"app-tab-item",19),R(3,"app-interaction-list",20),o(),r(4,"app-tab-item",21)(5,"app-session-editor",22),u("saved",function(c){C(e);let h=d();return b(h.onSessionSaved(c))}),o()()()()}if(t&2){let e=d();s(3),l("sessionId",e.selectedSessionId)("ignoreStorage",!0)("ignoreScroll",!0),s(),l("sticky",!0),s(),l("session",e.activeSession)}}function mt(t,i){t&1&&(r(0,"div",23),a(1,"Loading sessions..."),o())}var re=class t{constructor(i){this.editorialService=i}sessions=[];selectedSessions=new Set;currentInteractions=null;selectedSessionId=null;activeSession;loading=!0;loadingInteractions=!1;error=null;currentPage=1;pageSize=10;message;Math=Math;ngOnInit(){this.loadCreatedSessions()}loadCreatedSessions(){this.editorialService.getCreatedSessions().subscribe({next:i=>{this.sessions=i,this.loading=!1},error:i=>{this.error="Failed to load sessions",this.loading=!1}})}setActiveSession(i){this.selectedSessionId=i.id,this.activeSession=i}toggleSelection(i,e){e.stopPropagation(),this.selectedSessions.has(i)?this.selectedSessions.delete(i):this.selectedSessions.add(i)}selectAll(){this.selectedSessions.size===this.sessions.length?this.selectedSessions.clear():this.sessions.forEach(i=>this.selectedSessions.add(i.id))}updateStatus(i){if(this.selectedSessions.size!==0&&confirm(`Are you sure you want to ${i} selected sessions?`)){let e={sessionIds:Array.from(this.selectedSessions),status:i};this.editorialService.updateSessionsStatus(e).subscribe({next:()=>{this.loadCreatedSessions(),this.selectedSessions.clear(),this.currentInteractions=null,this.selectedSessionId=null},error:n=>{this.error=`Failed to ${i} sessions`}})}}onSessionSaved(i){console.log("saved session",i),this.sessions=this.sessions.filter(e=>e.id!==i.id),this.activeSession=void 0,this.selectedSessionId=null,this.selectedSessions.delete(i.id),this.message=`Session "${i.title}" has been approved`,setTimeout(()=>this.message=void 0,3e3)}static \u0275fac=function(e){return new(e||t)(p(oe))};static \u0275cmp=f({type:t,selectors:[["app-editorial"]],standalone:!0,features:[g],decls:14,vars:7,consts:[["loadingTpl",""],[1,"editorial-container"],[1,"sessions-panel"],["class","success-message",4,"ngIf"],[1,"toolbar"],[3,"click"],[3,"click","disabled"],["class","sessions-list",4,"ngIf","ngIfElse"],["class","content-container",4,"ngIf"],[1,"success-message"],[1,"sessions-list"],["class","session-item",3,"selected","active","click",4,"ngFor","ngForOf"],[1,"session-item",3,"click"],[1,"session-header"],["type","checkbox",3,"click","checked"],[1,"session-info",3,"title"],[1,"count"],[1,"message-preview"],[1,"content-container"],["tabTitle","Interactions"],[3,"sessionId","ignoreStorage","ignoreScroll"],["tabTitle","Edit Session",3,"sticky"],[3,"saved","session"],[1,"loading"]],template:function(e,n){if(e&1){let c=y();r(0,"div",1)(1,"div",2),m(2,ct,2,1,"div",3),r(3,"h2"),a(4,"Sessions for Review"),o(),r(5,"div",4)(6,"button",5),u("click",function(){return C(c),b(n.selectAll())}),a(7),o(),r(8,"button",6),u("click",function(){return C(c),b(n.updateStatus("rejected"))}),a(9),o()(),m(10,pt,2,1,"div",7),o(),m(11,dt,6,5,"div",8)(12,mt,2,0,"ng-template",null,0,Me),o()}if(e&2){let c=Ie(13);s(2),l("ngIf",n.message),s(5),w(" ",n.selectedSessions.size===n.sessions.length?"Deselect All":"Select All"," "),s(),l("disabled",n.selectedSessions.size===0),s(),w(" Reject Selected (",n.selectedSessions.size,") "),s(),l("ngIf",!n.loading)("ngIfElse",c),s(),l("ngIf",n.selectedSessionId)}},dependencies:[S,D,I,ke,He,je,Te,De],styles:[".editorial-container[_ngcontent-%COMP%]{display:flex;gap:20px}.sessions-panel[_ngcontent-%COMP%]{width:300px;flex-shrink:0}.content-container[_ngcontent-%COMP%]{flex:1;width:800px}.toolbar[_ngcontent-%COMP%]{margin:20px 0;display:flex;gap:10px}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.sessions-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.session-item[_ngcontent-%COMP%]{padding:15px;border:1px solid #ddd;border-radius:4px;cursor:pointer}.session-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.session-item.selected[_ngcontent-%COMP%]{border-color:#007bff;background-color:#e7f1ff}.session-item.active[_ngcontent-%COMP%]{border-color:#28a745;border-width:2px}.session-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.interactions-panel[_ngcontent-%COMP%]{overflow-y:auto;padding:20px;background:#f8f9fa;border-radius:4px}.interaction-item[_ngcontent-%COMP%]{margin-bottom:20px;padding:15px;background:#fff;border-radius:4px;box-shadow:0 1px 3px #0000001a}.interaction-item[_ngcontent-%COMP%]   .human-message[_ngcontent-%COMP%]{margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid #eee}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:15px;margin-top:20px;padding:10px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;border:1px solid #ddd;border-radius:4px;background:#fff;cursor:pointer}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#eee;cursor:not-allowed}.loading[_ngcontent-%COMP%], .loading-interactions[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#666}.error-message[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;color:#dc3545;padding:10px 20px;background-color:#f8d7da;border-radius:4px;box-shadow:0 2px 4px #0000001a}.session-info[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.session-info[_ngcontent-%COMP%]   .message-preview[_ngcontent-%COMP%]{color:#666}.success-message[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;padding:12px;border-radius:4px;margin-bottom:16px;text-align:center}"]})};var z=class t{constructor(i){this.http=i}apiUrl=`${O.apiUrl}/admin`;getUsers(){return this.http.get(`${this.apiUrl}/users`,{withCredentials:!0})}assignRole(i,e){return this.http.post(`${this.apiUrl}/users/${i}/roles/${e}`,{},{withCredentials:!0})}removeRole(i,e){return this.http.delete(`${this.apiUrl}/users/${i}/roles/${e}`,{withCredentials:!0})}static \u0275fac=function(e){return new(e||t)(U(N))};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};function ut(t,i){if(t&1){let e=y();r(0,"div",2)(1,"label")(2,"input",3),u("change",function(){let c=C(e).$implicit,h=d();return b(h.toggleRole(c))}),o(),a(3),o()()}if(t&2){let e=i.$implicit,n=d();s(),j("disabled",n.isDisabled(e)),s(),l("checked",n.user.roles==null?null:n.user.roles.includes(e))("disabled",n.isDisabled(e)),s(),w(" ",e," ")}}var se=class t{constructor(i,e){this.adminService=i;this.authService=e;this.authService.user$.pipe(P(1)).subscribe(n=>{this.currentUser=n})}user;availableRoles=["administrator","content-editor","content-creator"];currentUser=null;isDisabled(i){return i==="administrator"&&this.user.uid===this.currentUser?.uid}toggleRole(i){this.isDisabled(i)||(this.user.roles?.includes(i)?this.adminService.removeRole(this.user.uid,i).subscribe(()=>{this.user.roles=this.user.roles?.filter(e=>e!==i)}):this.adminService.assignRole(this.user.uid,i).subscribe(()=>{this.user.roles||(this.user.roles=[]),this.user.roles.push(i)}))}static \u0275fac=function(e){return new(e||t)(p(z),p(v))};static \u0275cmp=f({type:t,selectors:[["app-role-management"]],inputs:{user:"user"},standalone:!0,features:[g],decls:2,vars:1,consts:[[1,"role-controls"],["class","role-toggle",4,"ngFor","ngForOf"],[1,"role-toggle"],["type","checkbox",3,"change","checked","disabled"]],template:function(e,n){e&1&&(r(0,"div",0),m(1,ut,4,5,"div",1),o()),e&2&&(s(),l("ngForOf",n.availableRoles))},dependencies:[S,D],styles:[".role-controls[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:.5rem}.role-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer}.role-toggle[_ngcontent-%COMP%]   label.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.7}"]})};function ft(t,i){if(t&1&&(r(0,"div",4)(1,"span"),a(2),o(),R(3,"app-role-management",5),o()),t&2){let e=i.$implicit;s(2),A(e.username),s(),l("user",e)}}function gt(t,i){if(t&1&&(r(0,"div",2),m(1,ft,4,2,"div",3),o()),t&2){let e=d();s(),l("ngForOf",e.users)}}var ae=class t{constructor(i){this.adminService=i}users=[];ngOnInit(){this.loadUsers()}loadUsers(){this.adminService.getUsers().subscribe(i=>{this.users=i})}static \u0275fac=function(e){return new(e||t)(p(z))};static \u0275cmp=f({type:t,selectors:[["app-user-list"]],standalone:!0,features:[g],decls:4,vars:1,consts:[[1,"user-list"],["class","users",4,"ngIf"],[1,"users"],["class","user",4,"ngFor","ngForOf"],[1,"user"],[3,"user"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2"),a(2,"User Management"),o(),m(3,gt,2,1,"div",1),o()),e&2&&(s(3),l("ngIf",n.users))},dependencies:[S,D,I,se],styles:[".user-list[_ngcontent-%COMP%]{padding:1rem}.user[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem;border-bottom:1px solid #eee}"]})};var Ge=(t,i)=>{let e=k(_);return k(v).user$.pipe(P(1),V(c=>c?.roles?.includes("administrator")?!0:e.createUrlTree(["/login"])))};var We=(t,i)=>{let e=k(_);return H(t,i).pipe(be(n=>{if(n===!0){let c=localStorage.getItem("redirect");return c?(localStorage.removeItem("redirect"),K(e.parseUrl(c))):K(!0)}return K(n)}))};var Je=[{path:"",loadChildren:()=>import("./chunk-EMSHZPPA.js").then(t=>t.routes),canActivate:[We],pathMatch:"full"},{path:"book",loadChildren:()=>import("./chunk-OTJT7VAQ.js").then(t=>t.BOOK_VIEWER_ROUTES),canActivate:[H]},{path:"book-manager",canActivate:[ne],loadChildren:()=>import("./chunk-T27BWHQF.js").then(t=>t.routes)},{path:"session",loadChildren:()=>import("./chunk-BIE7DZDK.js").then(t=>t.routes),canActivate:[H]},{path:"login",component:Y},{path:"profile",component:ee,canActivate:[H]},{path:"upload",component:ie,canActivate:[ne]},{path:"editorial",component:re,canActivate:[ne]},{path:"auth/github/callback",component:q},{path:"auth/microsoft/callback",component:q},{path:"admin/users",component:ae,canActivate:[Ge]}];var qe=(t,i)=>{let e=t.clone({withCredentials:!0});return i(e)};var Ke={providers:[Fe(Je),X(Oe(),we([qe]))]};function vt(t,i){t&1&&(r(0,"a",8),a(1,"Editorial"),o())}function ht(t,i){t&1&&(r(0,"a",9),a(1,"Book Manager"),o())}function _t(t,i){t&1&&(r(0,"a",10),a(1,"Upload"),o())}function Ct(t,i){t&1&&(r(0,"a",11),a(1,"Admin"),o())}function bt(t,i){if(t&1){let e=y();pe(0),r(1,"a",2),a(2,"Profile"),o(),m(3,vt,2,0,"a",3)(4,ht,2,0,"a",4)(5,_t,2,0,"a",5)(6,Ct,2,0,"a",6),r(7,"a",7),u("click",function(){C(e);let c=d();return b(c.auth.logout())}),a(8,"Logout"),o(),de()}if(t&2){let e=i.ngIf;s(3),l("ngIf",e.roles==null?null:e.roles.includes("content-creator")),s(),l("ngIf",e.roles==null?null:e.roles.includes("content-creator")),s(),l("ngIf",e.roles==null?null:e.roles.includes("content-creator")),s(),l("ngIf",e.roles==null?null:e.roles.includes("administrator"))}}function St(t,i){t&1&&(pe(0),r(1,"a",12),a(2,"Login"),o(),de())}var ce=class t{constructor(i){this.auth=i}static \u0275fac=function(e){return new(e||t)(p(v))};static \u0275cmp=f({type:t,selectors:[["app-nav"]],standalone:!0,features:[g],decls:7,vars:6,consts:[["routerLink","/"],[4,"ngIf"],["routerLink","/profile"],["routerLink","/editorial",4,"ngIf"],["routerLink","/book-manager",4,"ngIf"],["routerLink","/upload",4,"ngIf"],["routerLink","/admin/users",4,"ngIf"],[3,"click"],["routerLink","/editorial"],["routerLink","/book-manager"],["routerLink","/upload"],["routerLink","/admin/users"],["routerLink","/login"]],template:function(e,n){e&1&&(r(0,"nav")(1,"a",0),a(2,"Home"),o(),m(3,bt,9,4,"ng-container",1),F(4,"async"),m(5,St,3,0,"ng-container",1),F(6,"async"),o()),e&2&&(s(3),l("ngIf",W(4,2,n.auth.user$)),s(2),l("ngIf",!W(6,4,n.auth.user$)))},dependencies:[S,I,Q,Ne,Ae],styles:["nav[_ngcontent-%COMP%]{padding:1rem;background:#f8f9fa}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:1rem;text-decoration:none;color:#333;cursor:pointer}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};function xt(t,i){if(t&1){let e=y();r(0,"app-navigation-blocked",1),u("discard",function(){C(e);let c=d();return b(c.onDiscard())})("stay",function(){C(e);let c=d();return b(c.onStay())}),o()}}var le=class t{constructor(i,e,n){this.router=i;this.navigationService=e;this.layoutService=n;this.layoutService.layoutMode$.subscribe(c=>{this.layoutMode=c}),_e([this.router.events.pipe(Ce(c=>c instanceof Ee)),this.navigationService.canNavigate$]).subscribe(([c,h])=>{!h&&c.url!==this.router.url&&(this.pendingUrl=c.url,this.showNavigationBlocked=!0)})}showNavigationBlocked=!1;layoutMode="standard";pendingUrl;onDiscard(){this.navigationService.setNavigationState(!0),this.pendingUrl&&this.router.navigateByUrl(this.pendingUrl),this.showNavigationBlocked=!1}onStay(){this.showNavigationBlocked=!1}static \u0275fac=function(e){return new(e||t)(p(_),p($e),p(Ve))};static \u0275cmp=f({type:t,selectors:[["app-root"]],standalone:!0,features:[g],decls:8,vars:5,consts:[[3,"discard","stay",4,"ngIf"],[3,"discard","stay"]],template:function(e,n){e&1&&(r(0,"header")(1,"h1"),a(2,"Chat History Browser"),o(),r(3,"nav"),R(4,"app-nav"),o()(),r(5,"main"),R(6,"router-outlet"),o(),m(7,xt,1,0,"app-navigation-blocked",0)),e&2&&(j("reader-mode",n.layoutMode==="reader"),s(5),j("reader-mode",n.layoutMode==="reader"),s(2),l("ngIf",n.showNavigationBlocked))},dependencies:[S,I,Ue,ce,Re]})};Pe(le,{providers:[xe(Le.forRoot({sanitize:ye.NONE})),X(),...Ke.providers]}).catch(t=>console.error(t));
