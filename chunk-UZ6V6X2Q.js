import{$ as pe,$a as Mt,A as te,Aa as j,B as N,Ba as Ee,C as ie,Ca as Pe,D as z,Da as Oe,E as B,Ea as Te,F as ue,Fa as $,G as y,Ga as I,H as ne,Ha as xt,I as A,Ia as tt,Ja as fn,K as dn,Ka as _n,L as oe,M as C,Ma as re,N as b,Na as gn,O as Fe,Oa as vn,P as Ii,Pa as Re,Q as g,Qa as we,R as Me,Ra as Cn,S as G,Sa as Ne,T as hn,Ta as _e,Ua as bn,V as un,Va as Di,W as pn,Wa as ge,X as d,Xa as q,Y as v,Ya as O,Z as Je,Za as yn,_ as ki,_a as wn,a as R,aa as K,b as Y,ba as kt,bb as In,ca as w,cb as k,d as xe,da as mn,db as kn,e as Xe,ea as se,eb as Sn,f as M,fa as u,g as he,ga as Si,ha as P,i as bi,ia as l,j as nn,ja as c,k as on,ka as V,la as Q,m as bt,ma as X,na as et,nb as Dn,o as sn,oa as D,p as rn,pa as _,q as an,qa as h,qb as xn,r as yt,ra as me,rb as Et,s as cn,sa as fe,t as yi,ta as St,tb as Mn,u as ln,ua as Dt,ub as En,v as wt,va as be,vb as Pn,w as wi,wa as ye,x as Ce,xa as U,y as Ve,ya as m,z as It,za as L}from"./chunk-OW3CYLMD.js";var ts=["*"];function is(n,t){if(n&1){let e=D();l(0,"div",4)(1,"h2"),m(2),c(),l(3,"button",5),_("click",function(){C(e);let o=h();return b(o.onClose())}),m(4,"\xD7"),c()()}if(n&2){let e=h();d(2),L(e.config.title),d(),u("disabled",!e.config.closeOnBackdrop)}}var Be=class n{config;close=new g;onBackdropClick(){this.config?.closeOnBackdrop&&this.close.emit()}onEscapeKey(){this.config?.closeOnBackdrop&&this.close.emit()}onClose(){this.config?.closeOnBackdrop&&this.close.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-dialog"]],hostBindings:function(e,i){e&1&&_("keydown.escape",function(){return i.onEscapeKey()},!1,pn)},inputs:{config:"config"},outputs:{close:"close"},standalone:!0,features:[I],ngContentSelectors:ts,decls:5,vars:5,consts:[[1,"dialog-backdrop",3,"click"],[1,"dialog-container",3,"click"],["class","dialog-header",4,"ngIf"],[1,"dialog-content"],[1,"dialog-header"],[1,"close-button",3,"click","disabled"]],template:function(e,i){e&1&&(me(),l(0,"div",0),_("click",function(){return i.onBackdropClick()}),l(1,"div",1),_("click",function(s){return s.stopPropagation()}),w(2,is,5,2,"div",2),l(3,"div",3),fe(4),c()()()),e&2&&(d(),Si("width",i.config.width)("height",i.config.height),d(),u("ngIf",i.config==null?null:i.config.title))},dependencies:[k,O],styles:[".dialog-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.dialog-container[_ngcontent-%COMP%]{background:#fff;border-radius:4px;box-shadow:0 2px 8px #0003;min-width:300px;max-width:90vw;max-height:100vh;display:flex;flex-direction:column}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #eee}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.2em}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{border:none;background:none;font-size:1.5em;cursor:pointer;padding:4px 8px}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.dialog-content[_ngcontent-%COMP%]{padding:16px;overflow-y:auto}"]})};var On=class n{discard=new g;stay=new g;dialogConfig={width:"400px",closeOnBackdrop:!0,title:"Navigation Blocked"};onDiscard(){this.discard.emit()}onStay(){this.stay.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-navigation-blocked"]],outputs:{discard:"discard",stay:"stay"},standalone:!0,features:[I],decls:10,vars:1,consts:[[3,"close","config"],["dialog-content",""],["dialog-actions",""],[3,"click"]],template:function(e,i){e&1&&(l(0,"app-dialog",0),_("close",function(){return i.onStay()}),l(1,"div",1),m(2," There are unsaved changes. "),V(3,"br"),m(4," Do you want to discard them and continue? "),c(),l(5,"div",2)(6,"button",3),_("click",function(){return i.onDiscard()}),m(7,"Discard Changes"),c(),l(8,"button",3),_("click",function(){return i.onStay()}),m(9,"Stay Here"),c()()()),e&2&&u("config",i.dialogConfig)},dependencies:[Be],styles:["[_nghost-%COMP%]   [dialog-actions][_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;padding:1rem}[_nghost-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:4px;border:1px solid #ddd;background:#fff;cursor:pointer}[_nghost-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}[_nghost-%COMP%]   button[_ngcontent-%COMP%]:first-child{border-color:#cb2431;color:#cb2431}[_nghost-%COMP%]   button[_ngcontent-%COMP%]:first-child:hover{background:#ffdce0}"]})};var Pt=class n{canNavigateSubject=new he(!0);canNavigate$=this.canNavigateSubject.asObservable();setNavigationState(t){this.canNavigateSubject.next(t)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})};var Pa=()=>ue(Pt).canNavigate$;var ae=class n{constructor(t){this.http=t;this.loadBooks()}apiUrl=xn.apiUrl;booksSubject=new he([]);books$=this.booksSubject.asObservable();activeBookSubject=new M;activeBook$=this.activeBookSubject.asObservable();bookContentSubject=new he([]);bookContent$=this.bookContentSubject.asObservable();setActiveBook(t){this.activeBookSubject.next(t),this.loadBookContent(t)}loadBooks(){this.http.get(`${this.apiUrl}/books`).subscribe(t=>this.booksSubject.next(t))}getBooks(){return this.http.get(`${this.apiUrl}/books`)}createBook(t){return this.http.post(`${this.apiUrl}/books`,t).pipe(Ve({next:()=>{this.loadBooks()}}))}updateBook(t,e){return this.http.put(`${this.apiUrl}/books/${t}`,e).pipe(Ve({next:()=>{this.loadBooks()}}))}getBook(t){return this.http.get(`${this.apiUrl}/books/${t}`)}loadBookContent(t){this.getBookContent(t.id).subscribe(e=>this.buildBookContent(t,e))}buildBookContent(t,e){let i=e.filter(s=>!s.parentId).sort((s,r)=>s.order-r.order),o={id:"book",bookId:`${t.id}`,title:t.title,order:1,type:"book",expanded:!0,children:i};i.forEach(s=>this.setChildren(s,e)),this.bookContentSubject.next([o])}setChildren(t,e){let i=e.filter(o=>o.parentId==t.id).sort((o,s)=>o.order-s.order);(i.length||t.type=="chapter")&&(t.children=i,i.forEach(o=>this.setChildren(o,e)))}getBookContent(t){return this.http.get(`${this.apiUrl}/books/${t}/content`)}updateBookContent(t,e){let i=this.collectChanges(t);return i.removed=e.map(o=>o.id).filter(o=>!`${o}`.startsWith("fake-")),console.log(JSON.stringify(i,null,4)),this.http.put(`${this.apiUrl}/books/${t[0].bookId}/content`,i).pipe(Ve(()=>{this.loadBookContent({id:t[0].bookId,title:t[0].title})}))}collectChanges(t){let e={new:[],modified:[],removed:[]},i=o=>{o.forEach(s=>{s.isNew?e.new.push(this.prepareItemForUpdate(s)):s.isModified&&e.modified.push(this.prepareItemForUpdate(s)),s.children&&i(s.children)})};return i(t),e}prepareItemForUpdate(t){let e={id:t.id,bookId:t.bookId,type:t.type,title:t.title,order:t.order,sessionId:t.sessionId};return t.parentId!=="book"&&(e.parentId=t.parentId),e}static \u0275fac=function(e){return new(e||n)(B(Sn))};static \u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})};var Tn=class n{layoutModeSubject=new he("standard");layoutMode$=this.layoutModeSubject.asObservable();setLayoutMode(t){this.layoutModeSubject.next(t)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ot=class n{_id=0;nextId(){return++this._id}static \u0275fac=function(e){return new(e||n)};static \u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})};var An=n=>({$implicit:n});function ns(n,t){n&1&&et(0)}function os(n,t){if(n&1&&(l(0,"span",8),m(1),c()),n&2){let e=h().$implicit,i=h(2);d(),Ee(" ",i.currentInteraction||0," / ",i.getSessionTotal(e)," ")}}function ss(n,t){n&1&&et(0)}function rs(n,t){if(n&1&&(Q(0),w(1,ss,1,0,"ng-container",2),X()),n&2){let e=h().$implicit;h(2);let i=U(3);d(),u("ngTemplateOutlet",i)("ngTemplateOutletContext",tt(2,An,e.children))}}function as(n,t){if(n&1){let e=D();l(0,"div",4)(1,"span",5),_("click",function(){let o=C(e).$implicit,s=h(2);return b(s.onItemClick(o))}),m(2),w(3,os,2,2,"span",6),c(),w(4,rs,2,4,"ng-container",7),c()}if(n&2){let e=t.$implicit,i=h(2);d(),P("active",e.id==i.currentPosition),d(),Ee(" ",i.typeToIcon[e.type]," ",e.title," "),d(),u("ngIf",e.type==="session"&&e.id==i.currentPosition),d(),u("ngIf",e.children)}}function cs(n,t){if(n&1&&w(0,as,5,6,"div",3),n&2){let e=t.$implicit;u("ngForOf",e)}}var Tt=class n{content=[];currentPosition;currentInteraction;sessionInteractionCounts=new Map;jumpTo=new g;typeToIcon={book:"\u{1F56E}",chapter:"\u{1F4D1}",session:"\u{1F4DD}"};getSessionTotal(t){return this.sessionInteractionCounts.get(t.sessionId)||0}onItemClick(t){t.type==="session"&&t.id==this.currentPosition?this.jumpTo.emit({contentId:t.id,interactionNum:this.currentInteraction}):this.jumpTo.emit({contentId:t.id})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-view-toc"]],inputs:{content:"content",currentPosition:"currentPosition",currentInteraction:"currentInteraction",sessionInteractionCounts:"sessionInteractionCounts"},outputs:{jumpTo:"jumpTo"},standalone:!0,features:[I],decls:4,vars:4,consts:[["tocItem",""],[1,"book-view-toc"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","toc-item",4,"ngFor","ngForOf"],[1,"toc-item"],[3,"click"],["class","progress",4,"ngIf"],[4,"ngIf"],[1,"progress"]],template:function(e,i){if(e&1&&(l(0,"div",1),w(1,ns,1,0,"ng-container",2),c(),w(2,cs,1,1,"ng-template",null,0,re)),e&2){let o=U(3);d(),u("ngTemplateOutlet",o)("ngTemplateOutletContext",tt(2,An,i.content))}},dependencies:[k,q,O,Mt],styles:[".book-view-toc[_ngcontent-%COMP%]{padding:20px}.book-view-toc[_ngcontent-%COMP%]   .toc-item[_ngcontent-%COMP%]{padding-left:20px;line-height:1.8}.book-view-toc[_ngcontent-%COMP%]   .toc-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;gap:8px}.book-view-toc[_ngcontent-%COMP%]   .toc-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#0056b3}.book-view-toc[_ngcontent-%COMP%]   .toc-item[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700}.book-view-toc[_ngcontent-%COMP%]   .toc-item[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{font-size:.9em;color:#666;font-weight:400}"]})};var ls=["container"],ds=["interactionList"];function hs(n,t){if(n&1){let e=D();l(0,"app-interaction-list2",10),_("activeInteractionChange",function(o){C(e);let s=h(2).$implicit,r=h();return b(r.onActiveInteractionChange(o,s.id))})("totalInteractions",function(o){C(e);let s=h(2).$implicit,r=h();return b(r.onTotalInteractions(o,s.sessionId.toString()))})("initialLoadComplete",function(){C(e);let o=h(3);return b(o.onSessionLoaded())}),c()}if(n&2){let e=h(2).$implicit,i=h(),o=U(1);u("sessionId",e.sessionId)("interactionNum",e.id==i.restoredPosition?i.restoredInteractionNum:void 0)("preloadLast",i.shouldPreloadLast(e.id.toString()))("scrollContainer",o)("isActiveSession",e.id==i.currentPosition)}}function us(n,t){if(n&1&&(Q(0),w(1,hs,1,5,"app-interaction-list2",9),X()),n&2){let e=h().$implicit,i=h();d(),u("ngIf",i.visibleSessions.has(e.id.toString()))}}function ps(n,t){if(n&1&&(l(0,"div",6)(1,"h2",7),m(2),c(),w(3,us,2,1,"ng-container",8),c()),n&2){let e=t.$implicit,i=h();P("active",e.id==i.currentPosition),se("data-content-id",e.id)("data-session-id",e.type==="session"?e.sessionId:null),d(2),L(e.title),d(),u("ngIf",e.type==="session")}}var At=class n{content;restoredPosition;_restoredInteractionNum;set restoredInteractionNum(t){this._restoredInteractionNum||(this._restoredInteractionNum=t)}get restoredInteractionNum(){return this._restoredInteractionNum||0}activeItemChange=new g;activeInteractionChange=new g;totalInteractionsChange=new g;bookCompleted=new g;container;interactionLists;activeInteractionNum;currentPosition;flatContent=[];visibleSessions=new Set;initialized=!1;ngOnDestroy(){this.container.nativeElement.removeEventListener("scroll",this.handleScroll)}ngOnChanges(t){if(!this.initialized&&t.content&&this.content.length>0&&this.restoredPosition){this.initialized=!0,this.flatContent=this.flattenContent(this.content);let e=this.findContentItem(this.restoredPosition),i=e?.type==="session"?e:this.findNextSession(e);i&&this.visibleSessions.add(i.id.toString())}}findContentItem(t){return this.flatContent.find(e=>e.id==t)}findNextSession(t){let e=t?this.flatContent.findIndex(i=>i.id==t.id):0;return this.flatContent.slice(e).find(i=>i.type==="session")}INTERACTION_OFFSET=40;scrollInitiated=!1;onSessionLoaded(){setTimeout(()=>{this.setScrollTop(),this.scrollInitiated||(this.scrollInitiated=!0,this.container.nativeElement.addEventListener("scroll",this.handleScroll),this.handleScroll())})}scrollTopSet=!1;setScrollTop(){if(!this.scrollTopSet){let t=this.container.nativeElement,e=t.querySelector(`[data-content-id="${this.restoredPosition}"]`);if(e){let i=e.offsetTop-this.containerOffset;if(this._restoredInteractionNum){let s=e.querySelector(`[data-interaction-num="${this._restoredInteractionNum}"]`);s&&(i=s.offsetTop+e.offsetTop+this.INTERACTION_OFFSET)}t.scrollTop=i;let o=t.scrollTop;this.scrollTopSet=o==i}}}onActiveInteractionChange(t,e){this.activeInteractionNum=t,this.activeInteractionChange.emit(t)}onTotalInteractions(t,e){this.totalInteractionsChange.emit({total:t,sessionId:e})}flattenContent(t){let e=[];return t.forEach(i=>{e.push(i),i.children&&(e=e.concat(this.flattenContent(i.children)))}),e}get containerOffset(){return this.container.nativeElement.querySelector(".content-container").offsetTop}firstScroll=!0;handleScroll=()=>{if(this.firstScroll){this.firstScroll=!1,this.restoredPosition&&(this.currentPosition=this.restoredPosition,this.activeItemChange.emit(this.restoredPosition));return}let t=document.querySelectorAll(".content-item, .end-spacer"),e=Array.from(t).filter(s=>s.getAttribute("data-session-id")).map(s=>({contentId:s.getAttribute("data-content-id"),rectTop:s.getBoundingClientRect().top})).filter(s=>s.rectTop>=this.containerOffset&&s.rectTop<=window.innerHeight).sort((s,r)=>s.rectTop-r.rectTop).find(s=>s);e&&this.visibleSessions.add(e.contentId);let i=Array.from(t).filter(s=>s.getAttribute("data-session-id")).find(s=>{let r=s.getBoundingClientRect(),a=s.getAttribute("data-content-id");return a!=this.currentPosition&&r.bottom<=this.containerOffset&&this.shouldPreloadLast(a)});i&&!this.activeInteractionNum&&this.visibleSessions.add(i.getAttribute("data-content-id"));let o=Array.from(t).map(s=>({contentId:s.getAttribute("data-content-id"),rectTop:s.getBoundingClientRect().top})).filter(s=>s.rectTop<=this.containerOffset+1).sort((s,r)=>r.rectTop-s.rectTop)[0].contentId;o!=this.currentPosition&&(this.activeItemChange.emit(o),this.currentPosition=o,o==="book-end"&&this.bookCompleted.emit())};shouldPreloadLast(t){return this.currentPosition?this.flatContent.findIndex(e=>e.id==t)<this.flatContent.findIndex(e=>e.id==this.currentPosition):!1}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-view-content"]],viewQuery:function(e,i){if(e&1&&(Dt(ls,5),Dt(ds,5)),e&2){let o;be(o=ye())&&(i.container=o.first),be(o=ye())&&(i.interactionLists=o)}},inputs:{content:"content",restoredPosition:"restoredPosition",restoredInteractionNum:"restoredInteractionNum"},outputs:{activeItemChange:"activeItemChange",activeInteractionChange:"activeInteractionChange",totalInteractionsChange:"totalInteractionsChange",bookCompleted:"bookCompleted"},standalone:!0,features:[oe,I],decls:12,vars:3,consts:[["container",""],[1,"book-view-content"],[1,"content-container"],["class","content-item",3,"active",4,"ngFor","ngForOf"],["data-content-id","book-end",1,"end-spacer"],[1,"completion-message"],[1,"content-item"],[1,"title"],[4,"ngIf"],[3,"sessionId","interactionNum","preloadLast","scrollContainer","isActiveSession","activeInteractionChange","totalInteractions","initialLoadComplete",4,"ngIf"],[3,"activeInteractionChange","totalInteractions","initialLoadComplete","sessionId","interactionNum","preloadLast","scrollContainer","isActiveSession"]],template:function(e,i){e&1&&(l(0,"div",1,0)(2,"div",2),w(3,ps,4,6,"div",3),l(4,"div",4)(5,"div",5)(6,"span"),m(7,"\u{1F389}"),c(),l(8,"h3"),m(9,"You've reached the end!"),c(),l(10,"p"),m(11,"Congratulations on completing this book"),c()()()()()),e&2&&(d(3),u("ngForOf",i.flatContent),d(),P("active",i.currentPosition==="book-end"))},dependencies:[k,q,O,Pn],styles:[".book-view-content[_ngcontent-%COMP%]{height:100%;overflow:auto}.book-view-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.book-view-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .end-spacer[_ngcontent-%COMP%]{height:100vh;display:flex;align-items:center;justify-content:center}.book-view-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .end-spacer[_ngcontent-%COMP%]   .completion-message[_ngcontent-%COMP%]{text-align:center;color:#666}.book-view-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .end-spacer[_ngcontent-%COMP%]   .completion-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:2em;display:block;margin-bottom:1rem}.book-view-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .end-spacer[_ngcontent-%COMP%]   .completion-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem}.book-view-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .end-spacer.active[_ngcontent-%COMP%]{background-color:#e3f2fd;border-radius:4px}.book-view-content[_ngcontent-%COMP%]   .content-item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;padding:24px 0 6px;border-bottom:1px solid #eee}.book-view-content[_ngcontent-%COMP%]   .content-item[_ngcontent-%COMP%]:first-child{padding-top:36px}.book-view-content[_ngcontent-%COMP%]   .content-item.active[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#007bff;border-bottom-color:#007bff}"]})};function ms(n,t){n&1&&(l(0,"span",11),m(1," \u2713 Completed "),c())}function fs(n,t){if(n&1){let e=D();l(0,"span",14),_("click",function(){C(e);let o=h(2);return b(o.copyContentUrl())}),m(1),c()}if(n&2){let e=h(2);d(),j(" \xBB ",e.currentTitle," ")}}function _s(n,t){if(n&1){let e=D();l(0,"span",15),_("click",function(){C(e);let o=h(2);return b(o.copyInteractionUrl())}),m(1),c()}if(n&2){let e=h(2);d(),Ee(" \xBB ",e.activeInteraction||0," / ",e.totalInteractions," ")}}function gs(n,t){if(n&1&&w(0,fs,2,1,"span",12)(1,_s,2,2,"span",13),n&2){let e=h();u("ngIf",e.currentTitle&&e.currentPosition!=(e.content[0]==null?null:e.content[0].id)),d(),u("ngIf",e.isSessionItem&&e.activeInteraction||!1)}}function vs(n,t){if(n&1&&(l(0,"div",16),m(1),c()),n&2){let e=h();d(),L(e.copyMessage)}}function Cs(n,t){if(n&1){let e=D();l(0,"app-book-view-toc",17),_("jumpTo",function(o){C(e);let s=h();return b(s.onJumpTo(o))}),c()}if(n&2){let e=h();u("content",e.content)("currentPosition",e.currentPosition)("currentInteraction",e.activeInteraction)("sessionInteractionCounts",e.sessionInteractionCounts)}}function bs(n,t){if(n&1){let e=D();l(0,"app-book-view-content",18),_("activeItemChange",function(o){C(e);let s=h();return b(s.onActiveItemChange(o))})("activeInteractionChange",function(o){C(e);let s=h();return b(s.onActiveInteractionChange(o))})("totalInteractionsChange",function(o){C(e);let s=h();return b(s.onTotalInteractions(o))})("bookCompleted",function(){C(e);let o=h();return b(o.onBookCompleted())}),c()}if(n&2){let e=h();u("content",e.content)("restoredPosition",e.restoredPosition)("restoredInteractionNum",e.activeInteraction||0)}}var Vn=class n{constructor(t,e){this.bookService=t;this.storageService=e;this.bookService.activeBook$.subscribe(i=>{this.book=i,this.bookService.loadBookContent({id:this.book.id,title:this.book.title})}),this.bookService.bookContent$.subscribe(i=>{if(this.content=i,this.book?.id){let o=this.storageService.getBookPosition(this.book.id);o&&o.contentId?this.findItem(o.contentId)?(this.restoredPosition=o.contentId,this.onActiveItemChange(this.restoredPosition),o.interactionNum&&this.onActiveInteractionChange(parseInt(o.interactionNum))):this.onActiveItemChange(i[0].id):this.onActiveItemChange(i[0].id)}})}book;showToc=!1;content=[];currentPosition;restoredPosition;currentTitle;sessionInteractionCounts=new Map;currentItem;isSessionItem=!1;totalInteractions;activeInteraction;onJumpTo(t){console.log(t),this.restoredPosition=t.contentId,this.activeInteraction=t.interactionNum||void 0,this.storageService.saveBookPosition(this.book?.id,{contentId:t.contentId,interactionNum:t.interactionNum?t.interactionNum.toString():void 0}),this.showToc=!1}onActiveItemChange(t){t!=this.currentPosition&&(this.currentPosition=t,this.currentItem=this.findItem(t),this.isSessionItem=!!this.currentItem&&!!this.currentItem.sessionId,this.totalInteractions=this.isSessionItem?this.sessionInteractionCounts.get(this.currentItem.sessionId.toString()):void 0,this.currentTitle=this.currentItem?.title,this.activeInteraction=void 0,this.storageService.saveBookPosition(this.book?.id,{contentId:t}))}onActiveInteractionChange(t){this.activeInteraction=t,this.currentItem?.sessionId&&this.storageService.saveBookPosition(this.book?.id,{contentId:this.currentPosition,interactionNum:t.toString()})}onTotalInteractions(t){this.sessionInteractionCounts.set(t.sessionId,t.total),this.isSessionItem&&this.currentItem?.sessionId==t.sessionId&&(this.totalInteractions=t.total)}toggleView(){this.showToc=!this.showToc}findItem(t){let e=i=>{for(let o of i){if(o.id==t)return o;if(o.children){let s=e(o.children);if(s)return s}}};return e(this.content)}onBookCompleted(){this.storageService.saveBookPosition(this.book?.id,{completed:!0})}copyMessage="";showCopyMessage(t){this.copyMessage=`${t} URL copied to clipboard`,setTimeout(()=>this.copyMessage="",2e3)}copyBookUrl(){let t=`${window.location.origin}/book/${this.book?.id}`;navigator.clipboard.writeText(t),this.showCopyMessage("Book")}copyContentUrl(){let t=`${window.location.origin}/book/${this.book?.id}/${this.currentPosition}`;navigator.clipboard.writeText(t),this.showCopyMessage("Section")}copyInteractionUrl(){let t=`${window.location.origin}/book/${this.book?.id}/${this.currentPosition}/${this.activeInteraction}`;navigator.clipboard.writeText(t),this.showCopyMessage("Interaction")}static \u0275fac=function(e){return new(e||n)(v(ae),v(Mn))};static \u0275cmp=y({type:n,selectors:[["app-book-view"]],standalone:!0,features:[I],decls:17,vars:7,consts:[["notCompleted",""],[1,"book-view"],[1,"header-content"],["routerLink","/",1,"back-link"],["title","Click to copy book URL",1,"copyable",3,"click"],["class","completed-badge",4,"ngIf","ngIfElse"],["class","copy-message",4,"ngIf"],[1,"view-toggle",3,"click"],[1,"view-content"],[3,"content","currentPosition","currentInteraction","sessionInteractionCounts","jumpTo",4,"ngIf"],[3,"content","restoredPosition","restoredInteractionNum","activeItemChange","activeInteractionChange","totalInteractionsChange","bookCompleted",4,"ngIf"],[1,"completed-badge"],["class","current-item copyable","title","Click to copy URL to this section",3,"click",4,"ngIf"],["class","current-item copyable","title","Click to copy URL to this interaction",3,"click",4,"ngIf"],["title","Click to copy URL to this section",1,"current-item","copyable",3,"click"],["title","Click to copy URL to this interaction",1,"current-item","copyable",3,"click"],[1,"copy-message"],[3,"jumpTo","content","currentPosition","currentInteraction","sessionInteractionCounts"],[3,"activeItemChange","activeInteractionChange","totalInteractionsChange","bookCompleted","content","restoredPosition","restoredInteractionNum"]],template:function(e,i){if(e&1){let o=D();l(0,"div",1)(1,"header")(2,"div",2)(3,"a",3),m(4,"\u2190 Back"),c(),l(5,"h1")(6,"span",4),_("click",function(){return C(o),b(i.copyBookUrl())}),m(7),c(),w(8,ms,2,0,"span",5)(9,gs,2,2,"ng-template",null,0,re),c()(),w(11,vs,2,1,"div",6),l(12,"button",7),_("click",function(){return C(o),b(i.toggleView())}),m(13),c()(),l(14,"div",8),w(15,Cs,1,4,"app-book-view-toc",9)(16,bs,1,3,"app-book-view-content",10),c()()}if(e&2){let o=U(10);d(7),j(" ",i.book==null?null:i.book.title," "),d(),u("ngIf",i.currentPosition==="book-end")("ngIfElse",o),d(3),u("ngIf",i.copyMessage),d(2),j(" ",i.showToc?"Read":"Contents"," "),d(2),u("ngIf",i.showToc),d(),u("ngIf",!i.showToc)}},dependencies:[k,O,Tt,At,Dn],styles:[".book-view[_ngcontent-%COMP%]{height:100vh;display:flex;flex-direction:column}.book-view[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]{align-self:flex-end;margin:10px}.book-view[_ngcontent-%COMP%]   .view-content[_ngcontent-%COMP%]{flex:1;overflow:auto}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{padding:1rem;background:#f5f5f5;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center;position:relative}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]{text-decoration:none;color:#333;font-size:.9em}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]:hover{color:#007bff}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.2rem}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .current-item[_ngcontent-%COMP%]{color:#666;font-size:.9em;margin-left:8px}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .copyable[_ngcontent-%COMP%]{cursor:pointer}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .copyable[_ngcontent-%COMP%]:hover{color:#007bff}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .current-item.copyable[_ngcontent-%COMP%]:hover{color:#007bff}.book-view[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .copy-message[_ngcontent-%COMP%]{color:#28a745;font-size:.9em;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;background:#fff;padding:4px 8px;border-radius:4px;box-shadow:0 2px 4px #0000001a}.book-view[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{flex:1;overflow:auto}.book-view[_ngcontent-%COMP%]   .completed-badge[_ngcontent-%COMP%]{color:#28a745;font-size:.9em;margin-left:8px;font-weight:400}"]})};var ys=["*"],je=class n{title;active=!1;sticky=!1;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-tab-item"]],inputs:{title:[0,"tabTitle","title"],active:"active",sticky:"sticky"},standalone:!0,features:[I],ngContentSelectors:ys,decls:2,vars:2,consts:[[1,"pane"]],template:function(e,i){e&1&&(me(),l(0,"div",0),fe(1),c()),e&2&&P("displayNone",!i.active)},dependencies:[k],styles:[".displayNone[_ngcontent-%COMP%]{display:none}.pane[_ngcontent-%COMP%]{padding:0}"]})};var ws=["*"];function Is(n,t){if(n&1){let e=D();l(0,"div",4),_("click",function(){let o=C(e).$implicit,s=h();return b(s.selectTab(o))}),m(1),c()}if(n&2){let e=t.$implicit,i=h();P("active",e.active)("disabled",i.disableTabChange),d(),j(" ",e.title," ")}}var Vt=class n{isSticky=!1;disableTabChange=!1;tabs;ngAfterContentInit(){this.tabs.filter(e=>e.active).length===0&&this.selectTab(this.tabs.first)}selectTab(t){this.disableTabChange||(this.tabs.toArray().forEach(e=>e.active=!1),this.isSticky=t.sticky,t.active=!0)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-tab-view"]],contentQueries:function(e,i,o){if(e&1&&St(o,je,4),e&2){let s;be(s=ye())&&(i.tabs=s)}},inputs:{disableTabChange:"disableTabChange"},standalone:!0,features:[I],ngContentSelectors:ws,decls:5,vars:3,consts:[[1,"tab-container"],[1,"tab-header"],["class","tab",3,"active","disabled","click",4,"ngFor","ngForOf"],[1,"tab-content"],[1,"tab",3,"click"]],template:function(e,i){e&1&&(me(),l(0,"div",0)(1,"div",1),w(2,Is,2,5,"div",2),c(),l(3,"div",3),fe(4),c()()),e&2&&(d(2),u("ngForOf",i.tabs),d(),P("stickyContent",i.isSticky))},dependencies:[k,q],styles:[".tab-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.tab-container[_ngcontent-%COMP%]     .tab-header{position:sticky;top:0;background:#fff;z-index:10;border-bottom:1px solid #eee;display:flex}.tab-container[_ngcontent-%COMP%]     .stickyContent{position:sticky;top:48px;background:#fff}.tab-container[_ngcontent-%COMP%]     .tab{padding:8px 16px;cursor:pointer}.tab-container[_ngcontent-%COMP%]     .tab.disabled:not(.active){color:#999;cursor:not-allowed}.tab-container[_ngcontent-%COMP%]     .tab.active{background:#fff;border-bottom:2px solid #333;cursor:default}.tab-container[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{position:relative;top:0}.tab-container[_ngcontent-%COMP%]   .tab-content.stickyContent[_ngcontent-%COMP%]{position:sticky;top:48px;background:#fff}.tab-container[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]     [tab-content]:not(.active){display:none}"]})};var ks=["*"];function Ss(n,t){n&1&&(Q(0),fe(1),X())}var Ft=class n{constructor(t){this.elementRef=t}isExpanded=!0;expandedChange=new g;toggleSidebar(){this.isExpanded=!this.isExpanded,this.expandedChange.emit(this.isExpanded)}ngAfterViewInit(){this.updateSidebarHeight()}updateSidebarHeight(){let t=this.elementRef.nativeElement.querySelector(".sidebar"),e=t.getBoundingClientRect(),i=window.innerHeight-e.top;t.style.height=`${i}px`}static \u0275fac=function(e){return new(e||n)(v(G))};static \u0275cmp=y({type:n,selectors:[["app-sidebar"]],hostBindings:function(e,i){e&1&&_("resize",function(){return i.updateSidebarHeight()},!1,un)},inputs:{isExpanded:"isExpanded"},outputs:{expandedChange:"expandedChange"},standalone:!0,features:[I],ngContentSelectors:ks,decls:6,vars:4,consts:[[1,"sidebar"],[1,"sidebar-header"],[1,"toggle-btn",3,"click"],[1,"sidebar-content"],[4,"ngIf"]],template:function(e,i){e&1&&(me(),l(0,"div",0)(1,"div",1)(2,"button",2),_("click",function(){return i.toggleSidebar()}),m(3),c()(),l(4,"div",3),w(5,Ss,2,0,"ng-container",4),c()()),e&2&&(P("expanded",i.isExpanded),d(3),j(" ",i.isExpanded?"\u2190":"\u2192"," "),d(2),u("ngIf",i.isExpanded))},dependencies:[k,O],styles:[".sidebar[_ngcontent-%COMP%]{transition:width .3s ease;background:#f5f5f5;border-right:1px solid #ddd}.sidebar.expanded[_ngcontent-%COMP%]{width:250px}.sidebar[_ngcontent-%COMP%]:not(.expanded){width:50px}.sidebar-header[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid #ddd}.toggle-btn[_ngcontent-%COMP%]{cursor:pointer;border:none;background:none;padding:4px 8px}.sidebar-content[_ngcontent-%COMP%]{overflow:hidden}"]})};function Rt(n,t=0){return Ds(n)?Number(n):arguments.length===2?t:0}function Ds(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function Fn(n){return Array.isArray(n)?n:[n]}function ce(n){return n instanceof G?n.nativeElement:n}var Mi;try{Mi=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Mi=!1}var Ei=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?kn(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Mi)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(B(hn))}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var it;function xs(){if(it==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>it=!0}))}finally{it=it||!1}return it}function nt(n){return xs()?n:!!n.capture}var xi;function Ms(){if(xi==null){let n=typeof document<"u"?document.head:null;xi=!!(n&&(n.createShadowRoot||n.attachShadow))}return xi}function Nt(n){if(Ms()){let t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function ot(n){return n.composedPath?n.composedPath()[0]:n.target}var Ps=new z("cdk-dir-doc",{providedIn:"root",factory:Os});function Os(){return ue(ge)}var Ts=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function As(n){let t=n?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?Ts.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var Pi=(()=>{class n{constructor(e){if(this.value="ltr",this.change=new g,e){let i=e.body?e.body.dir:null,o=e.documentElement?e.documentElement.dir:null;this.value=As(i||o||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||n)(B(Ps,8))}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Rs=20,Rn=(()=>{class n{constructor(e,i,o){this._ngZone=e,this._platform=i,this._scrolled=new M,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=o}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=Rs){return this._platform.isBrowser?new Xe(i=>{this._globalSubscription||this._addGlobalListener();let o=e>0?this._scrolled.pipe(yi(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):on()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){let o=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(cn(s=>!s||o.indexOf(s)>-1))}getAncestorScrollContainers(e){let i=[];return this.scrollContainers.forEach((o,s)=>{this._scrollableContainsElement(s,e)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,i){let o=ce(i),s=e.getElementRef().nativeElement;do if(o==s)return!0;while(o=o.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let e=this._getWindow();return rn(e.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(i){return new(i||n)(B(Me),B(Ei),B(ge,8))}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ns=20,Nn=(()=>{class n{constructor(e,i,o){this._platform=e,this._change=new M,this._changeListener=s=>{this._change.next(s)},this._document=o,i.runOutsideAngular(()=>{if(e.isBrowser){let s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:i,height:o}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+o,right:e.left+i,height:o,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,i=this._getWindow(),o=e.documentElement,s=o.getBoundingClientRect(),r=-s.top||e.body.scrollTop||i.scrollY||o.scrollTop||0,a=-s.left||e.body.scrollLeft||i.scrollX||o.scrollLeft||0;return{top:r,left:a}}change(e=Ns){return e>0?this._change.pipe(yi(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(i){return new(i||n)(B(Ei),B(Me),B(ge,8))}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Bn=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ne({type:n})}static{this.\u0275inj=ie({})}}return n})();function Ln(n){return n.buttons===0||n.detail===0}function jn(n){let t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}function oo(n){let t=n.cloneNode(!0),e=t.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();t.removeAttribute("id");for(let o=0;o<e.length;o++)e[o].removeAttribute("id");return i==="canvas"?Gn(n,t):(i==="input"||i==="select"||i==="textarea")&&zn(n,t),Hn("canvas",n,t,Gn),Hn("input, textarea, select",n,t,zn),t}function Hn(n,t,e,i){let o=t.querySelectorAll(n);if(o.length){let s=e.querySelectorAll(n);for(let r=0;r<o.length;r++)i(o[r],s[r])}}var Ls=0;function zn(n,t){t.type!=="file"&&(t.value=n.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${Ls++}`)}function Gn(n,t){let e=t.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}function Ni(n){let t=n.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function Ti(n,t,e){let{top:i,bottom:o,left:s,right:r}=n;return e>=i&&e<=o&&t>=s&&t<=r}function rt(n,t,e){n.top+=t,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function Un(n,t,e,i){let{top:o,right:s,bottom:r,left:a,width:p,height:f}=n,S=p*t,E=f*t;return i>o-E&&i<r+E&&e>a-S&&e<s+S}var Ht=class{constructor(t){this._document=t,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Ni(e)})})}handleScroll(t){let e=ot(t),i=this.positions.get(e);if(!i)return null;let o=i.scrollPosition,s,r;if(e===this._document){let f=this.getViewportScrollPosition();s=f.top,r=f.left}else s=e.scrollTop,r=e.scrollLeft;let a=o.top-s,p=o.left-r;return this.positions.forEach((f,S)=>{f.clientRect&&e!==S&&e.contains(S)&&rt(f.clientRect,a,p)}),o.top=s,o.left=r,{top:a,left:p}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function so(n,t){let e=n.rootNodes;if(e.length===1&&e[0].nodeType===t.ELEMENT_NODE)return e[0];let i=t.createElement("div");return e.forEach(o=>i.appendChild(o)),i}function Bi(n,t,e){for(let i in t)if(t.hasOwnProperty(i)){let o=t[i];o?n.setProperty(i,o,e?.has(i)?"important":""):n.removeProperty(i)}return n}function He(n,t){let e=t?"":"none";Bi(n.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function $n(n,t,e){Bi(n.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function zt(n,t){return t&&t!="none"?n+" "+t:n}function Wn(n,t){n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.transform=Gt(t.left,t.top)}function Gt(n,t){return`translate3d(${Math.round(n)}px, ${Math.round(t)}px, 0)`}function Zn(n){let t=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*t}function js(n){let t=getComputedStyle(n),e=Oi(t,"transition-property"),i=e.find(a=>a==="transform"||a==="all");if(!i)return 0;let o=e.indexOf(i),s=Oi(t,"transition-duration"),r=Oi(t,"transition-delay");return Zn(s[o])+Zn(r[o])}function Oi(n,t){return n.getPropertyValue(t).split(",").map(i=>i.trim())}var Hs=new Set(["position"]),Ai=class{get element(){return this._preview}constructor(t,e,i,o,s,r,a,p,f){this._document=t,this._rootElement=e,this._direction=i,this._initialDomRect=o,this._previewTemplate=s,this._previewClass=r,this._pickupPositionOnPage=a,this._initialTransform=p,this._zIndex=f}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),Kn(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return js(this._preview)}addEventListener(t,e){this._preview.addEventListener(t,e)}removeEventListener(t,e){this._preview.removeEventListener(t,e)}_createPreview(){let t=this._previewTemplate,e=this._previewClass,i=t?t.template:null,o;if(i&&t){let s=t.matchSize?this._initialDomRect:null,r=t.viewContainer.createEmbeddedView(i,t.context);r.detectChanges(),o=so(r,this._document),this._previewEmbeddedView=r,t.matchSize?Wn(o,s):o.style.transform=Gt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else o=oo(this._rootElement),Wn(o,this._initialDomRect),this._initialTransform&&(o.style.transform=this._initialTransform);return Bi(o.style,{"pointer-events":"none",margin:Kn(o)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Hs),He(o,!1),o.classList.add("cdk-drag-preview"),o.setAttribute("popover","manual"),o.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(s=>o.classList.add(s)):o.classList.add(e)),o}};function Kn(n){return"showPopover"in n}var qn=nt({passive:!0}),Bt=nt({passive:!1}),Yn=nt({passive:!1,capture:!0}),zs=800,Qn=new Set(["position"]),Vi=class{get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(e=>He(e,t)))}constructor(t,e,i,o,s,r){this._config=e,this._document=i,this._ngZone=o,this._viewportRuler=s,this._dragDropRegistry=r,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=pe(!1),this._moveEvents=new M,this._pointerMoveSubscription=xe.EMPTY,this._pointerUpSubscription=xe.EMPTY,this._scrollSubscription=xe.EMPTY,this._resizeSubscription=xe.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this.scale=1,this._disabled=!1,this.beforeStarted=new M,this.started=new M,this.released=new M,this.ended=new M,this.entered=new M,this.exited=new M,this.dropped=new M,this.moved=this._moveEvents,this._pointerDown=a=>{if(this.beforeStarted.next(),this._handles.length){let p=this._getTargetHandle(a);p&&!this._disabledHandles.has(p)&&!this.disabled&&this._initializeDragSequence(p,a)}else this.disabled||this._initializeDragSequence(this._rootElement,a)},this._pointerMove=a=>{let p=this._getPointerPositionOnPage(a);if(!this._hasStartedDragging()){let S=Math.abs(p.x-this._pickupPositionOnPage.x),E=Math.abs(p.y-this._pickupPositionOnPage.y);if(S+E>=this._config.dragStartThreshold){let ee=Date.now()>=this._dragStartTime+this._getDragStartDelay(a),de=this._dropContainer;if(!ee){this._endDragSequence(a);return}(!de||!de.isDragging()&&!de.isReceiving())&&(a.cancelable&&a.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(a)))}return}a.cancelable&&a.preventDefault();let f=this._getConstrainedPointerPosition(p);if(this._hasMoved=!0,this._lastKnownPointerPosition=p,this._updatePointerDirectionDelta(f),this._dropContainer)this._updateActiveDropContainer(f,p);else{let S=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,E=this._activeTransform;E.x=f.x-S.x+this._passiveTransform.x,E.y=f.y-S.y+this._passiveTransform.y,this._applyRootElementTransform(E.x,E.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:f,event:a,distance:this._getDragDistance(f),delta:this._pointerDirectionDelta})})},this._pointerUp=a=>{this._endDragSequence(a)},this._nativeDragStart=a=>{if(this._handles.length){let p=this._getTargetHandle(a);p&&!this._disabledHandles.has(p)&&!this.disabled&&a.preventDefault()}else this.disabled||a.preventDefault()},this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new Ht(i),r.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(i=>ce(i)),this._handles.forEach(i=>He(i,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let e=ce(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,Bt),e.addEventListener("touchstart",this._pointerDown,qn),e.addEventListener("dragstart",this._nativeDragStart,Bt)}),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?ce(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),He(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),He(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",Jn,Yn)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){st(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),i=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{e.addEventListener("selectstart",Jn,Yn)}),i){let o=this._rootElement,s=o.parentNode,r=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(a,o),this._initialTransform=o.style.transform||"",this._preview=new Ai(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,e)),$n(o,!1,Qn),this._document.body.appendChild(s.replaceChild(r,o)),this.started.next({source:this,event:t}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();let i=this.isDragging(),o=st(e),s=!o&&e.button!==0,r=this._rootElement,a=ot(e),p=!o&&this._lastTouchEventTime&&this._lastTouchEventTime+zs>Date.now(),f=o?jn(e):Ln(e);if(a&&a.draggable&&e.type==="mousedown"&&e.preventDefault(),i||s||p||f)return;if(this._handles.length){let F=r.style;this._rootElementTapHighlight=F.webkitTapHighlightColor||"",F.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(F=>this._updateOnScroll(F)),this._boundaryElement&&(this._boundaryRect=Ni(this._boundaryElement));let S=this._previewTemplate;this._pickupPositionInElement=S&&S.template&&!S.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,e);let E=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:E.x,y:E.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){$n(this._rootElement,!0,Qn),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,i=e.getItemIndex(this),o=this._getPointerPositionOnPage(t),s=this._getDragDistance(o),r=e._isOverContainer(o.x,o.y);this.ended.next({source:this,distance:s,dropPoint:o,event:t}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:r,distance:s,dropPoint:o,event:t}),e.drop(this,i,this._initialIndex,this._initialContainer,r,s,o,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:o}){let s=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,t,e,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,o),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let o=r=>{(!r||this._preview&&ot(r)===this._preview.element&&r.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",o),i(),clearTimeout(s))},s=setTimeout(o,e*1.5);this._preview.addEventListener("transitionend",o)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,e=t?t.template:null,i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=so(this._placeholderRef,this._document)):i=oo(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(t,e,i){let o=e===this._rootElement?null:e,s=o?o.getBoundingClientRect():t,r=st(i)?i.targetTouches[0]:i,a=this._getViewportScrollPosition(),p=r.pageX-s.left-a.left,f=r.pageY-s.top-a.top;return{x:s.left-t.left+p,y:s.top-t.top+f}}_getPointerPositionOnPage(t){let e=this._getViewportScrollPosition(),i=st(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,o=i.pageX-e.left,s=i.pageY-e.top;if(this._ownerSVGElement){let r=this._ownerSVGElement.getScreenCTM();if(r){let a=this._ownerSVGElement.createSVGPoint();return a.x=o,a.y=s,a.matrixTransform(r.inverse())}}return{x:o,y:s}}_getConstrainedPointerPosition(t){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:o}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||e==="x"?o=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:s,y:r}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:p,height:f}=this._getPreviewRect(),S=a.top+r,E=a.bottom-(f-r),F=a.left+s,ee=a.right-(p-s);i=Xn(i,F,ee),o=Xn(o,S,E)}return{x:i,y:o}}_updatePointerDirectionDelta(t){let{x:e,y:i}=t,o=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,r=Math.abs(e-s.x),a=Math.abs(i-s.y);return r>this._config.pointerDirectionChangeThreshold&&(o.x=e>s.x?1:-1,s.x=e),a>this._config.pointerDirectionChangeThreshold&&(o.y=i>s.y?1:-1,s.y=i),o}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,He(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,Bt),t.removeEventListener("touchstart",this._pointerDown,qn),t.removeEventListener("dragstart",this._nativeDragStart,Bt)}_applyRootElementTransform(t,e){let i=1/this.scale,o=Gt(t*i,e*i),s=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=s.transform&&s.transform!="none"?s.transform:""),s.transform=zt(o,this._initialTransform)}_applyPreviewTransform(t,e){let i=this._previewTemplate?.template?void 0:this._initialTransform,o=Gt(t,e);this._preview.setTransform(zt(o,i))}_getDragDistance(t){let e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(t===0&&e===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),o=this._boundaryElement.getBoundingClientRect();if(o.width===0&&o.height===0||i.width===0&&i.height===0)return;let s=o.left-i.left,r=i.right-o.right,a=o.top-i.top,p=i.bottom-o.bottom;o.width>i.width?(s>0&&(t+=s),r>0&&(t-=r)):t=0,o.height>i.height?(a>0&&(e+=a),p>0&&(e-=p)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){let e=this.dragStartDelay;return typeof e=="number"?e:st(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){let e=this._parentPositions.handleScroll(t);if(e){let i=ot(t);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&rt(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Nt(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){let i=this._previewContainer||"global";if(i==="parent")return t;if(i==="global"){let o=this._document;return e||o.fullscreenElement||o.webkitFullscreenElement||o.mozFullScreenElement||o.msFullscreenElement||o.body}return ce(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}};function Xn(n,t,e){return Math.max(t,Math.min(e,n))}function st(n){return n.type[0]==="t"}function Jn(n){n.preventDefault()}function ro(n,t,e){let i=eo(t,n.length-1),o=eo(e,n.length-1);if(i===o)return;let s=n[i],r=o<i?-1:1;for(let a=i;a!==o;a+=r)n[a]=n[a+r];n[o]=s}function eo(n,t){return Math.max(0,Math.min(t,n))}var Ut=class{constructor(t){this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(t){this.withItems(t)}sort(t,e,i,o){let s=this._itemPositions,r=this._getItemIndexFromPointerPosition(t,e,i,o);if(r===-1&&s.length>0)return null;let a=this.orientation==="horizontal",p=s.findIndex(H=>H.drag===t),f=s[r],S=s[p].clientRect,E=f.clientRect,F=p>r?1:-1,ee=this._getItemOffsetPx(S,E,F),de=this._getSiblingOffsetPx(p,s,F),De=s.slice();return ro(s,p,r),s.forEach((H,Ct)=>{if(De[Ct]===H)return;let Ji=H.drag===t,Ci=Ji?ee:de,en=Ji?t.getPlaceholderElement():H.drag.getRootElement();H.offset+=Ci;let tn=Math.round(H.offset*(1/H.drag.scale));a?(en.style.transform=zt(`translate3d(${tn}px, 0, 0)`,H.initialTransform),rt(H.clientRect,0,Ci)):(en.style.transform=zt(`translate3d(0, ${tn}px, 0)`,H.initialTransform),rt(H.clientRect,Ci,0))}),this._previousSwap.overlaps=Ti(E,e,i),this._previousSwap.drag=f.drag,this._previousSwap.delta=a?o.x:o.y,{previousIndex:p,currentIndex:r}}enter(t,e,i,o){let s=o==null||o<0?this._getItemIndexFromPointerPosition(t,e,i):o,r=this._activeDraggables,a=r.indexOf(t),p=t.getPlaceholderElement(),f=r[s];if(f===t&&(f=r[s+1]),!f&&(s==null||s===-1||s<r.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(f=r[0]),a>-1&&r.splice(a,1),f&&!this._dragDropRegistry.isDragging(f)){let S=f.getRootElement();S.parentElement.insertBefore(p,S),r.splice(s,0,t)}else this._element.appendChild(p),r.push(t);p.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let e=t.getRootElement();if(e){let i=this._itemPositions.find(o=>o.drag===t)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===t)}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:i})=>{rt(i,t,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:Ni(i)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getItemOffsetPx(t,e,i){let o=this.orientation==="horizontal",s=o?e.left-t.left:e.top-t.top;return i===-1&&(s+=o?e.width-t.width:e.height-t.height),s}_getSiblingOffsetPx(t,e,i){let o=this.orientation==="horizontal",s=e[t].clientRect,r=e[t+i*-1],a=s[o?"width":"height"]*i;if(r){let p=o?"left":"top",f=o?"right":"bottom";i===-1?a-=r.clientRect[p]-s[f]:a+=s[p]-r.clientRect[f]}return a}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,o=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let r=i[i.length-1].clientRect;return o?t>=r.right:e>=r.bottom}else{let r=i[0].clientRect;return o?t<=r.left:e<=r.top}}_getItemIndexFromPointerPosition(t,e,i,o){let s=this.orientation==="horizontal",r=this._itemPositions.findIndex(({drag:a,clientRect:p})=>{if(a===t)return!1;if(o){let f=s?o.x:o.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&f===this._previousSwap.delta)return!1}return s?e>=Math.floor(p.left)&&e<Math.floor(p.right):i>=Math.floor(p.top)&&i<Math.floor(p.bottom)});return r===-1||!this._sortPredicate(r,t)?-1:r}},Fi=class{constructor(t,e){this._document=t,this._dragDropRegistry=e,this._previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1},this._relatedNodes=[]}start(t){let e=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<e.length;i++){let o=e[i];this._relatedNodes.push([o,o.nextSibling])}this.withItems(t)}sort(t,e,i,o){let s=this._getItemIndexFromPointerPosition(t,e,i),r=this._previousSwap;if(s===-1||this._activeItems[s]===t)return null;let a=this._activeItems[s];if(r.drag===a&&r.overlaps&&r.deltaX===o.x&&r.deltaY===o.y)return null;let p=this.getItemIndex(t),f=t.getPlaceholderElement(),S=a.getRootElement();s>p?S.after(f):S.before(f),ro(this._activeItems,p,s);let E=this._getRootNode().elementFromPoint(e,i);return r.deltaX=o.x,r.deltaY=o.y,r.drag=a,r.overlaps=S===E||S.contains(E),{previousIndex:p,currentIndex:s}}enter(t,e,i,o){let s=o==null||o<0?this._getItemIndexFromPointerPosition(t,e,i):o;s===-1&&(s=this._getClosestItemIndexToPointer(t,e,i));let r=this._activeItems[s],a=this._activeItems.indexOf(t);a>-1&&this._activeItems.splice(a,1),r&&!this._dragDropRegistry.isDragging(r)?(this._activeItems.splice(s,0,t),r.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,e=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[o,s]=this._relatedNodes[i];o.parentNode===t&&o.nextSibling!==s&&(s===null?t.appendChild(o):s.parentNode===t&&t.insertBefore(o,s))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,e,i){let o=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(i)),s=o?this._activeItems.findIndex(r=>{let a=r.getRootElement();return o===a||a.contains(o)}):-1;return s===-1||!this._sortPredicate(s,t)?-1:s}_getRootNode(){return this._rootNode||(this._rootNode=Nt(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,e,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let o=1/0,s=-1;for(let r=0;r<this._activeItems.length;r++){let a=this._activeItems[r];if(a!==t){let{x:p,y:f}=a.getRootElement().getBoundingClientRect(),S=Math.hypot(e-p,i-f);S<o&&(o=S,s=r)}}return s}},to=.05,ao=.05,J=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(J||{}),Z=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(Z||{}),Ri=class{constructor(t,e,i,o,s){this._dragDropRegistry=e,this._ngZone=o,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new M,this.entered=new M,this.exited=new M,this.dropped=new M,this.sorted=new M,this.receivingStarted=new M,this.receivingStopped=new M,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=xe.EMPTY,this._verticalScrollDirection=J.NONE,this._horizontalScrollDirection=Z.NONE,this._stopScrollTimers=new M,this._cachedShadowRoot=null,this._scrollableElements=[],this._direction="ltr",this._startScrollInterval=()=>{this._stopScrolling(),an(0,bi).pipe(Ce(this._stopScrollTimers)).subscribe(()=>{let a=this._scrollNode,p=this.autoScrollStep;this._verticalScrollDirection===J.UP?a.scrollBy(0,-p):this._verticalScrollDirection===J.DOWN&&a.scrollBy(0,p),this._horizontalScrollDirection===Z.LEFT?a.scrollBy(-p,0):this._horizontalScrollDirection===Z.RIGHT&&a.scrollBy(p,0)})};let r=this.element=ce(t);this._document=i,this.withOrientation("vertical").withElementContainer(r),e.registerDropContainer(this),this._parentPositions=new Ht(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,o){this._draggingStarted(),o==null&&this.sortingDisabled&&(o=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,i,o),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,o,s,r,a,p={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:o,isPointerOverContainer:s,distance:r,dropPoint:a,event:p})}withItems(t){let e=this._draggables;return this._draggables=t,t.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(o=>o.isDragging()).every(o=>t.indexOf(o)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof Ut&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new Fi(this._document,this._dragDropRegistry);else{let e=new Ut(this._dragDropRegistry);e.direction=this._direction,e.orientation=t,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,i)=>this.sortPredicate(e,i,this)),this}withScrollableParents(t){let e=this._container;return this._scrollableElements=t.indexOf(e)===-1?[e,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let e=ce(this.element),i=this._scrollableElements.indexOf(this._container),o=this._scrollableElements.indexOf(t);return i>-1&&this._scrollableElements.splice(i,1),o>-1&&this._scrollableElements.splice(o,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,o){if(this.sortingDisabled||!this._domRect||!Un(this._domRect,to,e,i))return;let s=this._sortStrategy.sort(t,e,i,o);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,o=J.NONE,s=Z.NONE;if(this._parentPositions.positions.forEach((r,a)=>{a===this._document||!r.clientRect||i||Un(r.clientRect,to,t,e)&&([o,s]=Gs(a,r.clientRect,this._direction,t,e),(o||s)&&(i=a))}),!o&&!s){let{width:r,height:a}=this._viewportRuler.getViewportSize(),p={width:r,height:a,top:0,right:r,bottom:a,left:0};o=co(p,e),s=lo(p,t),i=window}i&&(o!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=o,this._horizontalScrollDirection=s,this._scrollNode=i,(o||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(t,e){return this._domRect!=null&&Ti(this._domRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(o=>o._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._domRect||!Ti(this._domRect,e,i)||!this.enterPredicate(t,this))return!1;let o=this._getShadowRoot().elementFromPoint(e,i);return o?o===this._container||this._container.contains(o):!1}_startReceiving(t,e){let i=this._activeSiblings;!i.has(t)&&e.every(o=>this.enterPredicate(o,this)||this._draggables.indexOf(o)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=Nt(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}};function co(n,t){let{top:e,bottom:i,height:o}=n,s=o*ao;return t>=e-s&&t<=e+s?J.UP:t>=i-s&&t<=i+s?J.DOWN:J.NONE}function lo(n,t){let{left:e,right:i,width:o}=n,s=o*ao;return t>=e-s&&t<=e+s?Z.LEFT:t>=i-s&&t<=i+s?Z.RIGHT:Z.NONE}function Gs(n,t,e,i,o){let s=co(t,o),r=lo(t,i),a=J.NONE,p=Z.NONE;if(s){let f=n.scrollTop;s===J.UP?f>0&&(a=J.UP):n.scrollHeight-f>n.clientHeight&&(a=J.DOWN)}if(r){let f=n.scrollLeft;e==="rtl"?r===Z.RIGHT?f<0&&(p=Z.RIGHT):n.scrollWidth+f>n.clientWidth&&(p=Z.LEFT):r===Z.LEFT?f>0&&(p=Z.LEFT):n.scrollWidth-f>n.clientWidth&&(p=Z.RIGHT)}return[a,p]}var Lt=nt({passive:!1,capture:!0}),jt=new Set,Us=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=y({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[I],decls:0,vars:0,template:function(i,o){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}}return n})(),$s=(()=>{class n{constructor(e,i){this._ngZone=e,this._appRef=ue(vn),this._environmentInjector=ue(dn),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=pe([]),this._globalListeners=new Map,this._draggingPredicate=o=>o.isDragging(),this.pointerMove=new M,this.pointerUp=new M,this.scroll=new M,this._preventDefaultWhileDragging=o=>{this._activeDragInstances().length>0&&o.preventDefault()},this._persistentTouchmoveListener=o=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&o.preventDefault(),this.pointerMove.next(o))},this._document=i}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Lt)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Lt)}startDragging(e,i){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._loadResets(),this._activeDragInstances.update(o=>[...o,e]),this._activeDragInstances().length===1)){let o=i.type.startsWith("touch");this._globalListeners.set(o?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Lt}),o||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:Lt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,r)=>{this._document.addEventListener(r,s.handler,s.options)})})}}stopDragging(e){this._activeDragInstances.update(i=>{let o=i.indexOf(e);return o>-1?(i.splice(o,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let i=[this.scroll];return e&&e!==this._document&&i.push(new Xe(o=>this._ngZone.runOutsideAngular(()=>{let r=a=>{this._activeDragInstances().length&&o.next(a)};return e.addEventListener("scroll",r,!0),()=>{e.removeEventListener("scroll",r,!0)}}))),yt(...i)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,i)=>{this._document.removeEventListener(i,e.handler,e.options)}),this._globalListeners.clear()}_loadResets(){if(!jt.has(this._appRef)){jt.add(this._appRef);let e=bn(Us,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{jt.delete(this._appRef),jt.size===0&&e.destroy()})}}static{this.\u0275fac=function(i){return new(i||n)(B(Me),B(ge))}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ws={dragStartThreshold:5,pointerDirectionChangeThreshold:5},Li=(()=>{class n{constructor(e,i,o,s){this._document=e,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=s}createDrag(e,i=Ws){return new Vi(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new Ri(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static{this.\u0275fac=function(i){return new(i||n)(B(ge),B(Me),B(Nn),B($s))}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),io=new z("CDK_DRAG_PARENT");var Zs=new z("CdkDragHandle");var ho=new z("CDK_DRAG_CONFIG"),Ks="cdk-drag",uo=new z("CdkDropList"),po=(()=>{class n{static{this._dragInstances=[]}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}constructor(e,i,o,s,r,a,p,f,S,E,F){this.element=e,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=r,this._dir=p,this._changeDetectorRef=S,this._selfHandle=E,this._parentDrag=F,this._destroyed=new M,this._handles=new he([]),this.scale=1,this.started=new g,this.released=new g,this.ended=new g,this.entered=new g,this.exited=new g,this.dropped=new g,this.moved=new Xe(ee=>{let de=this._dragRef.moved.pipe(bt(De=>({source:this,pointerPosition:De.pointerPosition,event:De.event,delta:De.delta,distance:De.distance}))).subscribe(ee);return()=>{de.unsubscribe()}}),this._injector=ue(Ii),this._dragRef=f.createDrag(e,{dragStartThreshold:a&&a.dragStartThreshold!=null?a.dragStartThreshold:5,pointerDirectionChangeThreshold:a&&a.pointerDirectionChangeThreshold!=null?a.pointerDirectionChangeThreshold:5,zIndex:a?.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),a&&this._assignDefaults(a),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this),i._dropListRef.beforeStarted.pipe(Ce(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){mn(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let i=e.rootElementSelector,o=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,o&&!o.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let e=n._dragInstances.indexOf(this);e>-1&&n._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let i=this._handles.getValue();i.push(e),this._handles.next(i)}_removeHandle(e){let i=this._handles.getValue(),o=i.indexOf(e);o>-1&&(i.splice(o,1),this._handles.next(i))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,i=e;this.rootElementSelector&&(i=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):ce(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let i=this._dir,o=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,r=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof o=="object"&&o?o:Rt(o),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(r).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(ln(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains(Ks)){e.withParent(n._dragInstances.find(o=>o.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){let{lockAxis:i,dragStartDelay:o,constrainPosition:s,previewClass:r,boundaryElement:a,draggingDisabled:p,rootElementSelector:f,previewContainer:S}=e;this.disabled=p??!1,this.dragStartDelay=o||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),r&&(this.previewClass=r),a&&(this.boundaryElement=a),f&&(this.rootElementSelector=f),S&&(this.previewContainer=S)}_setupHandlesListener(){this._handles.pipe(Ve(e=>{let i=e.map(o=>o.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),wi(e=>yt(...e.map(i=>i._stateChanges.pipe(wt(i))))),Ce(this._destroyed)).subscribe(e=>{let i=this._dragRef,o=e.element.nativeElement;e.disabled?i.disableHandle(o):i.enableHandle(o)})}static{this.\u0275fac=function(i){return new(i||n)(v(G),v(uo,12),v(ge),v(Me),v(ki),v(ho,8),v(Pi,8),v(Li),v(Re),v(Zs,10),v(io,12))}}static{this.\u0275dir=A({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,o){i&2&&P("cdk-drag-disabled",o.disabled)("cdk-drag-dragging",o._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",we],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Cn]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[$([{provide:io,useExisting:n}]),kt,oe]})}}return n})(),no=new z("CdkDropListGroup");var qs=0,mo=(()=>{class n{static{this._dropLists=[]}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}constructor(e,i,o,s,r,a,p){this.element=e,this._changeDetectorRef=o,this._scrollDispatcher=s,this._dir=r,this._group=a,this._destroyed=new M,this.connectedTo=[],this.id=`cdk-drop-list-${qs++}`,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new g,this.entered=new g,this.exited=new g,this.sorted=new g,this._unsortedItems=new Set,this._dropListRef=i.createDropList(e),this._dropListRef.data=this,p&&this._assignDefaults(p),this._dropListRef.enterPredicate=(f,S)=>this.enterPredicate(f.data,S.data),this._dropListRef.sortPredicate=(f,S,E)=>this.sortPredicate(f,S.data,E.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),a&&a._items.add(this)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=n._dropLists.indexOf(this);e>-1&&n._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(wt(this._dir.value),Ce(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{let i=Fn(this.connectedTo).map(o=>{if(typeof o=="string"){let s=n._dropLists.find(r=>r.id===o);return s}return o});if(this._group&&this._group._items.forEach(o=>{i.indexOf(o)===-1&&i.push(o)}),!this._scrollableParentsResolved){let o=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(s=>s.getElementRef().nativeElement);this._dropListRef.withScrollableParents(o),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let o=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(o)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=Rt(this.autoScrollStep,2),e.connectedTo(i.filter(o=>o&&o!==this).map(o=>o._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),yt(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:i,draggingDisabled:o,sortingDisabled:s,listAutoScrollDisabled:r,listOrientation:a}=e;this.disabled=o??!1,this.sortingDisabled=s??!1,this.autoScrollDisabled=r??!1,this.orientation=a||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}static{this.\u0275fac=function(i){return new(i||n)(v(G),v(Li),v(Re),v(Rn),v(Pi,8),v(no,12),v(ho,8))}}static{this.\u0275dir=A({type:n,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,o){i&2&&(se("id",o.id),P("cdk-drop-list-disabled",o.disabled)("cdk-drop-list-dragging",o._dropListRef.isDragging())("cdk-drop-list-receiving",o._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",we],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",we],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",we],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[$([{provide:no,useValue:void 0},{provide:uo,useExisting:n}]),kt]})}}return n})();var fo=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ne({type:n})}static{this.\u0275inj=ie({providers:[Li],imports:[Bn]})}}return n})();function Qs(n,t){if(n&1){let e=D();l(0,"app-tree-view",9),_("dragIdChange",function(o){C(e);let s=h(2);return b(s.onDragIdChange(o))})("itemSelected",function(o){C(e);let s=h(2);return b(s.itemSelected.emit(o))})("itemDropped",function(o){C(e);let s=h(2);return b(s.itemDropped.emit(o))}),c()}if(n&2){let e=h().$implicit,i=h();u("disabled",i.disabled)("items",i.getChildren(e))("selectedId",i.selectedId)("idField",i.idField)("labelField",i.labelField)("childrenField",i.childrenField)("typeField",i.typeField)("typeToIcon",i.typeToIcon)("allowMultipleItems",!0)("activeDragId",i.activeDragId)}}function Xs(n,t){if(n&1){let e=D();l(0,"li",4)(1,"div",5)(2,"span",6),_("click",function(o){let s=C(e).$implicit;return s.expanded=!s.expanded,b(o.stopPropagation())}),m(3),c(),l(4,"span",7,0),_("cdkDragStarted",function(o){C(e);let s=h();return b(s.onDragStarted(o))})("cdkDragEnded",function(){C(e);let o=h();return b(o.onDragEnded())})("mouseenter",function(){C(e);let o=U(5),s=h();return b(s.onMouseEnter(o))})("mouseleave",function(){C(e);let o=U(5),s=h();return b(s.onMouseLeave(o))})("click",function(){let o=C(e).$implicit,s=h();return b(s.clicked(o))}),m(6),c()(),w(7,Qs,1,10,"app-tree-view",8),c()}if(n&2){let e=t.$implicit,i=h();d(),P("disabled",i.disabled),d(),P("expanded",e.expanded),d(),j(" ",i.getChildren(e).length?"\u25B6":""," "),d(),P("drop-before",i.onHover(e,"before"))("drop-after",i.onHover(e,"after"))("drop-inside",i.onHover(e,"inside"))("drop-forbidden",i.onHover(e,null))("selected",i.getId(e)==i.selectedId),u("cdkDragDisabled",i.disabled||!i.allowMultipleItems)("cdkDragData",e),se("data-id",i.getId(e))("data-droppable",i.allowMultipleItems),d(2),Ee(" ",i.getIcon(e)," ",i.getLabel(e)," "),d(),u("ngIf",i.getChildren(e).length&&e.expanded)}}var $t=class n{constructor(t){this.elementRef=t}items=[];selectedId;idField="id";labelField="label";childrenField="children";disabled=!1;allowMultipleItems=!1;itemSelected=new g;itemDropped=new g;activeDragId=null;dragIdChange=new g;typeField="type";typeToIcon={};getType(t){return t[this.typeField]}getIcon(t){return this.typeToIcon[this.getType(t)]||""}hoveredItemId=null;dragPosition=null;validateDropPosition(t){if(!this.activeDragId)return null;let e=this.activeDragId,i=this.findDropElement(t.event.target);if(!i)return null;let o=i.getBoundingClientRect(),a=(t.event.clientY-o.top)/o.height,p;a<.3?p="before":a>.7?p="after":p="inside";let f=i.getAttribute("data-id");if(!f||f==this.activeDragId)return null;let S=this.getTreeViewItems(this.findTreeViewAncestors(i)[0]),E=this.findItemById(S,this.activeDragId),F=this.findItemById(S,f),ee=this.findParentCollection(S,this.activeDragId),de=ee===this.findParentCollection(S,f);if(this.isInSubtree(E,F))return null;switch(p){case"inside":if(!this.hasChildren(F))return null;break;case"before":case"after":if(!(i.getAttribute("data-droppable")==="true"))return null;if(de){let H=ee.indexOf(E),Ct=ee.indexOf(F);if(p==="before"&&H===Ct-1||p==="after"&&H===Ct+1)return null}break}return{sourceId:e,targetId:f,position:p}}findParentCollection(t,e){for(let i of t){let o=this.getChildren(i);if(o.some(s=>this.getId(s)==e))return o;if(o.length){let s=this.findParentCollection(o,e);if(s)return s}}return null}onHover(t,e){if(this.disabled)return!1;let i=this.getId(t);return this.hoveredItemId!=i?!1:e==this.dragPosition}get isRootComponent(){return this.findTreeViewAncestors(this.elementRef.nativeElement).length<=1}onDragStarted(t){let i=t.source.element.nativeElement.getAttribute("data-id");this.dragIdChange.emit(i)}onDragEnded(){this.dragIdChange.emit(null)}onDragIdChange(t){this.isRootComponent?this.activeDragId=t:this.dragIdChange.emit(t)}onMouseEnter(t){if(this.activeDragId){t.addEventListener("mousemove",i=>this.onMouseMove(i,t));let e=this.findDropElement(t);this.hoveredItemId=e.getAttribute("data-id")}}onMouseLeave(t){this.dragPosition=null,t.removeEventListener("mousemove",e=>this.onMouseMove(e,t)),this.hoveredItemId=null}onMouseMove(t,e){if(this.activeDragId){let i=this.validateDropPosition({event:t});this.dragPosition=i?i.position:null}}getId(t){return t[this.idField]}getLabel(t){return t[this.labelField]}getChildren(t){return t[this.childrenField]||[]}hasChildren(t){return!!t[this.childrenField]}clicked(t){this.disabled||this.itemSelected.emit(t)}get allowedItems(){return this.allowMultipleItems?this.items:this.items.length?[this.items[0]]:[]}onDrop(t){let e=this.validateDropPosition(t);e&&this.itemDropped.emit(e)}findTreeViewAncestors(t){let e=[],i=t;for(;i.parentElement;)i.tagName.toLowerCase()==="app-tree-view"&&e.unshift(i),i=i.parentElement;return e}findDropElement(t){let e=t;for(;e;){if(e.hasAttribute("cdkDrag"))return e;if(!e.parentElement)break;e=e.parentElement}return null}stringify(t){return JSON.stringify(t)}getTreeViewItems(t){let i=t.querySelector("ul[cdkDropList]")?.getAttribute("data-items");return i?JSON.parse(i):[]}findItemById(t,e){for(let i of t){if(this.getId(i)==e)return i;if(this.getChildren(i).length){let o=this.findItemById(this.getChildren(i),e);if(o)return o}}return null}isInSubtree(t,e){return this.getChildren(t).some(o=>this.getId(o)==this.getId(e)||this.isInSubtree(o,e))}static \u0275fac=function(e){return new(e||n)(v(G))};static \u0275cmp=y({type:n,selectors:[["app-tree-view"]],inputs:{items:"items",selectedId:"selectedId",idField:"idField",labelField:"labelField",childrenField:"childrenField",disabled:"disabled",allowMultipleItems:"allowMultipleItems",activeDragId:"activeDragId",typeField:"typeField",typeToIcon:"typeToIcon"},outputs:{itemSelected:"itemSelected",itemDropped:"itemDropped",dragIdChange:"dragIdChange"},standalone:!0,features:[I],decls:3,vars:4,consts:[["dragOver",""],[1,"tree-view"],["cdkDropList","",1,"tree-list",3,"cdkDropListDropped","cdkDropListData","cdkDropListSortingDisabled"],["class","tree-item",4,"ngFor","ngForOf"],[1,"tree-item"],[1,"item-content"],[1,"expand-icon",3,"click"],["cdkDrag","",1,"item-label",3,"cdkDragStarted","cdkDragEnded","mouseenter","mouseleave","click","cdkDragDisabled","cdkDragData"],[3,"disabled","items","selectedId","idField","labelField","childrenField","typeField","typeToIcon","allowMultipleItems","activeDragId","dragIdChange","itemSelected","itemDropped",4,"ngIf"],[3,"dragIdChange","itemSelected","itemDropped","disabled","items","selectedId","idField","labelField","childrenField","typeField","typeToIcon","allowMultipleItems","activeDragId"]],template:function(e,i){e&1&&(l(0,"div",1)(1,"ul",2),_("cdkDropListDropped",function(s){return i.onDrop(s)}),w(2,Xs,8,22,"li",3),c()()),e&2&&(d(),u("cdkDropListData",i.allowedItems)("cdkDropListSortingDisabled",!0),se("data-items",i.stringify(i.allowedItems)),d(),u("ngForOf",i.allowedItems))},dependencies:[n,k,q,O,fo,mo,po],styles:[".tree-view[_ngcontent-%COMP%]   .tree-list[_ngcontent-%COMP%]{list-style:none;padding-left:1rem;margin:0}.tree-view[_ngcontent-%COMP%]   .tree-item[_ngcontent-%COMP%]{padding:.25rem 0}.tree-view[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.tree-view[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]:hover:not(.disabled){background-color:#0000000d}.tree-view[_ngcontent-%COMP%]   .item-content.disabled[_ngcontent-%COMP%]{color:#666;cursor:default}.tree-view[_ngcontent-%COMP%]   .expand-icon[_ngcontent-%COMP%]{width:1rem;display:inline-block;margin-right:.5rem;transition:transform .2s;cursor:pointer}.tree-view[_ngcontent-%COMP%]   .expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.tree-view[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{flex:1;border-top:2px solid transparent;border-bottom:2px solid transparent}.tree-view[_ngcontent-%COMP%]   .item-label.selected[_ngcontent-%COMP%]{background-color:#e3f2fd}.tree-view[_ngcontent-%COMP%]   .item-label.drop-before[_ngcontent-%COMP%]{border-top-color:#2196f3;cursor:row-resize}.tree-view[_ngcontent-%COMP%]   .item-label.drop-after[_ngcontent-%COMP%]{border-bottom:2px solid #2196F3;cursor:row-resize}.tree-view[_ngcontent-%COMP%]   .item-label.drop-inside[_ngcontent-%COMP%]{background-color:#2196f31a;cursor:move}.tree-view[_ngcontent-%COMP%]   .item-label.drop-forbidden[_ngcontent-%COMP%]{cursor:not-allowed}"]})};var Js=["itemTemplate"],er=n=>({$implicit:n});function tr(n,t){n&1&&(l(0,"div",4),V(1,"input",5),c())}function ir(n,t){n&1&&et(0)}function nr(n,t){if(n&1&&(l(0,"div",6),w(1,ir,1,0,"ng-container",7),c()),n&2){let e=t.$implicit,i=h();d(),u("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",tt(2,er,e))}}var Wt=class n{config;items;select=new g;itemTemplate;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-list"]],contentQueries:function(e,i,o){if(e&1&&St(o,Js,5),e&2){let s;be(s=ye())&&(i.itemTemplate=s.first)}},inputs:{config:"config",items:"items"},outputs:{select:"select"},standalone:!0,features:[I],decls:4,vars:2,consts:[[1,"list-container"],["class","list-search",4,"ngIf"],[1,"list-content"],["class","list-item",4,"ngFor","ngForOf"],[1,"list-search"],["type","text","placeholder","Search..."],[1,"list-item"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){e&1&&(l(0,"div",0),w(1,tr,2,0,"div",1),l(2,"div",2),w(3,nr,2,4,"div",3),c()()),e&2&&(d(),u("ngIf",i.config==null?null:i.config.showSearch),d(2),u("ngForOf",i.items))},dependencies:[k,q,O,Mt],styles:[".list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff}.list-container[_ngcontent-%COMP%]   .list-search[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #eee}.list-container[_ngcontent-%COMP%]   .list-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px}.list-container[_ngcontent-%COMP%]   .list-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#0366d6}.list-container[_ngcontent-%COMP%]   .list-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.list-container[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]{cursor:pointer}"]})};var or=()=>({selectable:!0});function sr(n,t){if(n&1){let e=D();l(0,"div",2),_("click",function(){let o=C(e).$implicit,s=h();return b(s.onSelect(o))}),l(1,"div",3),m(2),c(),l(3,"div",4)(4,"span"),m(5),fn(6,"date"),c(),l(7,"span"),m(8),c()()()}if(n&2){let e=t.$implicit,i=h();P("selected",e.id==i.selectedId)("disabled",!i.canSelect&&e.id!=i.selectedId),d(2),L(e.title),d(3),L(_n(6,7,e.createdAt)),d(3),L(e.status)}}var Zt=class n{constructor(t){this.chatSessionService=t}selectedId;filter={status:["approved"]};canSelect=!0;sessionSelect=new g;sessions=[];loading=!1;error=null;ngOnInit(){this.loadSessions()}loadSessions(){this.loading=!0,this.error=null,this.chatSessionService.getSessions(this.filter).subscribe({next:t=>{this.sessions=t,this.loading=!1},error:t=>{this.error="Failed to load sessions",this.loading=!1}})}onSelect(t){this.canSelect&&this.sessionSelect.emit(t)}static \u0275fac=function(e){return new(e||n)(v(Et))};static \u0275cmp=y({type:n,selectors:[["app-chat-session-list"]],inputs:{selectedId:"selectedId",filter:"filter",canSelect:"canSelect"},outputs:{sessionSelect:"sessionSelect"},standalone:!0,features:[I],decls:3,vars:3,consts:[["itemTemplate",""],[3,"config","items"],[1,"session-item",3,"click"],[1,"session-title"],[1,"session-meta"]],template:function(e,i){e&1&&(l(0,"app-list",1),w(1,sr,9,9,"ng-template",null,0,re),c()),e&2&&u("config",xt(2,or))("items",i.sessions)},dependencies:[k,In,Wt],styles:[".session-item[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #eee;transition:background-color .2s}.session-item[_ngcontent-%COMP%]:hover:not(.disabled){background:#f6f8fa}.session-item.selected[_ngcontent-%COMP%]{background:#f1f8ff;border-left:3px solid #0366d6;cursor:default}.session-item.disabled[_ngcontent-%COMP%]{cursor:not-allowed}.session-item[_ngcontent-%COMP%]   .session-title[_ngcontent-%COMP%]{font-size:14px;font-weight:500;margin-bottom:4px;color:#24292e}.session-item[_ngcontent-%COMP%]   .session-meta[_ngcontent-%COMP%]{font-size:12px;color:#586069;display:flex;gap:16px}.session-item[_ngcontent-%COMP%]   .session-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center}"]})};var So=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static{this.\u0275fac=function(i){return new(i||n)(v(Je),v(G))}}static{this.\u0275dir=A({type:n})}}return n})(),ni=(()=>{class n extends So{static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Fe(n)))(o||n)}})()}static{this.\u0275dir=A({type:n,features:[K]})}}return n})(),Ze=new z(""),rr={provide:Ze,useExisting:te(()=>$i),multi:!0},$i=(()=>{class n extends ni{writeValue(e){this.setProperty("checked",e)}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Fe(n)))(o||n)}})()}static{this.\u0275dir=A({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,o){i&1&&_("change",function(r){return o.onChange(r.target.checked)})("blur",function(){return o.onTouched()})},features:[$([rr]),K]})}}return n})(),ar={provide:Ze,useExisting:te(()=>le),multi:!0};function cr(){let n=Di()?Di().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var lr=new z(""),le=(()=>{class n extends So{constructor(e,i,o){super(e,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!cr())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static{this.\u0275fac=function(i){return new(i||n)(v(Je),v(G),v(lr,8))}}static{this.\u0275dir=A({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&_("input",function(r){return o._handleInput(r.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(r){return o._compositionEnd(r.target.value)})},features:[$([ar]),K]})}}return n})();function Ie(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function Do(n){return n!=null&&typeof n.length=="number"}var pt=new z(""),oi=new z(""),dr=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ue=class{static min(t){return hr(t)}static max(t){return ur(t)}static required(t){return xo(t)}static requiredTrue(t){return pr(t)}static email(t){return mr(t)}static minLength(t){return fr(t)}static maxLength(t){return _r(t)}static pattern(t){return gr(t)}static nullValidator(t){return qt(t)}static compose(t){return Ao(t)}static composeAsync(t){return Vo(t)}};function hr(n){return t=>{if(Ie(t.value)||Ie(n))return null;let e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}function ur(n){return t=>{if(Ie(t.value)||Ie(n))return null;let e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}function xo(n){return Ie(n.value)?{required:!0}:null}function pr(n){return n.value===!0?null:{required:!0}}function mr(n){return Ie(n.value)||dr.test(n.value)?null:{email:!0}}function fr(n){return t=>Ie(t.value)||!Do(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}function _r(n){return t=>Do(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function gr(n){if(!n)return qt;let t,e;return typeof n=="string"?(e="",n.charAt(0)!=="^"&&(e+="^"),e+=n,n.charAt(n.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),i=>{if(Ie(i.value))return null;let o=i.value;return t.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}function qt(n){return null}function Mo(n){return n!=null}function Eo(n){return gn(n)?nn(n):n}function Po(n){let t={};return n.forEach(e=>{t=e!=null?R(R({},t),e):t}),Object.keys(t).length===0?null:t}function Oo(n,t){return t.map(e=>e(n))}function vr(n){return!n.validate}function To(n){return n.map(t=>vr(t)?t:e=>t.validate(e))}function Ao(n){if(!n)return null;let t=n.filter(Mo);return t.length==0?null:function(e){return Po(Oo(e,t))}}function Wi(n){return n!=null?Ao(To(n)):null}function Vo(n){if(!n)return null;let t=n.filter(Mo);return t.length==0?null:function(e){let i=Oo(e,t).map(Eo);return sn(i).pipe(bt(Po))}}function Zi(n){return n!=null?Vo(To(n)):null}function _o(n,t){return n===null?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Fo(n){return n._rawValidators}function Ro(n){return n._rawAsyncValidators}function ji(n){return n?Array.isArray(n)?n:[n]:[]}function Yt(n,t){return Array.isArray(n)?n.includes(t):n===t}function go(n,t){let e=ji(t);return ji(n).forEach(o=>{Yt(e,o)||e.push(o)}),e}function vo(n,t){return ji(t).filter(e=>!Yt(n,e))}var Qt=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Wi(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Zi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},ve=class extends Qt{get formDirective(){return null}get path(){return null}},Ae=class extends Qt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Xt=class{constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Cr={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},$d=Y(R({},Cr),{"[class.ng-submitted]":"isSubmitted"}),Se=(()=>{class n extends Xt{constructor(e){super(e)}static{this.\u0275fac=function(i){return new(i||n)(v(Ae,2))}}static{this.\u0275dir=A({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&P("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[K]})}}return n})(),Ke=(()=>{class n extends Xt{constructor(e){super(e)}static{this.\u0275fac=function(i){return new(i||n)(v(ve,10))}}static{this.\u0275dir=A({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,o){i&2&&P("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[K]})}}return n})();var at="VALID",Kt="INVALID",ze="PENDING",ct="DISABLED",ke=class{},Jt=class extends ke{constructor(t,e){super(),this.value=t,this.source=e}},dt=class extends ke{constructor(t,e){super(),this.pristine=t,this.source=e}},ht=class extends ke{constructor(t,e){super(),this.touched=t,this.source=e}},Ge=class extends ke{constructor(t,e){super(),this.status=t,this.source=e}},Hi=class extends ke{constructor(t){super(),this.source=t}},zi=class extends ke{constructor(t){super(),this.source=t}};function Ki(n){return(si(n)?n.validators:n)||null}function br(n){return Array.isArray(n)?Wi(n):n||null}function qi(n,t){return(si(t)?t.asyncValidators:n)||null}function yr(n){return Array.isArray(n)?Zi(n):n||null}function si(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function No(n,t,e){let i=n.controls;if(!(t?Object.keys(i):i).length)throw new It(1e3,"");if(!i[e])throw new It(1001,"")}function Bo(n,t,e){n._forEachChild((i,o)=>{if(e[o]===void 0)throw new It(1002,"")})}var $e=class{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Ne(()=>this.statusReactive()),this.statusReactive=pe(void 0),this._pristine=Ne(()=>this.pristineReactive()),this.pristineReactive=pe(!0),this._touched=Ne(()=>this.touchedReactive()),this.touchedReactive=pe(!1),this._events=new M,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return _e(this.statusReactive)}set status(t){_e(()=>this.statusReactive.set(t))}get valid(){return this.status===at}get invalid(){return this.status===Kt}get pending(){return this.status==ze}get disabled(){return this.status===ct}get enabled(){return this.status!==ct}get pristine(){return _e(this.pristineReactive)}set pristine(t){_e(()=>this.pristineReactive.set(t))}get dirty(){return!this.pristine}get touched(){return _e(this.touchedReactive)}set touched(t){_e(()=>this.touchedReactive.set(t))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(go(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(go(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(vo(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(vo(t,this._rawAsyncValidators))}hasValidator(t){return Yt(this._rawValidators,t)}hasAsyncValidator(t){return Yt(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(Y(R({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new ht(!0,i))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=t.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&t.emitEvent!==!1&&this._events.next(new ht(!1,i))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(Y(R({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new dt(!1,i))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=t.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&t.emitEvent!==!1&&this._events.next(new dt(!0,i))}markAsPending(t={}){this.status=ze;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Ge(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(Y(R({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=ct,this.errors=null,this._forEachChild(o=>{o.disable(Y(R({},t),{onlySelf:!0}))}),this._updateValue();let i=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Jt(this.value,i)),this._events.next(new Ge(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Y(R({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=at,this._forEachChild(i=>{i.enable(Y(R({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Y(R({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===at||this.status===ze)&&this._runAsyncValidator(i,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Jt(this.value,e)),this._events.next(new Ge(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(Y(R({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ct:at}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=ze,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let i=Eo(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,o)=>i&&i._find(o),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new Ge(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new g,this.statusChanges=new g}_calculateStatus(){return this._allControlsDisabled()?ct:this.errors?Kt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ze)?ze:this._anyControlsHaveStatus(Kt)?Kt:at}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let i=!this._anyControlsDirty(),o=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),o&&this._events.next(new dt(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new ht(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){si(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=br(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=yr(this._rawAsyncValidators)}},We=class extends $e{constructor(t,e,i){super(Ki(e),qi(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Bo(this,!0,t),Object.keys(t).forEach(i=>{No(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(i=>{let o=this.controls[i];o&&o.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,o)=>{i.reset(t?t[o]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>i._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,i,o)=>((i.enabled||this.disabled)&&(e[o]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((o,s)=>{i=e(i,o,s)}),i}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var Gi=class extends We{};var mt=new z("CallSetDisabledState",{providedIn:"root",factory:()=>ri}),ri="always";function Lo(n,t){return[...t.path,n]}function ei(n,t,e=ri){Yi(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(n.disabled),Ir(n,t),Sr(n,t),kr(n,t),wr(n,t)}function Co(n,t,e=!0){let i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),ii(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function ti(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function wr(n,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}function Yi(n,t){let e=Fo(n);t.validator!==null?n.setValidators(_o(e,t.validator)):typeof e=="function"&&n.setValidators([e]);let i=Ro(n);t.asyncValidator!==null?n.setAsyncValidators(_o(i,t.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let o=()=>n.updateValueAndValidity();ti(t._rawValidators,o),ti(t._rawAsyncValidators,o)}function ii(n,t){let e=!1;if(n!==null){if(t.validator!==null){let o=Fo(n);if(Array.isArray(o)&&o.length>0){let s=o.filter(r=>r!==t.validator);s.length!==o.length&&(e=!0,n.setValidators(s))}}if(t.asyncValidator!==null){let o=Ro(n);if(Array.isArray(o)&&o.length>0){let s=o.filter(r=>r!==t.asyncValidator);s.length!==o.length&&(e=!0,n.setAsyncValidators(s))}}}let i=()=>{};return ti(t._rawValidators,i),ti(t._rawAsyncValidators,i),e}function Ir(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&jo(n,t)})}function kr(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&jo(n,t),n.updateOn!=="submit"&&n.markAsTouched()})}function jo(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Sr(n,t){let e=(i,o)=>{t.valueAccessor.writeValue(i),o&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}function Ho(n,t){n==null,Yi(n,t)}function Dr(n,t){return ii(n,t)}function zo(n,t){if(!n.hasOwnProperty("model"))return!1;let e=n.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function xr(n){return Object.getPrototypeOf(n.constructor)===ni}function Go(n,t){n._syncPendingControls(),t.forEach(e=>{let i=e.control;i.updateOn==="submit"&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Uo(n,t){if(!t)return null;Array.isArray(t);let e,i,o;return t.forEach(s=>{s.constructor===le?e=s:xr(s)?i=s:o=s}),o||i||e||null}function Mr(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}var Er={provide:ve,useExisting:te(()=>Qi)},lt=Promise.resolve(),Qi=(()=>{class n extends ve{get submitted(){return _e(this.submittedReactive)}constructor(e,i,o){super(),this.callSetDisabledState=o,this._submitted=Ne(()=>this.submittedReactive()),this.submittedReactive=pe(!1),this._directives=new Set,this.ngSubmit=new g,this.form=new We({},Wi(e),Zi(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){lt.then(()=>{let i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),ei(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){lt.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){lt.then(()=>{let i=this._findContainer(e.path),o=new We({});Ho(o,e),i.registerControl(e.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){lt.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){lt.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),Go(this.form,this._directives),this.ngSubmit.emit(e),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static{this.\u0275fac=function(i){return new(i||n)(v(pt,10),v(oi,10),v(mt,8))}}static{this.\u0275dir=A({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,o){i&1&&_("submit",function(r){return o.onSubmit(r)})("reset",function(){return o.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[$([Er]),K]})}}return n})();function bo(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function yo(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var ut=class extends $e{constructor(t=null,e,i){super(Ki(e),qi(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),si(e)&&(e.nonNullable||e.initialValueIsDefault)&&(yo(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){bo(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){bo(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){yo(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var Pr=n=>n instanceof ut;var Or={provide:Ae,useExisting:te(()=>ft)},wo=Promise.resolve(),ft=(()=>{class n extends Ae{constructor(e,i,o,s,r,a){super(),this._changeDetectorRef=r,this.callSetDisabledState=a,this.control=new ut,this._registered=!1,this.name="",this.update=new g,this._parent=e,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=Uo(this,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),zo(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){ei(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){wo.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,o=i!==0&&we(i);wo.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Lo(e,this._parent):[e]}static{this.\u0275fac=function(i){return new(i||n)(v(ve,9),v(pt,10),v(oi,10),v(Ze,10),v(Re,8),v(mt,8))}}static{this.\u0275dir=A({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[$([Or]),K,oe]})}}return n})(),qe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=A({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var $o=new z("");var Tr={provide:ve,useExisting:te(()=>_t)},_t=(()=>{class n extends ve{get submitted(){return _e(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}constructor(e,i,o){super(),this.callSetDisabledState=o,this._submitted=Ne(()=>this._submittedReactive()),this._submittedReactive=pe(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new g,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ii(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let i=this.form.get(e.path);return ei(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){Co(e.control||null,e,!1),Mr(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this._submittedReactive.set(!0),Go(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new Hi(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new zi(this.form))}_updateDomValue(){this.directives.forEach(e=>{let i=e.control,o=this.form.get(e.path);i!==o&&(Co(i||null,e),Pr(o)&&(ei(o,e,this.callSetDisabledState),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let i=this.form.get(e.path);Ho(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let i=this.form.get(e.path);i&&Dr(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Yi(this.form,this),this._oldForm&&ii(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(i){return new(i||n)(v(pt,10),v(oi,10),v(mt,8))}}static{this.\u0275dir=A({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,o){i&1&&_("submit",function(r){return o.onSubmit(r)})("reset",function(){return o.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[$([Tr]),K,oe]})}}return n})();var Ar={provide:Ae,useExisting:te(()=>gt)},gt=(()=>{class n extends Ae{set isDisabled(e){}static{this._ngModelWarningSentOnce=!1}constructor(e,i,o,s,r){super(),this._ngModelWarningConfig=r,this._added=!1,this.name=null,this.update=new g,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=Uo(this,s)}ngOnChanges(e){this._added||this._setUpControl(),zo(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Lo(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(i){return new(i||n)(v(ve,13),v(pt,10),v(oi,10),v(Ze,10),v($o,8))}}static{this.\u0275dir=A({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[$([Ar]),K,oe]})}}return n})(),Vr={provide:Ze,useExisting:te(()=>Zo),multi:!0};function Wo(n,t){return n==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function Fr(n){return n.split(":")[0]}var Zo=(()=>{class n extends ni{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;let i=this._getOptionId(e),o=Wo(i,e);this.setProperty("value",o)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){let i=Fr(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Fe(n)))(o||n)}})()}static{this.\u0275dir=A({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,o){i&1&&_("change",function(r){return o.onChange(r.target.value)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},features:[$([Vr]),K]})}}return n})(),Ko=(()=>{class n{constructor(e,i,o){this._element=e,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(Wo(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||n)(v(G),v(Je),v(Zo,9))}}static{this.\u0275dir=A({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})(),Rr={provide:Ze,useExisting:te(()=>qo),multi:!0};function Io(n,t){return n==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function Nr(n){return n.split(":")[0]}var qo=(()=>{class n extends ni{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;let i;if(Array.isArray(e)){let o=e.map(s=>this._getOptionId(s));i=(s,r)=>{s._setSelected(o.indexOf(r.toString())>-1)}}else i=(o,s)=>{o._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{let o=[],s=i.selectedOptions;if(s!==void 0){let r=s;for(let a=0;a<r.length;a++){let p=r[a],f=this._getOptionValue(p.value);o.push(f)}}else{let r=i.options;for(let a=0;a<r.length;a++){let p=r[a];if(p.selected){let f=this._getOptionValue(p.value);o.push(f)}}}this.value=o,e(o)}}_registerOption(e){let i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){let i=Nr(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Fe(n)))(o||n)}})()}static{this.\u0275dir=A({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,o){i&1&&_("change",function(r){return o.onChange(r.target)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},features:[$([Rr]),K]})}}return n})(),Yo=(()=>{class n{constructor(e,i,o){this._element=e,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(Io(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Io(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||n)(v(G),v(Je),v(qo,9))}}static{this.\u0275dir=A({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();var Br=(()=>{class n{constructor(){this._validator=qt}ngOnChanges(e){if(this.inputName in e){let i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):qt,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=A({type:n,features:[oe]})}}return n})();var Lr={provide:pt,useExisting:te(()=>Xi),multi:!0};var Xi=(()=>{class n extends Br{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=we,this.createValidator=e=>xo}enabled(e){return e}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Fe(n)))(o||n)}})()}static{this.\u0275dir=A({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,o){i&2&&se("required",o._enabled?"":null)},inputs:{required:"required"},features:[$([Lr]),K]})}}return n})();var Qo=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ne({type:n})}static{this.\u0275inj=ie({})}}return n})(),Ui=class extends $e{constructor(t,e,i){super(Ki(e),qi(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){let o=this._adjustIndex(t);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),e&&(this.controls.splice(o,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Bo(this,!1,t),t.forEach((i,o)=>{No(this,!1,o),this.at(o).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((i,o)=>{this.at(o)&&this.at(o).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,o)=>{i.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,i)=>i._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function ko(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var ai=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){let e=new n;return e.useNonNullable=!0,e}group(e,i=null){let o=this._reduceControls(e),s={};return ko(i)?s=i:i!==null&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new We(o,s)}record(e,i=null){let o=this._reduceControls(e);return new Gi(o,i)}control(e,i,o){let s={};return this.useNonNullable?(ko(i)?s=i:(s.validators=i,s.asyncValidators=o),new ut(e,Y(R({},s),{nonNullable:!0}))):new ut(e,i,o)}array(e,i,o){let s=e.map(r=>this._createControl(r));return new Ui(s,i,o)}_reduceControls(e){let i={};return Object.keys(e).forEach(o=>{i[o]=this._createControl(e[o])}),i}_createControl(e){if(e instanceof ut)return e;if(e instanceof $e)return e;if(Array.isArray(e)){let i=e[0],o=e.length>1?e[1]:null,s=e.length>2?e[2]:null;return this.control(i,o,s)}else return this.control(e)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ye=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:mt,useValue:e.callSetDisabledState??ri}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ne({type:n})}static{this.\u0275inj=ie({imports:[Qo]})}}return n})(),ci=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:$o,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:mt,useValue:e.callSetDisabledState??ri}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ne({type:n})}static{this.\u0275inj=ie({imports:[Qo]})}}return n})();function jr(n,t){if(n&1){let e=D();l(0,"div",14)(1,"input",15),Te("ngModelChange",function(o){C(e);let s=h();return Oe(s.useLastMessageAsTitle,o)||(s.useLastMessageAsTitle=o),b(o)}),_("change",function(){C(e);let o=h();return b(o.setLastMessageAsTitle())}),c(),l(2,"label",16),m(3,"Use last message"),c()()}if(n&2){let e=h();d(),Pe("ngModel",e.useLastMessageAsTitle)}}var Xo=class n{constructor(t){this.chatSessionService=t}session;sessionId;sessionUpdated=new g;saved=new g;saving=!1;loading=!1;error=null;editData={title:"",description:""};useLastMessageAsTitle=!1;ngOnInit(){this.session?this.initializeFromSession(this.session):this.sessionId&&this.loadSession()}initializeFromSession(t){this.editData={title:t.title||"",description:t.description||""}}loadSession(){this.sessionId&&(this.loading=!0,this.error=null,this.chatSessionService.getSession(this.sessionId).subscribe({next:t=>{this.initializeFromSession(t),this.loading=!1},error:t=>{this.error="Failed to load session data",this.loading=!1}}))}get showUseLastMessage(){return!this.editData.title&&!!this.session?.lastHumanMessage}setLastMessageAsTitle(){this.useLastMessageAsTitle&&this.session?.lastHumanMessage&&(this.editData.title=this.session.lastHumanMessage)}saveChanges(){if(console.log("save changes triggered"),!this.session||!this.editData.title)return;let t={title:this.editData.title,description:this.editData.description,status:"approved",interactionsCount:this.session.interactionsCount};this.saving=!0,this.chatSessionService.updateSession(this.session.id,t).subscribe({next:e=>{this.saving=!1,this.saved.emit(e)},error:()=>{this.saving=!1}})}resetChanges(){this.session&&(this.initializeFromSession(this.session),this.useLastMessageAsTitle=!1)}static \u0275fac=function(e){return new(e||n)(v(Et))};static \u0275cmp=y({type:n,selectors:[["app-session-editor"]],inputs:{session:"session",sessionId:"sessionId"},outputs:{sessionUpdated:"sessionUpdated",saved:"saved"},standalone:!0,features:[I],decls:21,vars:7,consts:[[1,"session-editor"],[1,"session-info"],[1,"interactions-count"],[1,"editor-form",3,"ngSubmit"],[1,"form-group"],["for","sessionTitle"],[1,"title-input-group"],["type","text","id","sessionTitle","name","title","required","",3,"ngModelChange","ngModel","placeholder"],["class","use-message-option",4,"ngIf"],["for","sessionDescription"],["id","sessionDescription","name","description","rows","4",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","submit",3,"disabled"],["type","button",3,"click"],[1,"use-message-option"],["type","checkbox","id","useLastMessage","name","useLastMessage",3,"ngModelChange","change","ngModel"],["for","useLastMessage"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"span",2),m(3),c()(),l(4,"form",3),_("ngSubmit",function(){return i.saveChanges()}),l(5,"div",4)(6,"label",5),m(7,"Session Title"),c(),l(8,"div",6)(9,"input",7),Te("ngModelChange",function(s){return Oe(i.editData.title,s)||(i.editData.title=s),s}),c(),w(10,jr,4,1,"div",8),c()(),l(11,"div",4)(12,"label",9),m(13,"Description"),c(),l(14,"textarea",10),Te("ngModelChange",function(s){return Oe(i.editData.description,s)||(i.editData.description=s),s}),m(15,"      "),c()(),l(16,"div",11)(17,"button",12),m(18),c(),l(19,"button",13),_("click",function(){return i.resetChanges()}),m(20,"Reset"),c()()()()),e&2&&(d(3),j(" Interactions: ",i.session==null?null:i.session.interactionsCount," "),d(6),Pe("ngModel",i.editData.title),u("placeholder",(i.session==null?null:i.session.lastHumanMessage)||"Enter title"),d(),u("ngIf",i.showUseLastMessage),d(4),Pe("ngModel",i.editData.description),d(3),u("disabled",!i.editData.title||i.saving),d(),j(" ",i.saving?"Saving...":"Save Changes"," "))},dependencies:[k,O,Ye,qe,le,$i,Se,Ke,Xi,ft,Qi],styles:['.session-editor[_ngcontent-%COMP%]{padding:20px}.session-editor[_ngcontent-%COMP%]   .editor-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[for=sessionTitle][_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .title-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .title-input-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{flex:1}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .title-input-group[_ngcontent-%COMP%]   .use-message-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;white-space:nowrap}.session-editor[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .session-editor[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .session-editor[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px}.session-editor[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:16px}.session-editor[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;cursor:pointer}.session-editor[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none}.session-editor[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed;opacity:.7}.session-editor[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #dee2e6}.session-info[_ngcontent-%COMP%]{margin-bottom:16px}.session-info[_ngcontent-%COMP%]   .interactions-count[_ngcontent-%COMP%]{color:#666;font-size:.9em}']})};var li=class n{constructor(t){this.bookService=t}book;saveBook(){this.book&&(this.book.id?this.bookService.updateBook(this.book.id,this.book).subscribe(t=>{this.bookService.setActiveBook(t)}):this.bookService.createBook(this.book).subscribe(t=>{this.bookService.setActiveBook(t)}))}static \u0275fac=function(e){return new(e||n)(v(ae))};static \u0275cmp=y({type:n,selectors:[["app-book-basic-details"]],inputs:{book:"book"},standalone:!0,features:[I],decls:12,vars:2,consts:[[1,"basic-details"],[1,"form-group"],["type","text","placeholder","Enter book title",3,"ngModelChange","ngModel"],["rows","4","placeholder","Enter book description",3,"ngModelChange","ngModel"],[3,"click"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"label"),m(3,"Title"),c(),l(4,"input",2),Te("ngModelChange",function(s){return Oe(i.book.title,s)||(i.book.title=s),s}),c()(),l(5,"div",1)(6,"label"),m(7,"Description"),c(),l(8,"textarea",3),Te("ngModelChange",function(s){return Oe(i.book.description,s)||(i.book.description=s),s}),c()(),l(9,"div",1)(10,"button",4),_("click",function(){return i.saveBook()}),m(11,"Save Book"),c()()()),e&2&&(d(4),Pe("ngModel",i.book.title),d(4),Pe("ngModel",i.book.description))},dependencies:[k,Ye,le,Se,ft],styles:[".basic-details[_ngcontent-%COMP%]{padding:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ddd;border-radius:4px}"]})};function Hr(n,t){if(n&1&&(l(0,"div",9),V(1,"app-interaction-list",10),c()),n&2){let e=h();d(),u("sessionId",e.selectedSessionId)("ignoreStorage",!0)("ignoreScroll",!0)}}var di=class n{selectedSessionId;_canSelect=!0;set canSelect(t){this._canSelect=t,this.dialogConfig={title:t?"Select Session":"Preview Session",width:"1200px",height:"100vh",closeOnBackdrop:!0}}get canSelect(){return this._canSelect}selected=new g;cancel=new g;dialogConfig;sessionSelected;onSessionSelected(t){this.sessionSelected=t,this.selectedSessionId=t.id}onConfirm(){this.sessionSelected&&this.selected.emit(this.sessionSelected)}onClose(){this.cancel.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-session-picker"]],inputs:{selectedSessionId:"selectedSessionId",canSelect:"canSelect"},outputs:{selected:"selected",cancel:"cancel"},standalone:!0,features:[I],decls:11,vars:5,consts:[[3,"close","config"],[1,"session-picker"],[1,"content-area"],[1,"sessions-panel"],[3,"sessionSelect","selectedId","canSelect"],["class","preview-panel",4,"ngIf"],[1,"actions"],[3,"click","disabled"],[3,"click"],[1,"preview-panel"],[3,"sessionId","ignoreStorage","ignoreScroll"]],template:function(e,i){e&1&&(l(0,"app-dialog",0),_("close",function(){return i.cancel.emit()}),l(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-chat-session-list",4),_("sessionSelect",function(s){return i.onSessionSelected(s)}),c()(),w(5,Hr,2,3,"div",5),c(),l(6,"div",6)(7,"button",7),_("click",function(){return i.onConfirm()}),m(8,"Select"),c(),l(9,"button",8),_("click",function(){return i.cancel.emit()}),m(10,"Cancel"),c()()()()),e&2&&(u("config",i.dialogConfig),d(4),u("selectedId",i.selectedSessionId)("canSelect",i.canSelect),d(),u("ngIf",i.selectedSessionId),d(2),u("disabled",!i.selectedSessionId||!i.canSelect))},dependencies:[k,O,Be,Zt,En],styles:[".session-picker[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.session-picker[_ngcontent-%COMP%]   .content-area[_ngcontent-%COMP%]{display:flex;flex:1;overflow:hidden}.session-picker[_ngcontent-%COMP%]   .content-area[_ngcontent-%COMP%]   .sessions-panel[_ngcontent-%COMP%]{width:25%;border-right:1px solid #eee}.session-picker[_ngcontent-%COMP%]   .content-area[_ngcontent-%COMP%]   .preview-panel[_ngcontent-%COMP%]{width:75%;overflow:auto}.session-picker[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;padding:16px;border-top:1px solid #eee}.session-picker[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;border:1px solid #ddd;background:#fff;cursor:pointer}.session-picker[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}.session-picker[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.session-picker[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background:#0366d6;color:#fff;border:none}.session-picker[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child:hover{background:#0256b9}"]})};var hi=class n{book;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-content-editor"]],inputs:{book:"book"},standalone:!0,features:[I],decls:3,vars:0,consts:[[1,"book-editor"],[1,"book-info"],[1,"info-row"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),V(2,"div",2),c()())},dependencies:[k],styles:[".book-editor[_ngcontent-%COMP%]   .book-info[_ngcontent-%COMP%]{margin-bottom:1rem}.book-editor[_ngcontent-%COMP%]   .book-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:.5rem}.book-editor[_ngcontent-%COMP%]   .book-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500}"]})};var ui=class n{constructor(t){this.fb=t;this.form=this.fb.group({title:["",Ue.required]}),this.form.valueChanges.subscribe(e=>{this.form.valid&&(this.copy.title=this.form.value.title,this.modified.emit(this.copy)),this.canConfirm.emit(this.form.valid)})}copy;_state;set state(t){this._state=t,t=="details"&&this.setCopy(),this.editMode.emit(t!="details")}get state(){return this._state||""}_chapter;set chapter(t){this._chapter=t,this.setCopy()}modified=new g;canConfirm=new g;editMode=new g;form;setCopy(){this.copy=R({},this._chapter),this.form.patchValue({title:this.copy.title||""})}static \u0275fac=function(e){return new(e||n)(v(ai))};static \u0275cmp=y({type:n,selectors:[["app-chapter-editor"]],inputs:{state:"state",chapter:"chapter"},outputs:{modified:"modified",canConfirm:"canConfirm",editMode:"editMode"},standalone:!0,features:[I],decls:6,vars:2,consts:[[1,"chapter-editor"],[3,"formGroup"],[1,"form-group"],["for","title"],["id","title","type","text","formControlName","title","placeholder","Enter chapter title",3,"readonly"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),m(4,"Chapter Title"),c(),V(5,"input",4),c()()()),e&2&&(d(),u("formGroup",i.form),d(4),u("readonly",i.state!="edit"&&i.state!="new"))},dependencies:[k,ci,qe,le,Se,Ke,_t,gt],styles:[".details-pane[_ngcontent-%COMP%]{padding:1rem;border-left:1px solid #eee}.details-pane[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:1rem}.details-pane[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;background:#f1f8ff;color:#0366d6;font-size:12px;text-transform:capitalize}.chapter-editor[_ngcontent-%COMP%]{padding:1rem}.chapter-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.chapter-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.chapter-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ccc;border-radius:4px}.chapter-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#666}.chapter-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:read-only{background-color:#eee}"]})};function zr(n,t){if(n&1){let e=D();l(0,"app-session-picker",8),_("selected",function(o){C(e);let s=h();return b(s.onSessionSelected(o))})("cancel",function(){C(e);let o=h();return b(o.onSessionPickerClosed())}),c()}if(n&2){let e=h();u("canSelect",e.canSelect)("selectedSessionId",e.copy.sessionId)}}var pi=class n{constructor(t){this.fb=t;this.form=this.fb.group({title:["",Ue.required]}),this.form.valueChanges.subscribe(e=>{this.form.valid&&(this.copy.title=this.form.value.title,this.modified.emit(this.copy)),this.canConfirm.emit(this.form.valid)})}set picker(t){t?this.showPicker():this.showSessionPicker=!1,console.log(this.canSelect)}_state;set state(t){switch(t){case"details":this.canSelect=!1,this.setCopy();break;case"new":case"edit":this.canSelect=!0;break}this._state=t,this.editMode.emit(t!="details")}get state(){return this._state}_session;set session(t){this._session=t,this.setCopy()}get session(){return this._session}closed=new g;modified=new g;canConfirm=new g;editMode=new g;showSessionPicker=!1;canSelect=!1;copy;form;setCopy(){this.copy=R({},this._session),this.form.patchValue({title:this.copy.title||""})}showPicker(){this.showSessionPicker=!0}onSessionSelected(t){console.log("Selected session:",t.id),this.session&&(this.copy.sessionId=t.id,this.copy.title=t.title,this.form.patchValue({title:this.copy.title||""}),this.modified.emit(this.copy),this.canConfirm.emit(this.form.valid)),this.onSessionPickerClosed()}onSessionPickerClosed(){this.closed.emit(),this.showSessionPicker=!1}static \u0275fac=function(e){return new(e||n)(v(ai))};static \u0275cmp=y({type:n,selectors:[["app-session-content-editor"]],inputs:{picker:"picker",state:"state",session:"session"},outputs:{closed:"closed",modified:"modified",canConfirm:"canConfirm",editMode:"editMode"},standalone:!0,features:[I],decls:13,vars:4,consts:[[1,"session-editor"],[1,"session-info"],[1,"info-row"],[3,"formGroup"],[1,"form-group"],["for","title"],["id","title","type","text","formControlName","title","placeholder","Enter session title",3,"readonly"],[3,"canSelect","selectedSessionId","selected","cancel",4,"ngIf"],[3,"selected","cancel","canSelect","selectedSessionId"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"label"),m(4,"Session ID:"),c(),l(5,"span"),m(6),c()()(),l(7,"form",3)(8,"div",4)(9,"label",5),m(10,"Session Title"),c(),V(11,"input",6),c()(),w(12,zr,1,2,"app-session-picker",7),c()),e&2&&(d(6),L(i.copy.sessionId),d(),u("formGroup",i.form),d(4),u("readonly",i.state!="edit"&&i.state!="new"),d(),u("ngIf",i.showSessionPicker))},dependencies:[k,O,di,ci,qe,le,Se,Ke,_t,gt],styles:[".session-editor[_ngcontent-%COMP%]   .session-info[_ngcontent-%COMP%]{margin-bottom:1rem}.session-editor[_ngcontent-%COMP%]   .session-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:.5rem}.session-editor[_ngcontent-%COMP%]   .session-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ccc;border-radius:4px}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#666}.session-editor[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:read-only{background-color:#eee}.session-editor[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;border-radius:4px;background:#fff;cursor:pointer}.session-editor[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}"]})};function Gr(n,t){if(n&1&&V(0,"app-book-content-editor",4),n&2){let e=h();u("book",e.selectedItem)}}function Ur(n,t){if(n&1){let e=D();l(0,"app-chapter-editor",5),_("canConfirm",function(o){C(e);let s=h();return b(s.onCanConfirm(o))})("modified",function(o){C(e);let s=h();return b(s.onModified(o))})("editMode",function(o){C(e);let s=h();return b(s.onEditMode(o))}),c()}if(n&2){let e=h();u("chapter",e.selectedItem)("state",e.state)}}function $r(n,t){if(n&1){let e=D();l(0,"app-session-content-editor",6),_("closed",function(){C(e);let o=h();return b(o.onClosed())})("canConfirm",function(o){C(e);let s=h();return b(s.onCanConfirm(o))})("modified",function(o){C(e);let s=h();return b(s.onModified(o))})("editMode",function(o){C(e);let s=h();return b(s.onEditMode(o))}),c()}if(n&2){let e=h();u("session",e.selectedItem)("state",e.state)("picker",e.picker)}}var Qe=class n{picker=!1;selectedItem;state;canConfirm=new g;modified=new g;closed=new g;editMode=new g;onCanConfirm(t){this.canConfirm.emit(t)}onModified(t){this.modified.emit(t)}onClosed(){this.closed.emit()}onEditMode(t){this.editMode.emit(t)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-content-type-switch"]],inputs:{picker:"picker",selectedItem:"selectedItem",state:"state"},outputs:{canConfirm:"canConfirm",modified:"modified",closed:"closed",editMode:"editMode"},standalone:!0,features:[I],decls:4,vars:4,consts:[[3,"ngSwitch"],[3,"book",4,"ngSwitchCase"],[3,"chapter","state","canConfirm","modified","editMode",4,"ngSwitchCase"],[3,"session","state","picker","closed","canConfirm","modified","editMode",4,"ngSwitchCase"],[3,"book"],[3,"canConfirm","modified","editMode","chapter","state"],[3,"closed","canConfirm","modified","editMode","session","state","picker"]],template:function(e,i){e&1&&(Q(0,0),w(1,Gr,1,1,"app-book-content-editor",1)(2,Ur,1,2,"app-chapter-editor",2)(3,$r,1,3,"app-session-content-editor",3),X()),e&2&&(u("ngSwitch",i.selectedItem.type),d(),u("ngSwitchCase","book"),d(),u("ngSwitchCase","chapter"),d(),u("ngSwitchCase","session"))},dependencies:[k,yn,wn,ui,pi,hi],encapsulation:2})};var Wr=()=>[];function Zr(n,t){if(n&1&&(l(0,"option",11),m(1),c()),n&2){let e=t.$implicit,i=t.index,o=h(2);u("value",i)("selected",o.insertPosition==i),d(),j(" Before: ",e.title," ")}}function Kr(n,t){if(n&1){let e=D();Q(0),l(1,"span",6),m(2),c(),l(3,"label"),m(4,"Insert position... "),c(),l(5,"div",7)(6,"select",8,1),_("change",function(){C(e);let o=U(7),s=h();return b(s.onSelectPosition(o.value))}),w(8,Zr,2,3,"option",9),l(9,"option",10),m(10,"At the end"),c()()(),X()}if(n&2){let e=h();d(2),L(e.contentData.type),d(6),u("ngForOf",(e.parent==null?null:e.parent.children)||xt(3,Wr)),d(),u("selected",e.insertPosition==-1)}}function qr(n,t){if(n&1){let e=D();l(0,"app-content-type-switch",12),_("canConfirm",function(o){C(e);let s=h();return b(s.onCanConfirm(o))})("modified",function(o){C(e);let s=h();return b(s.onModified(o))})("closed",function(){C(e);let o=h();return b(o.onClosed())}),c()}if(n&2){let e=h();u("selectedItem",e.contentData)("picker",e.picker)("state","new")}}function Yr(n,t){if(n&1){let e=D();l(0,"div",13)(1,"label"),m(2,"Please select content type... "),c(),l(3,"button",14),_("click",function(){C(e);let o=h();return b(o.onTypeSelect("chapter"))}),m(4," Chapter "),c(),l(5,"button",14),_("click",function(){C(e);let o=h();return b(o.onTypeSelect("session"))}),m(6," Session "),c()()}}var mi=class n{constructor(t){this.fake=t}picker=!1;parent;canConfirm=new g;modified=new g;position=new g;closed=new g;canSelect=new g;ngOnInit(){this.contentData={bookId:this.parent?.bookId,id:`fake-${this.fake.nextId()}`,parentId:this.parent?.id,isNew:!0},this.canSelect.emit(!1),this.position.emit(this.insertPosition)}ngOnDestroy(){this.canSelect.emit(!1),this.position.emit(-1),console.log("ah, I die... hard.")}onCanConfirm(t){this.canConfirm.emit(t)}onModified(t){this.modified.emit(t)}onSelectPosition(t){this.insertPosition=+t,this.position.emit(this.insertPosition)}contentData;insertPosition=-1;onTypeSelect(t){setTimeout(()=>{switch(this.contentData.type=t,t){case"chapter":this.contentData.children=[];break;case"session":console.log("Oh, you should be able to select now!"),this.canSelect.emit(!0);break}})}onClosed(){this.closed.emit()}static \u0275fac=function(e){return new(e||n)(v(Ot))};static \u0275cmp=y({type:n,selectors:[["app-add-content"]],inputs:{picker:"picker",parent:"parent"},outputs:{canConfirm:"canConfirm",modified:"modified",position:"position",closed:"closed",canSelect:"canSelect"},standalone:!0,features:[I],decls:8,vars:3,consts:[["noContentType",""],["positionSelector",""],[1,"add-content"],[1,"header"],[4,"ngIf"],[3,"selectedItem","picker","state","canConfirm","modified","closed",4,"ngIf","ngIfElse"],[1,"type-badge"],[1,"form-field"],[3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["value","-1",3,"selected"],[3,"value","selected"],[3,"canConfirm","modified","closed","selectedItem","picker","state"],[1,"type-selector"],[3,"click"]],template:function(e,i){if(e&1&&(l(0,"div",2)(1,"div",3)(2,"h4"),m(3,"Add new content"),c(),w(4,Kr,11,4,"ng-container",4),c(),w(5,qr,1,3,"app-content-type-switch",5)(6,Yr,7,0,"ng-template",null,0,re),c()),e&2){let o=U(7);d(4),u("ngIf",i.contentData==null?null:i.contentData.type),d(),u("ngIf",i.contentData==null?null:i.contentData.type)("ngIfElse",o)}},dependencies:[k,q,O,Ye,Ko,Yo,Qe],styles:[".add-content[_ngcontent-%COMP%]{margin-top:1rem}.add-content[_ngcontent-%COMP%]   .type-selector[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1rem}.add-content[_ngcontent-%COMP%]   .type-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;border-radius:4px;background:#fff;cursor:pointer}.add-content[_ngcontent-%COMP%]   .type-selector[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#f1f8ff;border-color:#0366d6;color:#0366d6}.add-content[_ngcontent-%COMP%]   .type-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}.add-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:1rem}.add-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;background:#f1f8ff;color:#0366d6;font-size:12px;text-transform:capitalize}.add-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ccc;border-radius:4px}.add-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:1rem}"]})};function Qr(n,t){n&1&&(l(0,"pre"),m(1,`    what can we do here?
well, on details we are to see what we have
if possible to edit, hit edit button
- enter edit mode, editable controls are not read only
- can confirm or cancel changes, both leave edit mode
if have children, can add new content there, just hit add content button
- enter addingContent mode, that is to provide this special component
  - there is initial step to pick content type for the new kid\`
  - after that, switch with proper type editor
  - can confirm or cancel changes...
`),c())}function Xr(n,t){if(n&1){let e=D();l(0,"button",11),_("click",function(){C(e);let o=h(3);return b(o.onPreview())}),m(1,"Preview"),c()}}function Jr(n,t){if(n&1){let e=D();l(0,"button",11),_("click",function(){C(e);let o=h(3);return b(o.onAddContent())}),m(1,"Add Content..."),c()}}function ea(n,t){if(n&1){let e=D();Q(0),l(1,"button",11),_("click",function(){C(e);let o=h(3);return b(o.onEdit())}),m(2,"Edit"),c(),l(3,"button",11),_("click",function(){C(e);let o=h(3);return b(o.onRemove())}),m(4,"Remove"),c(),X()}}function ta(n,t){if(n&1&&(Q(0),w(1,Xr,2,0,"button",10)(2,Jr,2,0,"button",10)(3,ea,5,0,"ng-container",6),X()),n&2){let e=h(2);d(),u("ngIf",!!(e.selectedItem!=null&&e.selectedItem.sessionId)),d(),u("ngIf",!!(e.selectedItem!=null&&e.selectedItem.children)),d(),u("ngIf",(e.selectedItem==null?null:e.selectedItem.type)!="book")}}function ia(n,t){if(n&1){let e=D();l(0,"button",11),_("click",function(){C(e);let o=h(3);return b(o.onSelect())}),m(1,"Select..."),c()}}function na(n,t){if(n&1){let e=D();w(0,ia,2,0,"button",10),l(1,"button",12),_("click",function(){C(e);let o=h(2);return b(o.onConfirm())}),m(2,"Confirm"),c(),l(3,"button",11),_("click",function(){C(e);let o=h(2);return b(o.onCancel())}),m(4,"Cancel"),c()}if(n&2){let e=h(2);u("ngIf",!!(e.selectedItem!=null&&e.selectedItem.sessionId)||e.canSelect),d(),u("disabled",!e.canConfirm)}}function oa(n,t){if(n&1){let e=D();l(0,"app-add-content",13),_("canConfirm",function(o){C(e);let s=h(2);return b(s.onCanConfirm(o))})("modified",function(o){C(e);let s=h(2);return b(s.onModified(o))})("position",function(o){C(e);let s=h(2);return b(s.onPosition(o))})("closed",function(){C(e);let o=h(2);return b(o.onClosedFromAddContent())})("canSelect",function(o){C(e);let s=h(2);return b(s.onCanSelect(o))}),c()}if(n&2){let e=h(2);u("parent",e.selectedItem)("picker",e.picker)}}function sa(n,t){if(n&1){let e=D();l(0,"div",2)(1,"div",3)(2,"h3"),m(3),c(),l(4,"span",4),m(5),c()(),l(6,"app-content-type-switch",5),_("canConfirm",function(o){C(e);let s=h();return b(s.onCanConfirm(o))})("modified",function(o){C(e);let s=h();return b(s.onModified(o))})("closed",function(){C(e);let o=h();return b(o.onClosedFromTypeSwitch())})("editMode",function(o){C(e);let s=h();return b(s.onEditMode(o))}),c(),w(7,Qr,2,0,"pre",6),l(8,"div",7),w(9,ta,4,3,"ng-container",8)(10,na,5,2,"ng-template",null,0,re),c(),w(12,oa,1,2,"app-add-content",9),c()}if(n&2){let e=U(11),i=h();d(3),L(i.selectedItem.title||i.selectedItem.id),d(2),L(i.selectedItem.type),d(),u("selectedItem",i.selectedItem)("state",i.state)("picker",i.picker),d(),u("ngIf",!1),d(2),u("ngIf",i.state=="details")("ngIfElse",e),d(3),u("ngIf",i.state=="add-content")}}var fi=class n{_selectedItem;set selectedItem(t){this._selectedItem=t,this.state="details"}get selectedItem(){return this._selectedItem}addContent=new g;removeContent=new g;contentChanged=new g;editMode=new g;state="details";addingContent=!1;picker=!1;canConfirm=!1;modified;position=-1;canSelect=!1;onPosition(t){console.log("on position",t),this.position=t}onCanConfirm(t){this.canConfirm=t}onModified(t){this.modified=t}onPreview(){setTimeout(()=>{this.picker=!0})}onAddContent(){setTimeout(()=>{this.state="add-content",this.onEditMode(!0)})}onEdit(){setTimeout(()=>{this.state="edit"})}onRemove(){setTimeout(()=>{this.removeContent.emit(this.selectedItem)})}onConfirm(){setTimeout(()=>{switch(this.state){case"edit":Object.assign(this.selectedItem,this.modified,{isModified:!0});break;case"add-content":this.position<0?(Object.assign(this.modified,{order:(this.selectedItem.children?.length||0)+1,isModified:!0}),this.selectedItem.children?.push(this.modified)):(this.selectedItem.children?.splice(this.position,0,this.modified),this.selectedItem.children?.forEach((t,e)=>{e>=this.position&&Object.assign(t,{order:e+1,isModified:!0})})),this.selectedItem.expanded=!0;break;default:break}this.state="details",this.onEditMode(!1),this.contentChanged.emit()})}onCancel(){setTimeout(()=>{this.state="details",this.onEditMode(!1)})}onClosedFromTypeSwitch(){setTimeout(()=>{this.picker=!1})}onClosedFromAddContent(){setTimeout(()=>{this.picker=!1})}onSelect(){setTimeout(()=>{this.picker=!0})}onCanSelect(t){setTimeout(()=>{this.canSelect=t})}onEditMode(t){this.editMode.emit(t)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-content-details"]],inputs:{selectedItem:"selectedItem"},outputs:{addContent:"addContent",removeContent:"removeContent",contentChanged:"contentChanged",editMode:"editMode"},standalone:!0,features:[I],decls:1,vars:1,consts:[["notDetailsActions",""],["class","details-pane",4,"ngIf"],[1,"details-pane"],[1,"header"],[1,"type-badge"],[3,"canConfirm","modified","closed","editMode","selectedItem","state","picker"],[4,"ngIf"],[1,"actions"],[4,"ngIf","ngIfElse"],[3,"parent","picker","canConfirm","modified","position","closed","canSelect",4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"],[3,"click","disabled"],[3,"canConfirm","modified","position","closed","canSelect","parent","picker"]],template:function(e,i){e&1&&w(0,sa,13,9,"div",1),e&2&&u("ngIf",i.selectedItem)},dependencies:[k,O,mi,Qe],styles:[".details-pane[_ngcontent-%COMP%]{padding:1rem;border-left:1px solid #eee}.details-pane[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:1rem}.details-pane[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;background:#f1f8ff;color:#0366d6;font-size:12px;text-transform:capitalize}.details-pane[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:1rem;display:flex;gap:.5rem;margin-bottom:1rem}.details-pane[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;border-radius:4px;background:#fff;cursor:pointer}.details-pane[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#f1f8ff;border-color:#0366d6;color:#0366d6}.details-pane[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}.details-pane[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#eee;cursor:not-allowed}"]})};var _i=class n{_selectedItemId;set selectedItem(t){t&&(this._selectedItemId=t.id,this.onItemSelected(this.getSelectedItem(this.treeItems)))}disabled=!1;get selectedItemId(){return this._selectedItemId||""}treeItems=[];set content(t){this.treeItems=t,this.onItemSelected(t[0])}itemSelected=new g;contentChanged=new g;getSelectedItem(t){return t.find(e=>e.id==this._selectedItemId)||t.map(e=>this.getSelectedItem(e.children||[])).find(e=>!!e)}typeToIcon={book:"\u{1F56E}",chapter:"\u{1F4D1}",session:"\u{1F4DD}"};onItemSelected(t){t&&t.id&&(this._selectedItemId=t.id,this.itemSelected.emit(t))}onItemDropped(t){let e=this.findNode(this.treeItems[0],t.targetId),i=this.findNode(this.treeItems[0],t.sourceId),o=this.findNode(this.treeItems[0],i.parentId),s=o?.children?.findIndex(r=>r.id==i.id)??-1;if(s!==-1&&o?.children?.splice(s,1),t.position==="inside"){e.children=e.children||[],i.parentId=e.id;let r=e.children.length;if(i.order=r+1,i.isModified=!0,e.children?.push(i),e.expanded=!0,o&&o!==e)for(let a=s;a<o.children.length;a++)o.children[a].order=a+1,o.children[a].isModified=!0}else{let r=this.findNode(this.treeItems[0],e.parentId),a=r?.children?.findIndex(p=>p.id==e.id)??-1;if(o!==r){if(s!==-1&&o?.children)for(let f=s;f<o.children.length;f++)o.children[f].order=f+1,o.children[f].isModified=!0;i.parentId=r?.id;let p=t.position==="before"?a:a+1;if(r?.children?.splice(p,0,i),r?.children)for(let f=p;f<r.children.length;f++)r.children[f].order=f+1,r.children[f].isModified=!0;i.isModified=!0}else if(r?.children&&s!==-1&&a!==-1){let p=s<a&&t.position==="before"?a-1:a,f=t.position==="before"?p:p+1;r.children.splice(f,0,i);let S=Math.min(s,f),E=Math.max(s,f);for(let F=S;F<=E;F++)r.children[F].order=F+1,r.children[F].isModified=!0;i.isModified=!0}}console.log(JSON.stringify(this.treeItems,null,2)),this.contentChanged.emit()}findNode(t,e){return!e||t.id==e?t:t.children?.map(i=>this.findNode(i,e)).find(i=>i)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-content-tree"]],inputs:{selectedItem:"selectedItem",disabled:"disabled",content:"content"},outputs:{itemSelected:"itemSelected",contentChanged:"contentChanged"},standalone:!0,features:[I],decls:1,vars:4,consts:[["idField","id","labelField","title","typeField","type",3,"itemSelected","itemDropped","items","selectedId","typeToIcon","disabled"]],template:function(e,i){e&1&&(l(0,"app-tree-view",0),_("itemSelected",function(s){return i.onItemSelected(s)})("itemDropped",function(s){return i.onItemDropped(s)}),c()),e&2&&u("items",i.treeItems)("selectedId",i.selectedItemId)("typeToIcon",i.typeToIcon)("disabled",i.disabled)},dependencies:[k,$t],styles:["[_nghost-%COMP%]{display:block}"]})};var gi=class n{constructor(t){this.bookService=t}changed=new g;_hasChanges=!1;set hasChanges(t){this._hasChanges=t,this.emitChanged()}get hasChanges(){return this._hasChanges}destroy$=new M;removedItems=[];editMode=!1;ngOnInit(){this.bookService.bookContent$.pipe(Ce(this.destroy$)).subscribe(t=>{this.content=t,this.removedItems=[],this.editMode=!1,this.hasChanges=!1})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onSave(){this.bookService.updateBookContent(this.content,this.removedItems).subscribe({next:t=>{console.log("update result: ",t)}})}onReset(){let t=this.content[0],e=t.bookId,i=t.title;this.bookService.loadBookContent({id:e,title:i})}onContentChanged(){this.hasChanges=!0}content;selectedItem;onItemSelected(t){this.selectedItem=t}onRemoveContent(t){let e=this.findPoorChild(this.content[0],t.id);console.log(e),e?.parent?.children?.splice(e.poorChild.order-1,1),e?.parent?.children?.forEach((i,o)=>{o>=e.poorChild.order&&Object.assign(i,{order:o+1,isModified:!0})}),this.markAsRemoved(e.poorChild),this.onItemSelected(e?.parent),this.onContentChanged()}markAsRemoved(t){Object.assign(t,{isRemoved:!0}),this.removedItems.push(t),t.children&&t.children.forEach(e=>this.markAsRemoved(e))}findPoorChild(t,e){if(t.id==e)return{poorChild:t};if(!t.children)return;let i=t.children.map(o=>this.findPoorChild(o,e)).find(o=>o!==void 0);if(i)return i.parent?i:Y(R({},i),{parent:t})}onEditMode(t){this.editMode=t,this.emitChanged()}emitChanged(){this.changed.emit(this._hasChanges||this.editMode)}static \u0275fac=function(e){return new(e||n)(v(ae))};static \u0275cmp=y({type:n,selectors:[["app-book-content"]],outputs:{changed:"changed"},standalone:!0,features:[I],decls:10,vars:6,consts:[[1,"content-tab"],[1,"content-layout"],[1,"left-column"],[1,"actions"],[3,"click","disabled"],[3,"itemSelected","contentChanged","content","selectedItem","disabled"],[3,"removeContent","contentChanged","editMode","selectedItem"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),_("click",function(){return i.onSave()}),m(5,"Save Changes"),c(),l(6,"button",4),_("click",function(){return i.onReset()}),m(7,"Reset"),c()(),l(8,"app-book-content-tree",5),_("itemSelected",function(s){return i.onItemSelected(s)})("contentChanged",function(){return i.onContentChanged()}),c()(),l(9,"app-book-content-details",6),_("removeContent",function(s){return i.onRemoveContent(s)})("contentChanged",function(){return i.onContentChanged()})("editMode",function(s){return i.onEditMode(s)}),c()()()),e&2&&(d(4),u("disabled",!i.hasChanges||i.editMode),d(2),u("disabled",!i.hasChanges||i.editMode),d(2),u("content",i.content)("selectedItem",i.selectedItem)("disabled",i.editMode),d(),u("selectedItem",i.selectedItem))},dependencies:[k,_i,fi],styles:[".content-tab[_ngcontent-%COMP%]{padding:0}.content-layout[_ngcontent-%COMP%]{display:flex;gap:1rem}.left-column[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:1rem;display:flex;gap:.5rem}button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;border-radius:4px;background:#fff;cursor:pointer}button[_ngcontent-%COMP%]:hover{background:#f5f5f5}button[_ngcontent-%COMP%]:disabled{background:#eee;cursor:not-allowed}"]})};var vi=class n{book;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-access-details"]],inputs:{book:"book"},standalone:!0,features:[I],decls:18,vars:0,consts:[[1,"access-details"],[1,"form-group"],["type","date"],[1,"checkbox-group"],["type","checkbox"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"label"),m(3,"Publish Date"),c(),V(4,"input",2),c(),l(5,"div",1)(6,"label"),m(7,"Access Roles"),c(),l(8,"div",3)(9,"label"),V(10,"input",4),m(11," Public Access "),c(),l(12,"label"),V(13,"input",4),m(14," Registered Users "),c(),l(15,"label"),V(16,"input",4),m(17," Premium Users "),c()()()())},dependencies:[k],styles:[".access-details[_ngcontent-%COMP%]{padding:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.checkbox-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:400}"]})};function ra(n,t){if(n&1){let e=D();l(0,"button",6),_("click",function(){C(e);let o=h();return b(o.onNewBook())}),m(1,"New Book"),c()}if(n&2){let e=h();u("disabled",e.disableSelection)}}function aa(n,t){if(n&1){let e=D();l(0,"div",7),_("click",function(){let o=C(e).$implicit,s=h();return b(s.onSelectBook(o))}),m(1),c()}if(n&2){let e=t.$implicit,i=h();P("selected",e.id===i.selectedBookId)("disabled",i.disableSelection),d(),j(" ",e.title," ")}}var Jo=class n{constructor(t){this.bookService=t}disableSelection=!1;hideNewButton=!1;isExpanded=!0;books=[];selectedBookId;ngOnInit(){this.bookService.books$.subscribe(t=>{this.books=t}),this.bookService.activeBook$.subscribe(t=>{this.selectedBookId=t?.id})}onNewBook(){this.bookService.setActiveBook({title:"",description:"",status:"draft"})}onSelectBook(t){this.disableSelection||this.bookService.setActiveBook(t)}static \u0275fac=function(e){return new(e||n)(v(ae))};static \u0275cmp=y({type:n,selectors:[["app-book-list"]],inputs:{disableSelection:"disableSelection",hideNewButton:"hideNewButton"},standalone:!0,features:[I],decls:8,vars:3,consts:[[3,"expandedChange","isExpanded"],[1,"book-list-header"],[3,"disabled","click",4,"ngIf"],[1,"book-list"],[1,"books"],["class","book-item",3,"selected","disabled","click",4,"ngFor","ngForOf"],[3,"click","disabled"],[1,"book-item",3,"click"]],template:function(e,i){e&1&&(l(0,"app-sidebar",0),_("expandedChange",function(s){return i.isExpanded=s}),l(1,"div",1)(2,"h3"),m(3,"Books"),c(),w(4,ra,2,1,"button",2),c(),l(5,"div",3)(6,"div",4),w(7,aa,2,5,"div",5),c()()()),e&2&&(u("isExpanded",i.isExpanded),d(4),u("ngIf",!i.hideNewButton),d(3),u("ngForOf",i.books))},dependencies:[k,q,O,Ft],styles:[".book-list-header[_ngcontent-%COMP%]{padding:1rem;display:flex;justify-content:space-between;align-items:center}.book-filters[_ngcontent-%COMP%]{padding:.5rem}.book-filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem}.books[_ngcontent-%COMP%]   .book-item[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid #eee;cursor:pointer}.books[_ngcontent-%COMP%]   .book-item[_ngcontent-%COMP%]:hover:not(.disabled){background:#ddd}.books[_ngcontent-%COMP%]   .book-item.disabled[_ngcontent-%COMP%]:not(.selected){cursor:not-allowed;color:#666}.books[_ngcontent-%COMP%]   .book-item.selected[_ngcontent-%COMP%]{background-color:#ccc;font-weight:700;cursor:default}"]})};var es=class n{hasPendingChanges=new g;_contentHasChanges=!1;set contentHasChanges(t){this._contentHasChanges=t,this.hasPendingChanges.emit(t)}get contentHasChanges(){return this._contentHasChanges}ngOnInit(){}activeTab=0;book;onContentChanged(t){this.contentHasChanges=t}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-book-editor"]],inputs:{book:"book"},outputs:{hasPendingChanges:"hasPendingChanges"},standalone:!0,features:[I],decls:10,vars:4,consts:[[1,"details-header"],[3,"disableTabChange"],["tabTitle","Details"],[3,"book"],["tabTitle","Access"],["tabTitle","Content"],[3,"changed"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"h2"),m(2),c()(),l(3,"app-tab-view",1)(4,"app-tab-item",2),V(5,"app-book-basic-details",3),c(),l(6,"app-tab-item",4),V(7,"app-book-access-details",3),c(),l(8,"app-tab-item",5)(9,"app-book-content",6),_("changed",function(s){return i.onContentChanged(s)}),c()()()),e&2&&(d(2),L(i.book.title||"New Book"),d(),u("disableTabChange",i.contentHasChanges),d(2),u("book",i.book),d(2),u("book",i.book))},dependencies:[Vt,je,li,vi,gi],styles:[".details-header[_ngcontent-%COMP%]{padding:0 1rem;border-bottom:1px solid #ddd}"]})};export{je as a,Vt as b,On as c,Pt as d,Pa as e,ae as f,Tn as g,Xo as h,Vn as i,es as j,Jo as k};
